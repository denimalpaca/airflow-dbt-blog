

============================== 2022-12-01 01:55:48.840545 | e6cddb33-bc45-46f7-b07d-3fbb8bd2c93c ==============================
[0m01:55:48.840595 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:55:48.841891 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m01:55:48.844024 [debug] [MainThread]: Tracking: tracking
[0m01:55:48.850791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37340>]}
[0m01:55:48.855627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37640>]}
[0m01:55:48.857167 [debug] [MainThread]: Flushing usage events
[0m01:55:49.275563 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2022-12-01 02:09:37.269576 | 6290eefc-feae-40b3-93b2-edab578a8787 ==============================
[0m02:09:37.269616 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:09:37.271961 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:09:37.274100 [debug] [MainThread]: Tracking: tracking
[0m02:09:37.292786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574ccd0>]}
[0m02:09:37.304506 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q5d9u8e9'
[0m02:09:37.306748 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:09:37.674153 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:09:37.677131 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:09:37.943728 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:09:38.038432 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:09:43.624593 [info ] [MainThread]:   Installed from version 0.8.0
[0m02:09:43.630891 [info ] [MainThread]:   Updated version available: 0.9.6
[0m02:09:43.684100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6290eefc-feae-40b3-93b2-edab578a8787', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b57ef730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b57ef160>]}
[0m02:09:43.701392 [info ] [MainThread]: 
[0m02:09:43.707435 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:09:43.719130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5828f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5870a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cdc0>]}
[0m02:09:43.721787 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:09:48.309461 | eb86baf6-fcbe-47a5-95ab-a8adb7bad675 ==============================
[0m02:09:48.309512 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:09:48.310757 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:09:48.312482 [debug] [MainThread]: Tracking: tracking
[0m02:09:48.321540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efb2b0>]}
[0m02:09:48.396370 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m02:09:48.398818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50b72d820>]}
[0m02:09:49.044295 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:09:49.049648 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:09:49.090957 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:09:49.097052 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:09:49.101204 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:09:49.104948 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:09:49.108131 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:09:49.109679 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:09:49.112469 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:09:49.114745 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:09:49.117296 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:09:49.129938 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:09:49.133613 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:09:49.137401 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:09:49.142014 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:09:49.145231 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:09:49.149089 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:09:49.151335 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:09:49.154045 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:09:49.155932 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:09:49.157755 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:09:49.167633 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:09:49.176741 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:09:49.191452 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:09:49.195432 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:09:49.198493 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:09:49.203907 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:09:49.206049 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:09:49.208251 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:09:49.210316 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:09:49.215647 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:09:49.218533 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:09:49.222500 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:09:49.233298 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:09:49.236050 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:09:49.238181 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:09:49.240334 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:09:49.242264 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:09:49.244994 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:09:49.247026 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:09:49.249735 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:09:49.252094 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:09:49.254930 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:09:49.260207 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:09:49.263474 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:09:49.266255 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:09:49.268347 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:09:49.270777 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:09:49.286729 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:09:49.350205 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:09:49.357753 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:09:49.367468 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:09:49.399673 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:09:49.406746 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:09:49.427137 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:09:49.440407 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:09:49.454176 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:09:49.472195 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:09:49.488091 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:09:49.501938 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:09:49.523846 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:09:49.552040 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:09:49.570064 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:09:49.626621 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:09:49.633818 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:09:49.668021 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:09:49.691532 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:09:49.695348 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:09:49.702756 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:09:49.716062 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:09:49.729168 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:09:49.754871 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:09:49.781070 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:09:49.804803 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:09:49.810263 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:09:49.816549 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:09:49.820331 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:09:49.828414 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:09:49.874247 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:09:49.893855 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:09:49.901945 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:09:49.919516 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:09:49.922156 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:09:49.926742 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:09:49.929844 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:09:49.935963 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:09:49.944529 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:09:49.948661 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:09:49.954068 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:09:49.973700 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:09:49.977156 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:09:49.980734 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:09:49.989098 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:09:49.992906 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:09:50.000994 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:09:50.004734 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:09:50.007816 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:09:50.012662 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:09:50.016054 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:09:50.021171 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:09:50.024698 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:09:50.028036 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:09:50.038876 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:09:50.043101 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:09:50.046112 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:09:50.048828 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:09:50.052000 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:09:50.094536 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:09:50.100331 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:09:50.103216 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:09:50.107007 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:09:50.110015 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:09:50.116398 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:09:50.120800 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:09:50.124754 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:09:50.141238 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:09:50.146241 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:09:50.150010 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:09:50.154008 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:09:50.157077 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:09:50.160902 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:09:50.166398 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:09:50.169286 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:09:50.172248 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:09:50.177170 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:09:50.185550 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:09:50.192795 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:09:50.202425 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:09:50.206573 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:09:50.213333 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:09:50.220886 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:09:50.231663 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:09:50.235558 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:09:50.238562 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:09:50.248450 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:09:50.252176 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:09:50.255464 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:09:50.262305 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:09:50.266328 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:09:50.272757 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:09:50.278816 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:09:50.292439 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:09:50.306375 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:09:50.310658 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:09:50.314315 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:09:50.866669 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:09:50.890069 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:09:50.895196 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:09:50.914145 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:09:50.927247 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:09:50.930760 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:09:50.970076 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:09:51.213980 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:09:51.353404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509e1c2b0>]}
[0m02:09:51.398090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509f6ba30>]}
[0m02:09:51.399634 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:09:51.401244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509eadf10>]}
[0m02:09:51.403268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509f22c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509e60cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509dfa040>]}
[0m02:09:51.404408 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:44:15.479655 | 118d2093-5442-4087-afa3-04e104429da0 ==============================
[0m02:44:15.479691 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:44:15.482769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m02:44:15.485912 [debug] [MainThread]: Tracking: tracking
[0m02:44:15.502873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31db80>]}
[0m02:44:15.785171 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:44:15.788791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa2d5730>]}
[0m02:44:16.133258 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:44:16.136310 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:44:16.178139 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:44:16.183284 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:44:16.186680 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:44:16.189957 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:16.193261 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:16.194832 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:16.197395 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:16.199225 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:16.201423 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:16.214962 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:44:16.218160 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:44:16.221407 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:44:16.226281 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:44:16.229341 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:44:16.232175 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:44:16.234522 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:44:16.237180 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:44:16.239095 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:44:16.240745 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:44:16.250759 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:44:16.259953 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:44:16.273793 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:44:16.276915 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:44:16.279426 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:16.283624 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:44:16.285911 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:44:16.287851 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:16.290031 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:16.293263 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:16.295892 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:16.299555 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:44:16.309838 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:44:16.312814 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:44:16.315156 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:44:16.317575 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:44:16.319412 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:44:16.321770 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:44:16.323469 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:16.326216 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:44:16.328449 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:44:16.331381 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:44:16.333311 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:44:16.335782 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:44:16.337883 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:44:16.339870 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:44:16.342073 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:44:16.357102 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:44:16.381653 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:44:16.386431 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:44:16.391512 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:44:16.413467 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:44:16.419038 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:44:16.431286 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:44:16.439127 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:44:16.445734 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:44:16.449881 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:44:16.456091 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:44:16.462409 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:44:16.473066 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:44:16.487103 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:44:16.498120 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:44:16.540565 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:44:16.544353 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:44:16.650433 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:44:16.671226 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:44:16.674976 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:44:16.715630 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:44:16.722453 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:44:16.732380 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:44:16.756156 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:44:16.781754 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:44:16.800879 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:44:16.804796 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:44:16.808097 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:44:16.811451 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:44:16.818613 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:44:16.848874 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:44:16.860468 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:44:16.866511 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:44:16.869995 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:44:16.872291 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:44:16.875055 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:44:16.877005 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:44:16.882321 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:44:16.890423 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:44:16.893802 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:44:16.898502 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:44:16.915493 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:44:16.918749 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:44:16.921398 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:44:16.924204 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:44:16.926585 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:44:16.932322 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:44:16.935384 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:44:16.937635 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:44:16.940381 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:44:16.943058 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:44:16.946893 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:44:16.950374 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:44:16.955878 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:44:16.969613 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:44:16.972570 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:44:16.975019 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:44:16.977698 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:44:16.980362 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:44:17.021486 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:44:17.027171 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:44:17.029972 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:44:17.033811 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:44:17.037583 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:44:17.050510 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:44:17.054800 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:44:17.058649 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:44:17.078393 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:44:17.083402 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:44:17.087054 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:44:17.092281 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:44:17.096070 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:44:17.100365 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:44:17.105135 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:44:17.107970 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:44:17.110987 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:44:17.115954 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:44:17.123271 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:44:17.130700 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:44:17.138974 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:44:17.143810 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:44:17.149483 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:44:17.155094 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:44:17.165534 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:44:17.168970 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:44:17.171722 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:44:17.181661 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:44:17.185535 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:44:17.188722 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:44:17.195512 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:44:17.198542 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:44:17.205624 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:44:17.212537 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:44:17.228889 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:44:17.243371 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:44:17.247121 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:44:17.250519 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:44:17.792036 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:44:17.814310 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:44:17.819326 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:44:17.836354 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:44:17.855860 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:44:17.859693 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:44:17.903256 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:44:18.116095 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:44:18.237648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf962c0d0>]}
[0m02:44:18.270387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa310bb0>]}
[0m02:44:18.271823 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:44:18.274266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa3145e0>]}
[0m02:44:18.277504 [info ] [MainThread]: 
[0m02:44:18.279332 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:18.281436 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:44:18.290512 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:44:18.292393 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:44:18.293807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:18.306356 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:44:18.309693 [debug] [ThreadPool]: On list_*****: Close
[0m02:44:18.313052 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:44:18.322177 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:18.323329 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:44:18.324554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:18.329818 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:44:18.331145 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:18.332213 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:44:18.337887 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.0 seconds
[0m02:44:18.341750 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:44:18.343235 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:44:18.352058 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.353562 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.355070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:18.361448 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:18.362812 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.363969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:18.374930 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:44:18.378203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf96695e0>]}
[0m02:44:18.379582 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:18.381895 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.383007 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.385252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:44:18.386493 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.387585 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.388622 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.389818 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.390850 [debug] [MainThread]: On master: Close
[0m02:44:18.392430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:18.394421 [info ] [MainThread]: 
[0m02:44:18.415627 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m02:44:18.417196 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m02:44:18.418967 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m02:44:18.420185 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m02:44:18.421426 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:18.422636 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m02:44:18.477769 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.479073 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m02:44:18.480005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:44:18.505065 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
[0m02:44:18.519934 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.529045 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */

    create table "*****"."public"."subscription_periods" (subscription_id integer,customer_id integer,start_date date,end_date date,monthly_amount integer)
  
[0m02:44:18.536951 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
[0m02:44:18.743297 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.746785 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m02:44:18.751343 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m02:44:18.761106 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m02:44:18.801095 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m02:44:18.802902 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.804208 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m02:44:18.806125 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.807887 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:18.809366 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m02:44:18.811535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf9493490>]}
[0m02:44:18.813090 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.39s]
[0m02:44:18.815939 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m02:44:18.820260 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:18.821766 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.822730 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.823801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:18.848040 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m02:44:18.851115 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.852514 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.853865 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.855902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.857045 [debug] [MainThread]: On master: Close
[0m02:44:18.859039 [info ] [MainThread]: 
[0m02:44:18.860565 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m02:44:18.861658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:18.862676 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m02:44:18.884965 [info ] [MainThread]: 
[0m02:44:18.886419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:18.887983 [info ] [MainThread]: 
[0m02:44:18.889333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:44:18.890575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa1e3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf962c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf949a550>]}
[0m02:44:18.891755 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:44:23.286518 | d7123607-9abe-412c-b02c-cfad4c01e134 ==============================
[0m02:44:23.286544 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:44:23.287604 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:44:23.288755 [debug] [MainThread]: Tracking: tracking
[0m02:44:23.297180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92b20>]}
[0m02:44:23.374408 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:44:23.376049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa74ff10>]}
[0m02:44:23.485650 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:44:23.488491 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:44:23.532302 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:44:23.537973 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:44:23.541743 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:44:23.545092 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:23.548022 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:23.549423 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:23.551908 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:23.553415 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:23.555429 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:23.566992 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:44:23.569635 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:44:23.572703 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:44:23.576871 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:44:23.580235 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:44:23.583202 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:44:23.585193 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:44:23.588573 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:44:23.590748 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:44:23.592517 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:44:23.605238 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:44:23.613791 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:44:23.627438 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:44:23.630079 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:44:23.632403 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:23.636281 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:44:23.638430 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:44:23.640576 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:23.642763 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:23.647680 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:23.650240 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:23.653814 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:44:23.663943 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:44:23.667039 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:44:23.669385 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:44:23.671398 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:44:23.673531 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:44:23.676204 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:44:23.678444 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:23.681395 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:44:23.683857 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:44:23.687020 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:44:23.689569 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:44:23.694039 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:44:23.698633 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:44:23.701935 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:44:23.705115 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:44:23.722572 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:44:23.747511 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:44:23.751875 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:44:23.756204 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:44:23.775992 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:44:23.780386 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:44:23.792399 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:44:23.800168 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:44:23.805477 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:44:23.809593 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:44:23.815999 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:44:23.821904 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:44:23.835828 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:44:23.851093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:44:23.868594 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:44:23.916316 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:44:23.921576 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:44:23.950109 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:44:23.970335 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:44:23.973989 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:44:23.977970 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:44:23.983728 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:44:23.992678 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:44:24.015809 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:44:24.040434 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:44:24.060238 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:44:24.064005 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:44:24.067341 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:44:24.070396 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:44:24.077358 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:44:24.108996 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:44:24.121065 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:44:24.126287 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:44:24.130038 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:44:24.132557 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:44:24.135199 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:44:24.137140 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:44:24.142575 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:44:24.151781 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:44:24.155307 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:44:24.161077 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:44:24.180046 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:44:24.183401 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:44:24.186088 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:44:24.188973 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:44:24.191130 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:44:24.197210 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:44:24.200206 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:44:24.202333 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:44:24.205687 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:44:24.208732 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:44:24.214319 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:44:24.218355 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:44:24.221700 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:44:24.231133 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:44:24.233727 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:44:24.236075 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:44:24.238316 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:44:24.240816 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:44:24.280108 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:44:24.286042 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:44:24.288686 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:44:24.292629 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:44:24.295890 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:44:24.301858 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:44:24.305732 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:44:24.310643 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:44:24.326833 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:44:24.332564 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:44:24.335354 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:44:24.339107 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:44:24.342259 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:44:24.346060 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:44:24.351591 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:44:24.354430 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:44:24.357149 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:44:24.362640 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:44:24.370681 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:44:24.378084 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:44:24.386948 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:44:24.391174 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:44:24.396782 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:44:24.402600 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:44:24.413384 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:44:24.416893 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:44:24.419398 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:44:24.428554 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:44:24.432049 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:44:24.435730 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:44:24.441930 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:44:24.446040 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:44:24.452332 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:44:24.458450 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:44:24.471138 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:44:24.484453 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:44:24.495327 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:44:24.500674 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:44:25.163662 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:44:25.179745 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:44:25.184348 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:44:25.200052 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:44:25.215766 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:44:25.219021 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:44:25.264277 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:44:25.488764 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:44:25.636772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a82c90d0>]}
[0m02:44:25.640965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92b20>]}
[0m02:44:25.642690 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:44:25.644723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f00580>]}
[0m02:44:25.648084 [info ] [MainThread]: 
[0m02:44:25.650196 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:25.652411 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:44:25.663398 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:44:25.665054 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:44:25.666461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:25.674672 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:44:25.678690 [debug] [ThreadPool]: On list_*****: Close
[0m02:44:25.682783 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:44:25.694190 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:25.695812 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:44:25.697156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:25.702849 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.704271 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:25.705395 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:44:25.709647 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m02:44:25.714451 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:44:25.716230 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:44:25.726012 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.727625 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.729069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:25.735878 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.737374 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.738628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:25.747765 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:44:25.750870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a82c3a90>]}
[0m02:44:25.752631 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:25.753957 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.755090 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.756727 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:44:25.757889 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.759437 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.760388 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.761827 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:25.762978 [debug] [MainThread]: On master: Close
[0m02:44:25.764501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:25.766219 [info ] [MainThread]: 
[0m02:44:25.786936 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:44:25.789427 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:44:25.793286 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:44:25.795141 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:44:25.797013 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:44:25.829265 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.831042 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:44:25.834046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:44:25.842035 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.843698 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.845088 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01')::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01')::date))
    


[0m02:44:25.851511 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:44:25.855031 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m02:44:25.875802 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:25.876966 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m02:44:25.935874 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m02:44:25.946119 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.947121 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01' + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m02:44:25.952016 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type interval: "2018-01-01"
LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
             ^

[0m02:44:25.953226 [debug] [Thread-1  ]: On model.acme.util_months: ROLLBACK
[0m02:44:25.955124 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:25.956065 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:44:25.957319 [debug] [Thread-1  ]: Database Error in model util_months (models/utils/util_months.sql)
  invalid input syntax for type interval: "2018-01-01"
  LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
               ^
  compiled Code at target/run/acme/models/utils/util_months.sql
[0m02:44:25.958351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8259640>]}
[0m02:44:25.959455 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.util_months ........................ [[31mERROR[0m in 0.17s]
[0m02:44:25.960772 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:44:25.963221 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:25.964451 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.965494 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.966543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:25.972189 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.973369 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.974629 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.975779 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.977215 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:25.978269 [debug] [MainThread]: On master: Close
[0m02:44:25.980013 [info ] [MainThread]: 
[0m02:44:25.981552 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m02:44:25.983078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:25.984337 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:44:25.985837 [info ] [MainThread]: 
[0m02:44:25.987114 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:44:25.988390 [info ] [MainThread]: 
[0m02:44:25.989560 [error] [MainThread]: [33mDatabase Error in model util_months (models/utils/util_months.sql)[0m
[0m02:44:25.990759 [error] [MainThread]:   invalid input syntax for type interval: "2018-01-01"
[0m02:44:25.992165 [error] [MainThread]:   LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
[0m02:44:25.993329 [error] [MainThread]:                ^
[0m02:44:25.994686 [error] [MainThread]:   compiled Code at target/run/acme/models/utils/util_months.sql
[0m02:44:25.996574 [info ] [MainThread]: 
[0m02:44:25.997841 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:44:25.999581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f2130>]}
[0m02:44:26.000853 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:28.016393 | 9bfe17d8-6e50-445c-9e21-73b13be45daa ==============================
[0m02:46:28.016427 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:28.017891 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:46:28.019056 [debug] [MainThread]: Tracking: tracking
[0m02:46:28.028556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7ca0>]}
[0m02:46:28.032009 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d0__o6mr'
[0m02:46:28.033568 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:46:28.357198 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:46:28.359853 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:46:28.597476 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:46:28.692949 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:46:31.853028 [info ] [MainThread]:   Installed from version 0.8.0
[0m02:46:31.856011 [info ] [MainThread]:   Updated version available: 0.9.6
[0m02:46:31.859978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bfe17d8-6e50-445c-9e21-73b13be45daa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a58068280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a581d3d90>]}
[0m02:46:31.862108 [info ] [MainThread]: 
[0m02:46:31.863829 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:46:31.866225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a58068220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580680a0>]}
[0m02:46:31.867829 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:35.513186 | c7b233d7-08b3-460f-8a37-65b699a51cd9 ==============================
[0m02:46:35.513215 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:35.514178 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:46:35.515244 [debug] [MainThread]: Tracking: tracking
[0m02:46:35.523297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c2b0>]}
[0m02:46:35.611636 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:46:35.615829 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:46:35.617822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c5e0>]}
[0m02:46:35.813123 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:46:35.817852 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:46:35.862345 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:46:35.866765 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:46:35.870190 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:46:35.873914 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:35.877274 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:35.878780 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:35.881161 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:35.882653 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:35.884941 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:35.896413 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:46:35.898692 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:46:35.901728 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:46:35.905893 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:46:35.909146 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:46:35.912039 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:46:35.914112 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:46:35.916691 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:46:35.918481 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:46:35.920647 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:46:35.931447 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:46:35.939634 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:46:35.953506 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:46:35.960135 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:46:35.962510 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:35.967362 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:46:35.969899 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:46:35.971850 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:35.974014 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:35.977623 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:35.980194 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:35.984235 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:46:35.994153 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:46:35.997152 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:46:35.999658 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:46:36.002191 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:46:36.004502 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:46:36.006767 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:46:36.009579 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:36.012630 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:46:36.015404 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:46:36.019274 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:46:36.022168 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:46:36.025322 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:46:36.028551 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:46:36.032015 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:46:36.036302 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:46:36.059290 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:46:36.093258 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:46:36.108045 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:46:36.114324 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:46:36.139179 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:46:36.147237 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:46:36.179613 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:46:36.210700 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:46:36.228073 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:46:36.234408 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:46:36.242944 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:46:36.252636 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:46:36.264845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:46:36.280791 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:46:36.292253 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:46:36.320829 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:46:36.324193 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:46:36.349845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:46:36.365900 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:46:36.368832 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:46:36.372385 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:46:36.378001 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:46:36.387442 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:46:36.409697 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:46:36.439409 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:46:36.464944 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:46:36.468940 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:46:36.472282 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:46:36.476033 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:46:36.483264 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:46:36.513625 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:46:36.524868 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:46:36.530328 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:46:36.534171 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:46:36.536382 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:46:36.538936 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:46:36.541184 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:46:36.547460 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:46:36.555749 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:46:36.558794 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:46:36.563804 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:46:36.580780 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:46:36.583185 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:46:36.586797 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:46:36.590026 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:46:36.592799 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:46:36.598385 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:46:36.600936 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:46:36.602959 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:46:36.605782 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:46:36.608364 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:46:36.612989 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:46:36.616311 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:46:36.619669 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:46:36.628544 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:46:36.631273 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:46:36.633386 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:46:36.635848 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:46:36.638150 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:46:36.676726 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:46:36.682047 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:46:36.685028 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:46:36.688901 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:46:36.691986 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:46:36.698121 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:46:36.701298 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:46:36.704929 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:46:36.720481 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:46:36.726070 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:46:36.729017 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:46:36.733372 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:46:36.736803 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:46:36.740486 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:46:36.745230 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:46:36.748256 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:46:36.750852 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:46:36.756080 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:46:36.764046 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:46:36.772060 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:46:36.780995 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:46:36.785186 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:46:36.790672 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:46:36.796780 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:46:36.808582 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:46:36.812086 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:46:36.814639 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:46:36.830187 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:46:36.833669 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:46:36.837076 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:46:36.843797 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:46:36.847175 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:46:36.854362 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:46:36.861381 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:46:36.876988 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:46:36.890748 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:46:36.894951 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:46:36.897898 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:46:37.390374 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:46:37.406145 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:46:37.413338 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:46:37.427952 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:46:37.439706 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:46:37.442926 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:46:37.481449 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:46:37.685081 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:46:37.799629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c25210d0>]}
[0m02:46:37.823428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c315f790>]}
[0m02:46:37.825063 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:46:37.826676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c24a0ee0>]}
[0m02:46:37.829028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c31d19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c24a0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c30bbb80>]}
[0m02:46:37.830325 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:58.578001 | 9c2e196c-e2cc-436f-bd8f-bddae5d4eadc ==============================
[0m02:46:58.578027 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:58.579352 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:46:58.580707 [debug] [MainThread]: Tracking: tracking
[0m02:46:58.586623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad7629af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9730>]}
[0m02:46:58.679907 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:46:58.682125 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:46:58.685067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad3a6e700>]}
[0m02:46:58.793894 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:46:58.797147 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:46:58.836890 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:46:58.843275 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:46:58.846382 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:46:58.849933 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:58.852861 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:58.854209 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:58.856754 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:58.858755 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:58.860916 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:58.872159 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:46:58.875539 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:46:58.879381 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:46:58.883533 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:46:58.886381 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:46:58.888950 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:46:58.891133 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:46:58.894011 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:46:58.896022 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:46:58.897581 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:46:58.908073 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:46:58.916203 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:46:58.930358 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:46:58.933094 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:46:58.935443 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:58.939430 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:46:58.941936 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:46:58.944335 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:58.946663 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:58.949862 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:58.952411 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:58.955940 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:46:58.965861 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:46:58.968893 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:46:58.971395 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:46:58.973631 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:46:58.976536 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:46:58.979916 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:46:58.982396 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:58.984825 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:46:58.986939 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:46:58.989716 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:46:58.991955 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:46:58.994429 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:46:58.996638 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:46:58.998459 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:46:59.000521 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:46:59.014900 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:46:59.039065 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:46:59.045004 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:46:59.049893 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:46:59.070554 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:46:59.075532 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:46:59.087250 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:46:59.095116 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:46:59.100394 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:46:59.106628 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:46:59.113709 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:46:59.119535 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:46:59.129149 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:46:59.142825 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:46:59.153980 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:46:59.183260 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:46:59.186431 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:46:59.211152 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:46:59.227606 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:46:59.230607 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:46:59.234320 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:46:59.239775 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:46:59.250002 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:46:59.273439 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:46:59.298500 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:46:59.317073 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:46:59.320904 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:46:59.324227 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:46:59.327889 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:46:59.334811 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:46:59.365880 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:46:59.377274 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:46:59.382508 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:46:59.386037 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:46:59.388502 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:46:59.391204 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:46:59.393934 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:46:59.400251 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:46:59.408375 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:46:59.411926 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:46:59.416576 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:46:59.434242 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:46:59.437794 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:46:59.440997 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:46:59.444393 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:46:59.446713 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:46:59.452042 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:46:59.454507 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:46:59.456455 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:46:59.459851 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:46:59.462468 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:46:59.466218 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:46:59.469334 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:46:59.472392 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:46:59.481317 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:46:59.484071 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:46:59.486705 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:46:59.489311 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:46:59.492014 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:46:59.531401 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:46:59.536113 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:46:59.538447 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:46:59.541924 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:46:59.545275 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:46:59.550739 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:46:59.553781 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:46:59.556832 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:46:59.572569 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:46:59.576945 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:46:59.579537 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:46:59.583290 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:46:59.586263 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:46:59.589809 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:46:59.594391 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:46:59.597106 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:46:59.599783 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:46:59.604521 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:46:59.612059 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:46:59.619377 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:46:59.627720 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:46:59.631935 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:46:59.637347 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:46:59.643171 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:46:59.653289 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:46:59.656640 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:46:59.659400 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:46:59.669095 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:46:59.672277 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:46:59.675625 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:46:59.682427 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:46:59.685539 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:46:59.692759 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:46:59.698278 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:46:59.711143 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:46:59.723794 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:46:59.727586 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:46:59.731025 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:47:00.226162 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:47:00.241532 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:47:00.246092 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:47:00.260807 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:47:00.271998 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:47:00.275049 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:47:00.313941 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:47:00.512804 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:47:00.647057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad15e10d0>]}
[0m02:47:00.650241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad2119df0>]}
[0m02:47:00.651382 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:47:00.652627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9640>]}
[0m02:47:00.655612 [info ] [MainThread]: 
[0m02:47:00.657207 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:47:00.659414 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:47:00.669076 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:47:00.670307 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:47:00.671603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:47:00.678761 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:47:00.681421 [debug] [ThreadPool]: On list_*****: Close
[0m02:47:00.684451 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:47:00.695003 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:47:00.696397 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:47:00.697667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:47:00.707657 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.709090 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:47:00.710369 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:47:00.717803 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.01 seconds
[0m02:47:00.721554 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:47:00.723297 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:47:00.732362 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.733773 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.734850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:47:00.740462 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.743680 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.745854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:47:00.758650 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:47:00.762349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad15cea30>]}
[0m02:47:00.763860 [debug] [MainThread]: On master: ROLLBACK
[0m02:47:00.765226 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.766777 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.768453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:00.769641 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.770692 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.771727 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.772779 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:00.773790 [debug] [MainThread]: On master: Close
[0m02:47:00.775334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:47:00.777994 [info ] [MainThread]: 
[0m02:47:00.797186 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:47:00.798802 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:47:00.801272 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:47:00.802155 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:47:00.803352 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:47:00.830013 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:47:00.832652 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:47:00.834163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:00.840393 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.841932 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:47:00.843365 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', (2018-01-01)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', (2018-01-01)::date))
    


[0m02:47:00.847087 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot cast type integer to date
LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
                                                                ^

[0m02:47:00.848455 [debug] [Thread-1  ]: On model.acme.util_months: ROLLBACK
[0m02:47:00.851416 [debug] [Thread-1  ]: finished collecting timing info
[0m02:47:00.852781 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:47:00.854457 [debug] [Thread-1  ]: Database Error in model util_months (models/utils/util_months.sql)
  cannot cast type integer to date
  LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
                                                                  ^
[0m02:47:00.855915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ccba90>]}
[0m02:47:00.857342 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.util_months ........................ [[31mERROR[0m in 0.06s]
[0m02:47:00.859540 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:47:00.862607 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:47:00.863929 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.865025 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.866208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:47:00.872482 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.873874 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.875322 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.877071 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.879419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:00.881488 [debug] [MainThread]: On master: Close
[0m02:47:00.883288 [info ] [MainThread]: 
[0m02:47:00.884488 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m02:47:00.885797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:47:00.886942 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:47:00.888217 [info ] [MainThread]: 
[0m02:47:00.889547 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:47:00.890893 [info ] [MainThread]: 
[0m02:47:00.892115 [error] [MainThread]: [33mDatabase Error in model util_months (models/utils/util_months.sql)[0m
[0m02:47:00.893665 [error] [MainThread]:   cannot cast type integer to date
[0m02:47:00.895149 [error] [MainThread]:   LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
[0m02:47:00.896316 [error] [MainThread]:                                                                   ^
[0m02:47:00.897571 [info ] [MainThread]: 
[0m02:47:00.899452 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:47:00.900697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ce61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ce6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ccbcd0>]}
[0m02:47:00.901798 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:49:26.348495 | 8be1e5cc-a340-4c29-8934-58e332534b55 ==============================
[0m02:49:26.348548 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:49:26.350144 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:49:26.351060 [debug] [MainThread]: Tracking: tracking
[0m02:49:26.359118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0ab50>]}
[0m02:49:26.569065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:49:26.570287 [debug] [MainThread]: Partial parsing: updated file: acme://models/utils/util_months.sql
[0m02:49:26.593367 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:49:26.646287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:49:26.683886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d8500d0>]}
[0m02:49:26.687192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d922ca0>]}
[0m02:49:26.688652 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:49:26.689965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d8a4190>]}
[0m02:49:26.692482 [info ] [MainThread]: 
[0m02:49:26.694110 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:26.696436 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:49:26.703724 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:49:26.704776 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:49:26.706279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:26.718448 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:49:26.721089 [debug] [ThreadPool]: On list_*****: Close
[0m02:49:26.724287 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:49:26.734085 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:26.735472 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:49:26.736613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:26.742724 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:49:26.744043 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:26.745496 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:49:26.749682 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m02:49:26.753290 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:49:26.754514 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:49:26.766713 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.767916 [debug] [MainThread]: On master: BEGIN
[0m02:49:26.768914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:26.779284 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:26.780695 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.781763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:26.801613 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m02:49:26.804517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d850c10>]}
[0m02:49:26.807548 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:26.808792 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.809974 [debug] [MainThread]: On master: BEGIN
[0m02:49:26.811481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:26.812696 [debug] [MainThread]: On master: COMMIT
[0m02:49:26.813686 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.814799 [debug] [MainThread]: On master: COMMIT
[0m02:49:26.816110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:26.817093 [debug] [MainThread]: On master: Close
[0m02:49:26.818529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:26.819509 [info ] [MainThread]: 
[0m02:49:26.835748 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:49:26.837421 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:49:26.839496 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:49:26.840720 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:49:26.841883 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:49:26.863365 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.865349 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:49:26.866714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:49:26.871416 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:49:26.872493 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.873683 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m02:49:26.875409 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m02:49:26.878546 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m02:49:26.885329 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:26.886488 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m02:49:26.944741 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m02:49:26.950222 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.951563 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m02:49:26.963892 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m02:49:26.974350 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.975856 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m02:49:26.978346 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:27.002917 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m02:49:27.004458 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:27.005553 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m02:49:27.007915 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:49:27.015507 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:27.016957 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m02:49:27.018647 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:49:27.021715 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:27.022998 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:49:27.024886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911cfcaf10>]}
[0m02:49:27.026292 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.19s]
[0m02:49:27.027876 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:49:27.030813 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:27.031952 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:27.033084 [debug] [MainThread]: On master: BEGIN
[0m02:49:27.033979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:27.039215 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:27.040803 [debug] [MainThread]: On master: COMMIT
[0m02:49:27.041869 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:27.043051 [debug] [MainThread]: On master: COMMIT
[0m02:49:27.044613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:27.045740 [debug] [MainThread]: On master: Close
[0m02:49:27.047513 [info ] [MainThread]: 
[0m02:49:27.049119 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m02:49:27.050527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:27.051715 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:49:27.053030 [info ] [MainThread]: 
[0m02:49:27.054519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:49:27.056003 [info ] [MainThread]: 
[0m02:49:27.057583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:49:27.059167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ff430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ffb20>]}
[0m02:49:27.060492 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:49:31.484535 | 0a3c389a-52e5-4c99-a284-1ec015968861 ==============================
[0m02:49:31.484567 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:49:31.486964 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:49:31.489646 [debug] [MainThread]: Tracking: tracking
[0m02:49:31.499390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01b50>]}
[0m02:49:31.740801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:49:31.742298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:49:31.752572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a6e0d0>]}
[0m02:49:31.755803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3ba7640>]}
[0m02:49:31.756970 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:49:31.758579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3ba7880>]}
[0m02:49:31.761723 [info ] [MainThread]: 
[0m02:49:31.763773 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:31.766308 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:49:31.784799 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:49:31.786273 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:49:31.787622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:31.795313 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:49:31.798690 [debug] [ThreadPool]: On list_*****: Close
[0m02:49:31.802742 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:49:31.815306 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:31.817090 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:49:31.818692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:31.824987 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:49:31.827121 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:31.828621 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:49:31.834056 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:49:31.838015 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:49:31.839523 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:49:31.849411 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.851082 [debug] [MainThread]: On master: BEGIN
[0m02:49:31.852853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:31.858960 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:31.860362 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.861582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:31.871079 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:49:31.873923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3cff880>]}
[0m02:49:31.875437 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:31.877143 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.878587 [debug] [MainThread]: On master: BEGIN
[0m02:49:31.880503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:31.881892 [debug] [MainThread]: On master: COMMIT
[0m02:49:31.882993 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.884171 [debug] [MainThread]: On master: COMMIT
[0m02:49:31.885652 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:31.886855 [debug] [MainThread]: On master: Close
[0m02:49:31.888560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:31.889683 [info ] [MainThread]: 
[0m02:49:31.911321 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:49:31.913285 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:49:31.915483 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:31.916771 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:49:31.918611 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:49:31.924674 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:49:31.929811 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:31.931236 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:49:31.989318 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:49:31.999208 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:32.000938 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:49:32.002470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:49:32.008761 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:49:32.010740 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:32.011976 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when is_active then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when is_active then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        first_active_month = date_month as is_first_month,
        last_active_month = date_month as is_last_month

    from joined

)

select * from final
  );
[0m02:49:32.016135 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "is_active" does not exist
LINE 79:         min(case when is_active then date_month end) over (
                               ^

[0m02:49:32.018242 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:49:32.020052 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:32.021528 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:49:32.023478 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "is_active" does not exist
  LINE 79:         min(case when is_active then date_month end) over (
                                 ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:49:32.026854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a7c490>]}
[0m02:49:32.028988 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.11s]
[0m02:49:32.030905 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:49:32.035725 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:32.037564 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:32.038877 [debug] [MainThread]: On master: BEGIN
[0m02:49:32.040340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:32.048129 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:32.050610 [debug] [MainThread]: On master: COMMIT
[0m02:49:32.053017 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:32.054333 [debug] [MainThread]: On master: COMMIT
[0m02:49:32.055958 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:32.057595 [debug] [MainThread]: On master: Close
[0m02:49:32.059837 [info ] [MainThread]: 
[0m02:49:32.062026 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m02:49:32.064135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:32.066280 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:49:32.068219 [info ] [MainThread]: 
[0m02:49:32.069774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:32.071480 [info ] [MainThread]: 
[0m02:49:32.073736 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:49:32.075511 [error] [MainThread]:   column "is_active" does not exist
[0m02:49:32.077730 [error] [MainThread]:   LINE 79:         min(case when is_active then date_month end) over (
[0m02:49:32.080907 [error] [MainThread]:                                  ^
[0m02:49:32.084795 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:49:32.087972 [info ] [MainThread]: 
[0m02:49:32.092327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:49:32.095288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3239340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3239d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a7c160>]}
[0m02:49:32.097735 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:51:56.804853 | 68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad ==============================
[0m02:51:56.804889 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:51:56.807294 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:51:56.808860 [debug] [MainThread]: Tracking: tracking
[0m02:51:56.814930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c7621af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c22a2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c22a2730>]}
[0m02:51:57.012835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:51:57.014160 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:51:57.038156 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:51:57.146182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c15349a0>]}
[0m02:51:57.149473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c20ebee0>]}
[0m02:51:57.151684 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:51:57.154004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c2037ee0>]}
[0m02:51:57.160983 [info ] [MainThread]: 
[0m02:51:57.165682 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:51:57.171504 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:51:57.194161 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:51:57.195908 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:51:57.197336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:57.208168 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:51:57.211440 [debug] [ThreadPool]: On list_*****: Close
[0m02:51:57.217336 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:51:57.228522 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:51:57.230311 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:51:57.231924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:57.238091 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.239546 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:51:57.240657 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:51:57.244721 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:51:57.248513 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:51:57.249902 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:51:57.260222 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.261774 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.263487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:51:57.275195 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.276895 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.278233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:51:57.299914 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m02:51:57.303129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c205cd90>]}
[0m02:51:57.304669 [debug] [MainThread]: On master: ROLLBACK
[0m02:51:57.306064 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.307047 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.308885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:51:57.309965 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.311007 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.312370 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.313799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:51:57.314921 [debug] [MainThread]: On master: Close
[0m02:51:57.316634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:51:57.318021 [info ] [MainThread]: 
[0m02:51:57.338218 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:51:57.339754 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:51:57.342195 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.343542 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:51:57.344997 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:51:57.351853 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:51:57.356541 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:57.357922 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:51:57.420173 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:51:57.437997 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.439376 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:51:57.440655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:51:57.450694 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.465430 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.466967 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        first_active_month = date_month as is_first_month,
        last_active_month = date_month as is_last_month

    from joined

)

select * from final
  );
[0m02:51:57.506507 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "first_active_month" does not exist
LINE 88:         first_active_month = date_month as is_first_month,
                 ^

[0m02:51:57.537608 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:51:57.539942 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:57.541764 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:51:57.544026 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "first_active_month" does not exist
  LINE 88:         first_active_month = date_month as is_first_month,
                   ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:51:57.545539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c0ce9f70>]}
[0m02:51:57.547881 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.20s]
[0m02:51:57.549626 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:51:57.553189 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:51:57.554675 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.556033 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.557551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:51:57.563715 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.564987 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.566321 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.567624 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.569109 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:51:57.570475 [debug] [MainThread]: On master: Close
[0m02:51:57.572345 [info ] [MainThread]: 
[0m02:51:57.573745 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m02:51:57.575318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:57.576481 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:51:57.577706 [info ] [MainThread]: 
[0m02:51:57.579219 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:51:57.580493 [info ] [MainThread]: 
[0m02:51:57.582084 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:51:57.583309 [error] [MainThread]:   column "first_active_month" does not exist
[0m02:51:57.584560 [error] [MainThread]:   LINE 88:         first_active_month = date_month as is_first_month,
[0m02:51:57.585804 [error] [MainThread]:                    ^
[0m02:51:57.587068 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:51:57.588260 [info ] [MainThread]: 
[0m02:51:57.589545 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:51:57.590978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c1572a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c1572490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c0ce9ac0>]}
[0m02:51:57.592196 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:52:59.048139 | 4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c ==============================
[0m02:52:59.048196 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:52:59.049292 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:52:59.050317 [debug] [MainThread]: Tracking: tracking
[0m02:52:59.056599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3b50>]}
[0m02:52:59.245663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:52:59.247146 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:52:59.269591 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:52:59.374009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2088fd0>]}
[0m02:52:59.377306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2c26550>]}
[0m02:52:59.378561 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:52:59.379863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2b78f70>]}
[0m02:52:59.382929 [info ] [MainThread]: 
[0m02:52:59.384418 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:52:59.386622 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:52:59.403341 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:52:59.405111 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:52:59.406523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:59.413332 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:52:59.416225 [debug] [ThreadPool]: On list_*****: Close
[0m02:52:59.420244 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:52:59.438786 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:52:59.440821 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:52:59.442050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:59.447527 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.449056 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:52:59.450117 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:52:59.453776 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:52:59.458502 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:52:59.460512 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:52:59.469824 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.471638 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.472995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:59.478519 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.479966 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.481023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:52:59.492457 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:52:59.495639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2b9ceb0>]}
[0m02:52:59.497089 [debug] [MainThread]: On master: ROLLBACK
[0m02:52:59.498384 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.499713 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.501419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:52:59.503130 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.504521 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.505923 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.507542 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:59.509025 [debug] [MainThread]: On master: Close
[0m02:52:59.513652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:52:59.516590 [info ] [MainThread]: 
[0m02:52:59.536763 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:52:59.538693 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:52:59.541491 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.542849 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:52:59.544040 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:52:59.550250 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:52:59.554116 [debug] [Thread-1  ]: finished collecting timing info
[0m02:52:59.555554 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:52:59.615015 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:52:59.619455 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.620583 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:52:59.621594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:52:59.626797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.628529 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.629503 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when first_active_month = date_month then true
          else false end as is_first_month,
        case
          when last_active_month = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m02:52:59.632101 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "first_active_month" does not exist
LINE 89:           when first_active_month = date_month then true
                        ^

[0m02:52:59.633231 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:52:59.634691 [debug] [Thread-1  ]: finished collecting timing info
[0m02:52:59.635956 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:52:59.637540 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "first_active_month" does not exist
  LINE 89:           when first_active_month = date_month then true
                          ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:52:59.639231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff1829ac0>]}
[0m02:52:59.641249 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.10s]
[0m02:52:59.642763 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:52:59.646536 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:52:59.647862 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.649016 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.650090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:52:59.655914 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.657370 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.658445 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.659695 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.661201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:59.662295 [debug] [MainThread]: On master: Close
[0m02:52:59.663980 [info ] [MainThread]: 
[0m02:52:59.665133 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:52:59.666428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:52:59.667495 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:52:59.668721 [info ] [MainThread]: 
[0m02:52:59.669962 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:52:59.671464 [info ] [MainThread]: 
[0m02:52:59.672867 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:52:59.674268 [error] [MainThread]:   column "first_active_month" does not exist
[0m02:52:59.675642 [error] [MainThread]:   LINE 89:           when first_active_month = date_month then true
[0m02:52:59.676786 [error] [MainThread]:                           ^
[0m02:52:59.677991 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:52:59.679318 [info ] [MainThread]: 
[0m02:52:59.680489 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:52:59.681979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3190>]}
[0m02:52:59.683298 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:53:49.486996 | 91299223-e00b-48c2-8a69-55c2e1a8a0bb ==============================
[0m02:53:49.487029 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:53:49.488938 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:49.491233 [debug] [MainThread]: Tracking: tracking
[0m02:53:49.498190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513cb50>]}
[0m02:53:49.698146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:49.699495 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:53:49.721751 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:53:49.823069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f45eefd0>]}
[0m02:53:49.826711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4f77550>]}
[0m02:53:49.827993 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:53:49.829237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4ec9f70>]}
[0m02:53:49.833595 [info ] [MainThread]: 
[0m02:53:49.838026 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:49.842604 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:53:49.862607 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:53:49.864032 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:53:49.865895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:49.876094 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:53:49.879222 [debug] [ThreadPool]: On list_*****: Close
[0m02:53:49.885077 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:53:49.900287 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:49.902413 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:53:49.903901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:49.910110 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:53:49.911508 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:49.912866 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:49.916934 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:53:49.921264 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:53:49.923018 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:53:49.933927 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.936074 [debug] [MainThread]: On master: BEGIN
[0m02:53:49.937744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:49.944335 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:49.945984 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.947236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:49.960076 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:53:49.963052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4eedeb0>]}
[0m02:53:49.964415 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:49.965904 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.967031 [debug] [MainThread]: On master: BEGIN
[0m02:53:49.969125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:49.970721 [debug] [MainThread]: On master: COMMIT
[0m02:53:49.971889 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.973041 [debug] [MainThread]: On master: COMMIT
[0m02:53:49.974406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:49.975439 [debug] [MainThread]: On master: Close
[0m02:53:49.977060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:49.978317 [info ] [MainThread]: 
[0m02:53:49.999576 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:53:50.001402 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:53:50.003818 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.005536 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:53:50.007011 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:53:50.013427 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:53:50.034419 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:50.036130 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:53:50.107243 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:53:50.111819 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.112777 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:53:50.113876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:53:50.119565 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:53:50.121266 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.122730 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m02:53:50.128801 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:53:50.139947 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.141787 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m02:53:50.143816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:50.171481 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m02:53:50.174441 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.176105 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m02:53:50.180941 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:53:50.194859 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.197570 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m02:53:50.200970 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:53:50.206703 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:50.207888 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:53:50.209781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4572970>]}
[0m02:53:50.212383 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.21s]
[0m02:53:50.213567 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:53:50.216540 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:50.217946 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:50.219358 [debug] [MainThread]: On master: BEGIN
[0m02:53:50.220725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:50.226749 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:50.228185 [debug] [MainThread]: On master: COMMIT
[0m02:53:50.229437 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:50.230613 [debug] [MainThread]: On master: COMMIT
[0m02:53:50.232119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:50.234970 [debug] [MainThread]: On master: Close
[0m02:53:50.237412 [info ] [MainThread]: 
[0m02:53:50.239296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:53:50.241731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:50.244319 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:53:50.246239 [info ] [MainThread]: 
[0m02:53:50.247787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:53:50.249252 [info ] [MainThread]: 
[0m02:53:50.251072 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:53:50.252976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4594430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f45942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4594b20>]}
[0m02:53:50.254623 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:53:54.936531 | 882621ac-e923-4cda-85eb-a0de03201756 ==============================
[0m02:53:54.936573 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:53:54.938186 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:54.939972 [debug] [MainThread]: Tracking: tracking
[0m02:53:54.947691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548b50>]}
[0m02:53:55.126590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:53:55.127766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:53:55.136534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b50d0>]}
[0m02:53:55.140557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b3ec640>]}
[0m02:53:55.142471 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:53:55.144132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b3ec880>]}
[0m02:53:55.146681 [info ] [MainThread]: 
[0m02:53:55.148325 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:55.150289 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:53:55.180615 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:53:55.183667 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:53:55.185942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:55.198607 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:53:55.206239 [debug] [ThreadPool]: On list_*****: Close
[0m02:53:55.213154 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:53:55.245251 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:55.247796 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:53:55.249957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:55.259755 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.262247 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:55.264741 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:55.273076 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.01 seconds
[0m02:53:55.282296 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:53:55.284349 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:53:55.301193 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.303092 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.305417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:55.316263 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.319876 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.322104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:55.343946 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
[0m02:53:55.349137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b53f040>]}
[0m02:53:55.351581 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:55.354052 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.355983 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.358789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:55.361288 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.363352 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.364890 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.367281 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:55.369724 [debug] [MainThread]: On master: Close
[0m02:53:55.372901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:55.375120 [info ] [MainThread]: 
[0m02:53:55.407592 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:53:55.410347 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:53:55.412941 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:53:55.414584 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:53:55.416399 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:53:55.425945 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:53:55.438040 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:55.440170 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:53:55.546772 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:53:55.553910 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:53:55.556004 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:53:55.558102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:53:55.568358 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.570580 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:53:55.572825 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd(month, 1, date_month)::date as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:53:55.576744 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "month" does not exist
LINE 14:         dateadd(month, 1, date_month)::date as date_month,
                         ^

[0m02:53:55.578421 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:53:55.580473 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:55.582106 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:53:55.584947 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  column "month" does not exist
  LINE 14:         dateadd(month, 1, date_month)::date as date_month,
                           ^
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:53:55.586989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2d2bb0>]}
[0m02:53:55.589086 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.17s]
[0m02:53:55.591473 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:53:55.597550 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:55.599560 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.601287 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.603007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:55.612365 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.614242 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.615876 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.617662 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.619812 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:55.622100 [debug] [MainThread]: On master: Close
[0m02:53:55.624025 [info ] [MainThread]: 
[0m02:53:55.625464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m02:53:55.627257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:55.628706 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:53:55.630841 [info ] [MainThread]: 
[0m02:53:55.632514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:53:55.634689 [info ] [MainThread]: 
[0m02:53:55.636578 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:53:55.638763 [error] [MainThread]:   column "month" does not exist
[0m02:53:55.640941 [error] [MainThread]:   LINE 14:         dateadd(month, 1, date_month)::date as date_month,
[0m02:53:55.642937 [error] [MainThread]:                            ^
[0m02:53:55.644613 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:53:55.646425 [info ] [MainThread]: 
[0m02:53:55.648245 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:53:55.650516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2d2070>]}
[0m02:53:55.657292 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:54:57.669217 | 15c7e76c-a97f-4c38-80a3-07256b847ba9 ==============================
[0m02:54:57.669289 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:54:57.674456 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:54:57.676314 [debug] [MainThread]: Tracking: tracking
[0m02:54:57.684363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7c9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7b5700>]}
[0m02:54:57.895973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:54:57.897376 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:54:57.920285 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:54:58.004580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9ceb0d0>]}
[0m02:54:58.007944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca606eb0>]}
[0m02:54:58.009303 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:54:58.011007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca554dc0>]}
[0m02:54:58.014382 [info ] [MainThread]: 
[0m02:54:58.016065 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:54:58.018211 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:54:58.034869 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:54:58.036292 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:54:58.037488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:58.046879 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:54:58.049816 [debug] [ThreadPool]: On list_*****: Close
[0m02:54:58.053172 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:54:58.062837 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:54:58.064401 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:54:58.065498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:58.071208 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.072591 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:54:58.073703 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:54:58.078675 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:54:58.082812 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:54:58.084335 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:54:58.093906 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.095816 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.099839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:58.107853 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.110195 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.112857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:54:58.127184 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:54:58.131002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca781b80>]}
[0m02:54:58.133184 [debug] [MainThread]: On master: ROLLBACK
[0m02:54:58.140042 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.142749 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.148474 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:58.150141 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.151741 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.152992 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.154732 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:58.156014 [debug] [MainThread]: On master: Close
[0m02:54:58.158470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:54:58.161352 [info ] [MainThread]: 
[0m02:54:58.184368 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:54:58.186234 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:54:58.188377 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:54:58.189464 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:54:58.190719 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:54:58.198687 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:54:58.204584 [debug] [Thread-1  ]: finished collecting timing info
[0m02:54:58.205897 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:54:58.263733 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:54:58.293203 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:54:58.295082 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:54:58.296523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:54:58.302014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.303896 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:54:58.307088 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd('month', 1, date_month)::date as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:54:58.309446 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function dateadd(unknown, integer, timestamp without time zone) does not exist
LINE 14:         dateadd('month', 1, date_month)::date as date_month,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:54:58.310919 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:54:58.312748 [debug] [Thread-1  ]: finished collecting timing info
[0m02:54:58.314065 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:54:58.316106 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  function dateadd(unknown, integer, timestamp without time zone) does not exist
  LINE 14:         dateadd('month', 1, date_month)::date as date_month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:54:58.317852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c894f0>]}
[0m02:54:58.318955 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.13s]
[0m02:54:58.320360 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:54:58.322865 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:54:58.323904 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.325013 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.326209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:54:58.331601 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.332934 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.334584 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.335643 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.336891 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:58.337878 [debug] [MainThread]: On master: Close
[0m02:54:58.339616 [info ] [MainThread]: 
[0m02:54:58.341375 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m02:54:58.342643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:58.343889 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:54:58.345457 [info ] [MainThread]: 
[0m02:54:58.346789 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:54:58.348115 [info ] [MainThread]: 
[0m02:54:58.349351 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:54:58.350560 [error] [MainThread]:   function dateadd(unknown, integer, timestamp without time zone) does not exist
[0m02:54:58.351565 [error] [MainThread]:   LINE 14:         dateadd('month', 1, date_month)::date as date_month,
[0m02:54:58.352599 [error] [MainThread]:                    ^
[0m02:54:58.353754 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:54:58.354959 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:54:58.356134 [info ] [MainThread]: 
[0m02:54:58.357105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:54:58.358341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c73bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c73520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c734f0>]}
[0m02:54:58.359511 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:56:30.419139 | 6800ef23-1357-4b05-80be-376d6d4c8940 ==============================
[0m02:56:30.419220 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:56:30.420044 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:56:30.422175 [debug] [MainThread]: Tracking: tracking
[0m02:56:30.427585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303cb20>]}
[0m02:56:30.603957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:56:30.605349 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:56:30.626818 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:56:30.701852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff23640d0>]}
[0m02:56:30.705128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e7e550>]}
[0m02:56:30.706733 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:56:30.708120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e84fd0>]}
[0m02:56:30.710504 [info ] [MainThread]: 
[0m02:56:30.712175 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:56:30.713951 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:56:30.729271 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:56:30.730599 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:56:30.731985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:30.737904 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:56:30.740517 [debug] [ThreadPool]: On list_*****: Close
[0m02:56:30.743360 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:56:30.752648 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:56:30.754109 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:56:30.755492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:56:30.760687 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:56:30.761975 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:56:30.763028 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:56:30.766549 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:56:30.770886 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:56:30.772426 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:56:30.780860 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.782117 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.783330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:30.788717 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:56:30.790073 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.791263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:56:30.803560 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:56:30.806418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e7e400>]}
[0m02:56:30.807814 [debug] [MainThread]: On master: ROLLBACK
[0m02:56:30.809060 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.810217 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.811800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.812967 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.814094 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.815216 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.816761 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:30.817953 [debug] [MainThread]: On master: Close
[0m02:56:30.820633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:56:30.822094 [info ] [MainThread]: 
[0m02:56:30.837277 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:56:30.838684 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:56:30.840237 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:56:30.841169 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:56:30.842136 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:56:30.846358 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:56:30.849412 [debug] [Thread-1  ]: finished collecting timing info
[0m02:56:30.850663 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:56:30.901887 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:56:30.905951 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:56:30.907029 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:56:30.907948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:30.912437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.913552 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:56:30.914573 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd(month, 1, date_month::date) as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:56:30.916674 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "month" does not exist
LINE 14:         dateadd(month, 1, date_month::date) as date_month,
                         ^

[0m02:56:30.917790 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:56:30.921302 [debug] [Thread-1  ]: finished collecting timing info
[0m02:56:30.923424 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:56:30.924917 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  column "month" does not exist
  LINE 14:         dateadd(month, 1, date_month::date) as date_month,
                           ^
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:56:30.926158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1a99f40>]}
[0m02:56:30.927520 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.09s]
[0m02:56:30.929030 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:56:30.931667 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:56:30.932972 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.934080 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.935304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:30.940279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.941631 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.942589 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.943662 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.945047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:30.946137 [debug] [MainThread]: On master: Close
[0m02:56:30.947729 [info ] [MainThread]: 
[0m02:56:30.949196 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m02:56:30.950691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:30.951718 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:56:30.952869 [info ] [MainThread]: 
[0m02:56:30.954337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:56:30.955756 [info ] [MainThread]: 
[0m02:56:30.957109 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:56:30.958532 [error] [MainThread]:   column "month" does not exist
[0m02:56:30.959884 [error] [MainThread]:   LINE 14:         dateadd(month, 1, date_month::date) as date_month,
[0m02:56:30.961040 [error] [MainThread]:                            ^
[0m02:56:30.962550 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:56:30.963626 [info ] [MainThread]: 
[0m02:56:30.964971 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:56:30.967451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff22fdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff22fdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1a82f70>]}
[0m02:56:30.968746 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:57:38.006657 | e81cf26b-c5e9-44d6-84c7-fae1a91e1dff ==============================
[0m02:57:38.006684 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:57:38.008209 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:57:38.009840 [debug] [MainThread]: Tracking: tracking
[0m02:57:38.015382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544b20>]}
[0m02:57:38.212856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:57:38.214292 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:57:38.235782 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:57:38.312382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8686b0d0>]}
[0m02:57:38.315472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87386550>]}
[0m02:57:38.316783 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:57:38.318092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8738efd0>]}
[0m02:57:38.321272 [info ] [MainThread]: 
[0m02:57:38.323374 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:38.325655 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:57:38.342649 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:57:38.344405 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:57:38.345726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:38.352511 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:38.355598 [debug] [ThreadPool]: On list_*****: Close
[0m02:57:38.359023 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:57:38.368731 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:38.370129 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:57:38.371378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:38.377060 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.378345 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:38.379450 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:57:38.383105 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:57:38.386643 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:57:38.388222 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:57:38.397900 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.399266 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.400510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:38.406001 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.407729 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.409306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:57:38.418431 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:57:38.421639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87386400>]}
[0m02:57:38.423200 [debug] [MainThread]: On master: ROLLBACK
[0m02:57:38.424716 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.425858 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.427541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:38.428518 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.429409 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.430612 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.432346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.433368 [debug] [MainThread]: On master: Close
[0m02:57:38.435456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:38.443274 [info ] [MainThread]: 
[0m02:57:38.465979 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:57:38.467725 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:57:38.469788 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:57:38.471755 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:57:38.473524 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:57:38.478920 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:57:38.482754 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:38.484230 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:57:38.551406 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:57:38.556054 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.557463 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:57:38.558888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:38.564598 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.565700 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.566847 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:57:38.571355 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:57:38.580784 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.582568 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m02:57:38.584100 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:38.608413 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m02:57:38.610397 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.611403 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m02:57:38.613406 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.620638 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.621832 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m02:57:38.624086 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:57:38.626482 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:38.627448 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:57:38.628942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85f74fd0>]}
[0m02:57:38.630350 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.16s]
[0m02:57:38.631690 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:57:38.637116 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:38.640229 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.641931 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.643386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:38.648847 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.650074 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.651032 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.652122 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.653442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.654925 [debug] [MainThread]: On master: Close
[0m02:57:38.656543 [info ] [MainThread]: 
[0m02:57:38.658029 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m02:57:38.659095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:38.659974 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:57:38.661151 [info ] [MainThread]: 
[0m02:57:38.662190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:57:38.663227 [info ] [MainThread]: 
[0m02:57:38.664473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:57:38.665767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85fa54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85fa5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85f9aca0>]}
[0m02:57:38.666905 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:57:43.705161 | a782aa2d-38b6-4ac3-8888-344a52799f27 ==============================
[0m02:57:43.705197 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:57:43.706496 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:57:43.707624 [debug] [MainThread]: Tracking: tracking
[0m02:57:43.714529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cdb20>]}
[0m02:57:43.886266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:57:43.887173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:57:43.896105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d623afd0>]}
[0m02:57:43.899321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d636f5e0>]}
[0m02:57:43.900406 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:57:43.901658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d636f820>]}
[0m02:57:43.904036 [info ] [MainThread]: 
[0m02:57:43.905541 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:43.907613 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:57:43.922159 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:57:43.924545 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:57:43.925851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:43.932040 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:43.934294 [debug] [ThreadPool]: On list_*****: Close
[0m02:57:43.937070 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:57:43.946371 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:43.947635 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:57:43.948932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:43.954414 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:57:43.955756 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:43.956980 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:57:43.960696 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m02:57:43.965216 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:57:43.967164 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:57:43.976937 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:43.978862 [debug] [MainThread]: On master: BEGIN
[0m02:57:43.980165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:43.985883 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:43.987283 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:43.988802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:57:43.999763 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:44.002443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d6499490>]}
[0m02:57:44.003950 [debug] [MainThread]: On master: ROLLBACK
[0m02:57:44.005472 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.006722 [debug] [MainThread]: On master: BEGIN
[0m02:57:44.008464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.009654 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.011023 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.012269 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.013772 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.015071 [debug] [MainThread]: On master: Close
[0m02:57:44.016623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:44.017853 [info ] [MainThread]: 
[0m02:57:44.036942 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m02:57:44.038663 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m02:57:44.040538 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m02:57:44.041867 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m02:57:44.043065 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m02:57:44.060050 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:57:44.072156 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m02:57:44.076328 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:44.078236 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m02:57:44.128024 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m02:57:44.132731 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:57:44.133708 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m02:57:44.134868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:44.139660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.140875 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:57:44.141870 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - previous_month_mrr as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m02:57:44.145051 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "previous_month_mrr" does not exist
LINE 30:         mrr - previous_month_mrr as mrr_change
                       ^

[0m02:57:44.146296 [debug] [Thread-1  ]: On model.acme.mrr: ROLLBACK
[0m02:57:44.147434 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:44.148402 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m02:57:44.150220 [debug] [Thread-1  ]: Database Error in model mrr (models/mrr.sql)
  column "previous_month_mrr" does not exist
  LINE 30:         mrr - previous_month_mrr as mrr_change
                         ^
  compiled Code at target/run/acme/models/mrr.sql
[0m02:57:44.151323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62468e0>]}
[0m02:57:44.152478 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.mrr ................................ [[31mERROR[0m in 0.11s]
[0m02:57:44.154141 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m02:57:44.156592 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:44.157708 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.158947 [debug] [MainThread]: On master: BEGIN
[0m02:57:44.159856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:44.164690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.165896 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.166966 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.167944 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.169093 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.170246 [debug] [MainThread]: On master: Close
[0m02:57:44.171867 [info ] [MainThread]: 
[0m02:57:44.173719 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m02:57:44.175043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:44.176142 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m02:57:44.177438 [info ] [MainThread]: 
[0m02:57:44.179010 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:57:44.180174 [info ] [MainThread]: 
[0m02:57:44.181696 [error] [MainThread]: [33mDatabase Error in model mrr (models/mrr.sql)[0m
[0m02:57:44.182910 [error] [MainThread]:   column "previous_month_mrr" does not exist
[0m02:57:44.184164 [error] [MainThread]:   LINE 30:         mrr - previous_month_mrr as mrr_change
[0m02:57:44.185356 [error] [MainThread]:                          ^
[0m02:57:44.186489 [error] [MainThread]:   compiled Code at target/run/acme/models/mrr.sql
[0m02:57:44.187572 [info ] [MainThread]: 
[0m02:57:44.188603 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:57:44.189646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d59c6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62462b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62466d0>]}
[0m02:57:44.190717 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:58:46.063956 | 9974b9be-4c7c-4799-b27d-55f90f4428b7 ==============================
[0m02:58:46.063987 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:46.067322 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:58:46.068716 [debug] [MainThread]: Tracking: tracking
[0m02:58:46.078936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5b50>]}
[0m02:58:46.365834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:58:46.367445 [debug] [MainThread]: Partial parsing: updated file: acme://models/mrr.sql
[0m02:58:46.390101 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:58:46.414505 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:58:46.445849 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:58:46.584316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196770d0>]}
[0m02:58:46.587463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196ff400>]}
[0m02:58:46.588967 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:46.590265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1964bfd0>]}
[0m02:58:46.598692 [info ] [MainThread]: 
[0m02:58:46.601127 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:46.603434 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:58:46.620503 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:58:46.622194 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:58:46.623522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:46.631299 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:58:46.634526 [debug] [ThreadPool]: On list_*****: Close
[0m02:58:46.637710 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:46.649293 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:46.650714 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:46.651935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:58:46.657051 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.658289 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:46.659399 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:46.663765 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m02:58:46.668112 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:46.669899 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:46.678884 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.680574 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.682081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:46.688446 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.690063 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.691149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:46.702100 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m02:58:46.705129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196cd730>]}
[0m02:58:46.706558 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:46.708868 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.712471 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.714533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:46.716148 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.717590 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.718856 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.720262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.721788 [debug] [MainThread]: On master: Close
[0m02:58:46.723524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:46.724845 [info ] [MainThread]: 
[0m02:58:46.743139 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m02:58:46.744899 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m02:58:46.746889 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m02:58:46.748330 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m02:58:46.749823 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m02:58:46.756671 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:58:46.759906 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m02:58:46.766604 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:46.767986 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m02:58:46.822178 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m02:58:46.839016 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.840326 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m02:58:46.841547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:46.846605 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.848151 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.849558 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m02:58:46.856287 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m02:58:46.878097 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.879866 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m02:58:46.882319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:58:46.906736 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m02:58:46.908399 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.909504 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m02:58:46.912542 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.920554 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.921692 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m02:58:46.923282 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:58:46.925720 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:46.926916 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m02:58:46.928645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d1be80>]}
[0m02:58:46.929877 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.18s]
[0m02:58:46.931693 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m02:58:46.934726 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:46.935937 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.937066 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.937987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:46.942711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:46.943824 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.944973 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.945920 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.947172 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.948167 [debug] [MainThread]: On master: Close
[0m02:58:46.950030 [info ] [MainThread]: 
[0m02:58:46.951182 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m02:58:46.952621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:46.953585 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m02:58:46.954705 [info ] [MainThread]: 
[0m02:58:46.955804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:46.956843 [info ] [MainThread]: 
[0m02:58:46.957893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:58:46.959028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d13610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d136a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d13790>]}
[0m02:58:46.960185 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:58:56.415066 | 6d54f8a0-b4cf-481a-b60f-22db2dc59a9e ==============================
[0m02:58:56.415095 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.417701 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.420986 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.431945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22b20>]}


============================== 2022-12-01 02:58:56.705314 | 1e085a1d-d729-4194-bb39-d29f357a68d2 ==============================
[0m02:58:56.705615 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.776751 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.786709 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.861070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92eab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92ea430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92eaac0>]}


============================== 2022-12-01 02:58:56.876464 | 9a8e7588-403c-41cb-8221-40db93c48d8a ==============================
[0m02:58:56.876725 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.880039 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.888964 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.907416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb91235af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8beac580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8beac730>]}


============================== 2022-12-01 02:58:56.984086 | 60809037-edbb-4a68-8b54-f9f8c95ed283 ==============================
[0m02:58:56.984126 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.988163 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.993177 [debug] [MainThread]: Tracking: tracking
[0m02:58:57.003702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a8b50>]}
[0m02:58:57.250301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.252589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.268629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de7980d0>]}
[0m02:58:57.274434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1610>]}
[0m02:58:57.277397 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.279295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1850>]}
[0m02:58:57.284734 [info ] [MainThread]: 
[0m02:58:57.287186 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m02:58:57.290323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1430>]}
[0m02:58:57.292633 [debug] [MainThread]: Flushing usage events
[0m02:58:57.430832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.434905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.462625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bc21fa0>]}
[0m02:58:57.469095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a5b0>]}
[0m02:58:57.472233 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.474450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a7f0>]}
[0m02:58:57.480801 [info ] [MainThread]: 
[0m02:58:57.484189 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.491167 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.535598 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.538538 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.542752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.559403 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.560459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.560964 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.563954 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.562600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.568757 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m02:58:57.574119 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.576670 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.590306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a90590d0>]}
[0m02:58:57.590576 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.594948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e610>]}
[0m02:58:57.597700 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.600916 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.602187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.603758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e850>]}
[0m02:58:57.612242 [info ] [MainThread]: 
[0m02:58:57.611743 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.615570 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.615682 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.617338 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.621255 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.630652 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m02:58:57.635612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a400>]}
[0m02:58:57.631042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.638795 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.641016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.642887 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.645024 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.647900 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.648942 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.650479 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.652231 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.653704 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.655227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.656727 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.659258 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.661179 [debug] [MainThread]: On master: Close
[0m02:58:57.663512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.662534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5753314fa0>]}
[0m02:58:57.667397 [info ] [MainThread]: 
[0m02:58:57.664867 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.672872 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.675101 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.679073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c5b0>]}
[0m02:58:57.679848 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m02:58:57.680671 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.682540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c7f0>]}
[0m02:58:57.685436 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.685627 [info ] [MainThread]: 
[0m02:58:57.687229 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.688813 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.692283 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.693631 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m02:58:57.695546 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.696362 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.696507 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.698581 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.698623 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.700990 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.702164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.708008 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.709925 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.711068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.725115 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.728716 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m02:58:57.728853 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.732236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e3a0>]}
[0m02:58:57.733110 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.734914 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.736204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.737857 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.741135 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.750335 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.755531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.759307 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.757340 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.759971 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.760977 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.771433 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.774133 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.780210 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.787435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.798173 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.02 seconds
[0m02:58:57.798944 [debug] [MainThread]: On master: Close
[0m02:58:57.804787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.808555 [info ] [MainThread]: 
[0m02:58:57.807966 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.821096 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.824439 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.835021 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.836639 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.841996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.847298 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.852648 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m02:58:57.849662 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.861185 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m02:58:57.862419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:57.858699 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.865998 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.863791 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.867544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.868359 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.873352 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.885179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.887659 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.893229 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m02:58:57.893958 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m02:58:57.897300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c400>]}
[0m02:58:57.900280 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.902885 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.907415 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.909199 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:57.914463 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.909605 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.913993 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.915337 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m02:58:57.917821 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.919436 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m02:58:57.918534 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.945326 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.25s]
[0m02:58:57.946753 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.948665 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.950324 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.952188 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.953444 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.954975 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.954714 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m02:58:57.956437 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.960265 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:57.960739 [debug] [MainThread]: On master: Close
[0m02:58:57.961994 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.964455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.967027 [info ] [MainThread]: 
[0m02:58:57.965039 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.966490 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.969738 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m02:58:57.971680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:57.980611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.981994 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:57.982460 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.985715 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m02:58:57.991387 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:57.993031 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m02:58:57.995698 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:57.997056 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.997485 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:57.998740 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:58.000349 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.006329 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.012409 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.013935 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m02:58:58.015100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.016386 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m02:58:58.021637 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.023394 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.024251 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.024962 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:58:58.026616 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m02:58:58.029099 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.029617 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m02:58:58.035107 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.17s]
[0m02:58:58.037220 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:58.039381 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.039667 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.041367 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m02:58:58.043784 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.044568 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.045305 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.047040 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m02:58:58.083186 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.084863 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.088086 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m02:58:58.090511 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.093454 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.13s]
[0m02:58:58.097947 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:58.102563 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:58.104331 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.106114 [debug] [MainThread]: On master: BEGIN
[0m02:58:58.108020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:58.118227 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.120925 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.123213 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.125747 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.126248 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.134991 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m02:58:58.139394 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.190734 [debug] [MainThread]: On master: Close
[0m02:58:58.193935 [info ] [MainThread]: 
[0m02:58:58.196752 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m02:58:58.203367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:58.198502 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.199386 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.213397 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.210886 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m02:58:58.214282 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m02:58:58.222851 [info ] [MainThread]: 
[0m02:58:58.224964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.225741 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.228122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:58.232658 [info ] [MainThread]: 
[0m02:58:58.236076 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:58:58.237413 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.239183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b3d9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b3990a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b399040>]}
[0m02:58:58.240109 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.242426 [debug] [MainThread]: Flushing usage events
[0m02:58:58.243632 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:58:58.248078 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.254432 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.253591 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m02:58:58.257430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.262290 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.264640 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m02:58:58.265468 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.266764 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m02:58:58.268427 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.271222 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:58:58.271443 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.28s]
[0m02:58:58.275635 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.282489 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:58.284553 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.286328 [debug] [MainThread]: On master: BEGIN
[0m02:58:58.287953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:58.291620 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.295372 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.296995 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.299023 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.297477 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m02:58:58.301272 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.303847 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.302596 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m02:58:58.305820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:58.308676 [debug] [MainThread]: On master: Close
[0m02:58:58.311583 [info ] [MainThread]: 
[0m02:58:58.307468 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.26s]
[0m02:58:58.313832 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m02:58:58.315692 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.320730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:58.322286 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.323342 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m02:58:58.325334 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m02:58:58.326603 [info ] [MainThread]: 
[0m02:58:58.328844 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.329389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:58.330288 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.332157 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.331393 [info ] [MainThread]: 
[0m02:58:58.334872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:58:58.336771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752acca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752a8b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752a8b040>]}
[0m02:58:58.339064 [debug] [MainThread]: Flushing usage events
[0m02:58:58.352566 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.361729 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.363299 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.372862 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.378942 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.380463 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m02:58:58.381880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.388569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.390262 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.391786 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m02:58:58.404519 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.408985 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.411035 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m02:58:58.413012 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m02:58:58.415388 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.09s]
[0m02:58:58.418477 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.420307 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.421768 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m02:58:58.424024 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.425470 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.427111 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.435119 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.447353 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.449380 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.455243 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.461313 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.463006 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m02:58:58.464611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.471812 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.473676 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.475128 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m02:58:58.489876 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.493755 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.495432 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m02:58:58.497088 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m02:58:58.499495 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.08s]
[0m02:58:58.502235 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.503433 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.504641 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m02:58:58.506495 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.508108 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.509379 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.516781 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.528282 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.530049 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.534848 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.547237 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.548679 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m02:58:58.550155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.556920 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.558679 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.559966 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m02:58:58.575958 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.581209 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.583347 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m02:58:58.585416 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m02:58:58.587457 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.08s]
[0m02:58:58.589485 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.591414 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.595462 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m02:58:58.598843 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.600679 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.602095 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.613151 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.620169 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.622187 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.628996 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.647919 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.649898 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m02:58:58.651746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.659442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.660987 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.662568 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m02:58:58.679717 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.685375 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.687622 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m02:58:58.689998 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m02:58:58.692563 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.10s]
[0m02:58:58.695028 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.696842 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.698462 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m02:58:58.700649 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.702352 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.704155 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.719411 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.727491 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.730234 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.737054 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.749050 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.751468 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m02:58:58.753437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.765224 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.767535 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.769479 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m02:58:58.786583 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.792888 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.795671 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m02:58:58.797964 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m02:58:58.800547 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.10s]
[0m02:58:58.803163 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.805100 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.807009 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m02:58:58.809740 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.812261 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.813944 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.827519 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.848290 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.850714 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.859784 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.867929 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.871327 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m02:58:58.874830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.883276 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.885429 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.887231 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m02:58:58.903916 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.910960 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.914367 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m02:58:58.917500 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m02:58:58.920180 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.11s]
[0m02:58:58.929293 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.931449 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.933204 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m02:58:58.936291 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.938745 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.940725 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.950649 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.958392 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.960436 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.968288 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.977072 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.979171 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m02:58:58.980958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.990587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.992639 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.994244 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m02:58:59.018333 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:59.022339 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.024157 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m02:58:59.026257 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m02:58:59.029924 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.09s]
[0m02:58:59.032322 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:59.034004 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.035509 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m02:58:59.037864 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.060804 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.070937 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.086889 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.098494 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.099945 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.105006 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.111100 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.112712 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m02:58:59.114033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.120859 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.122574 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.124463 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m02:58:59.141556 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.149898 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.152361 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m02:58:59.154142 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m02:58:59.156319 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.12s]
[0m02:58:59.158835 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.160525 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.162271 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m02:58:59.164680 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.166489 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.168239 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.180471 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.203839 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.209999 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.218077 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.227182 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.228816 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m02:58:59.230267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.246695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m02:58:59.248555 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.249954 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m02:58:59.266004 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.269632 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.271328 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m02:58:59.272877 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m02:58:59.275295 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.11s]
[0m02:58:59.278462 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.281308 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.282680 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m02:58:59.285060 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.287128 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.288589 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.298352 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.308906 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.310868 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.316047 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.327296 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.329752 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m02:58:59.330961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.337316 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.338954 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.340243 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m02:58:59.354650 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.358100 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.359648 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m02:58:59.361865 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m02:58:59.363798 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.08s]
[0m02:58:59.365585 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.367179 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.369202 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m02:58:59.371449 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.372815 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.374076 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.382047 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.397505 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.398895 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.405113 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.410462 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.411666 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m02:58:59.413052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.418868 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.420689 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.422140 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m02:58:59.437641 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.442334 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.443910 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m02:58:59.445551 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m02:58:59.448353 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.08s]
[0m02:58:59.453198 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.454876 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.456224 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m02:58:59.459020 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.460510 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.462474 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.470490 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.475990 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.477593 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.486953 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.497710 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.499264 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m02:58:59.500446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.506929 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.508847 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.510092 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m02:58:59.525435 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.532339 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.534316 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m02:58:59.536084 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m02:58:59.538729 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.08s]
[0m02:58:59.541935 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.543537 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.545024 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m02:58:59.547558 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.548984 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.550159 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.562800 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.568293 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.569875 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.575638 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.599190 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.600819 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m02:58:59.602484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.609710 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.611568 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.613132 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:58:59.635411 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:59.639352 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.642302 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m02:58:59.644472 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m02:58:59.646329 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.10s]
[0m02:58:59.648981 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.652363 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:59.653553 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:59.654723 [debug] [MainThread]: On master: BEGIN
[0m02:58:59.655870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:59.661557 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.663125 [debug] [MainThread]: On master: COMMIT
[0m02:58:59.664365 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:59.665507 [debug] [MainThread]: On master: COMMIT
[0m02:58:59.666828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:59.668173 [debug] [MainThread]: On master: Close
[0m02:58:59.670150 [info ] [MainThread]: 
[0m02:58:59.671938 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m02:58:59.673840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:59.675906 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m02:58:59.678805 [info ] [MainThread]: 
[0m02:58:59.681634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:59.683353 [info ] [MainThread]: 
[0m02:58:59.684921 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m02:58:59.686382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87cebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87ceb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87ce4c0>]}
[0m02:58:59.687948 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:09:34.141526 | 6fbc2bcd-f9dd-469a-865a-f0cb013b2729 ==============================
[0m03:09:34.141561 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:09:34.143299 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m03:09:34.145302 [debug] [MainThread]: Tracking: tracking
[0m03:09:34.152972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558c0ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558c0eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558c0eb80>]}
[0m03:09:34.231532 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:09:34.234256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558bd0fd0>]}
[0m03:09:34.349252 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m03:09:34.352463 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:09:34.393996 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:09:34.398953 [debug] [MainThread]: Parsing macros/relations.sql
[0m03:09:34.402433 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m03:09:34.406227 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:34.409862 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:34.411531 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:34.414113 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:34.416072 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:34.418332 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:34.429669 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m03:09:34.432609 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m03:09:34.435655 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:09:34.439628 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:09:34.442843 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:09:34.445691 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:09:34.447703 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:09:34.450316 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:09:34.452193 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:09:34.453973 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:09:34.463767 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:09:34.477216 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:09:34.491806 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:09:34.494933 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:09:34.498611 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:34.502710 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:09:34.504953 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:09:34.507039 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:34.509676 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:34.512961 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:34.515490 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:34.519187 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:09:34.529763 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:09:34.532889 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:09:34.535318 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:09:34.537656 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:09:34.539656 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:09:34.541897 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:09:34.543843 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:34.546488 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:09:34.548858 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:09:34.551749 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:09:34.553742 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:09:34.556035 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:09:34.558421 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:09:34.560559 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:09:34.562939 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:09:34.578435 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:09:34.602525 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:09:34.607539 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:09:34.613054 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:09:34.638645 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:09:34.642892 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:09:34.655056 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:09:34.663120 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:09:34.669003 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:09:34.674058 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:09:34.680699 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:09:34.687509 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:09:34.697261 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:09:34.710472 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:09:34.721579 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:09:34.752061 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:09:34.755912 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:09:34.784416 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:09:34.801750 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:09:34.806082 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:09:34.810863 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:09:34.817017 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:09:34.828520 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:09:34.854237 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:09:34.880360 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:09:34.899790 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:09:34.903996 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:09:34.908066 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:09:34.911580 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:09:34.918898 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:09:34.949403 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:09:34.962050 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:09:34.967572 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m03:09:34.971941 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m03:09:34.974626 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m03:09:34.978246 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m03:09:34.981883 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m03:09:34.988373 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m03:09:34.996816 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m03:09:35.000236 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m03:09:35.004901 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m03:09:35.022374 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m03:09:35.026133 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m03:09:35.029079 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m03:09:35.032245 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m03:09:35.034572 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m03:09:35.039886 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m03:09:35.043152 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m03:09:35.045411 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m03:09:35.048300 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m03:09:35.051934 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m03:09:35.061477 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m03:09:35.064980 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m03:09:35.068706 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m03:09:35.078399 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m03:09:35.081091 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m03:09:35.083887 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m03:09:35.086363 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m03:09:35.088877 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m03:09:35.128499 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m03:09:35.136566 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m03:09:35.140073 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m03:09:35.144899 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m03:09:35.148037 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m03:09:35.154484 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m03:09:35.158672 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m03:09:35.163645 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m03:09:35.182055 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m03:09:35.186897 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m03:09:35.189599 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m03:09:35.193641 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m03:09:35.196957 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m03:09:35.200896 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m03:09:35.205302 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m03:09:35.208585 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m03:09:35.211655 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m03:09:35.216982 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m03:09:35.225118 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m03:09:35.232871 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m03:09:35.241274 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m03:09:35.245789 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m03:09:35.251653 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m03:09:35.258000 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m03:09:35.269131 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m03:09:35.278401 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m03:09:35.282396 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m03:09:35.292196 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m03:09:35.296353 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m03:09:35.299774 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m03:09:35.306523 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m03:09:35.310376 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m03:09:35.317630 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m03:09:35.324481 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m03:09:35.345058 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m03:09:35.363639 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m03:09:35.367967 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m03:09:35.371933 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m03:09:35.881129 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m03:09:35.897748 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m03:09:35.902630 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m03:09:35.916902 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m03:09:35.930093 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m03:09:35.932873 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m03:09:35.970292 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m03:09:36.180822 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m03:09:36.303321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355812d0d0>]}
[0m03:09:36.343872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355a43a130>]}
[0m03:09:36.347238 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:09:36.348856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558c17bb0>]}
[0m03:09:36.352142 [info ] [MainThread]: 
[0m03:09:36.353943 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:36.356628 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:09:36.367961 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:09:36.369778 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:09:36.371415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:36.382808 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:09:36.386129 [debug] [ThreadPool]: On list_*****: Close
[0m03:09:36.391202 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:09:36.402485 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:36.404083 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:09:36.405573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:36.412210 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:09:36.414062 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:36.415652 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:36.419893 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m03:09:36.424089 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:09:36.425984 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:09:36.436359 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.438197 [debug] [MainThread]: On master: BEGIN
[0m03:09:36.439711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:36.445705 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:36.447620 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.448963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:36.463315 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m03:09:36.466714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558144b20>]}
[0m03:09:36.468415 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:36.469978 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.471383 [debug] [MainThread]: On master: BEGIN
[0m03:09:36.474313 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:36.476776 [debug] [MainThread]: On master: COMMIT
[0m03:09:36.478632 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.480496 [debug] [MainThread]: On master: COMMIT
[0m03:09:36.482119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:36.483462 [debug] [MainThread]: On master: Close
[0m03:09:36.485485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:36.487634 [info ] [MainThread]: 
[0m03:09:36.508255 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m03:09:36.510039 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m03:09:36.512203 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m03:09:36.513781 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m03:09:36.515556 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:36.517040 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m03:09:36.579010 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m03:09:36.580699 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m03:09:36.582051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:36.587093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:09:36.588560 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m03:09:36.589561 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */
truncate table "*****"."public"."subscription_periods"
[0m03:09:36.592138 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m03:09:36.757560 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m03:09:36.760091 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m03:09:36.765301 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m03:09:36.773914 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m03:09:36.816290 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m03:09:36.817679 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m03:09:36.818805 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m03:09:36.822121 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:36.823844 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:36.825102 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m03:09:36.826762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354bd6a130>]}
[0m03:09:36.828007 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.31s]
[0m03:09:36.829398 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m03:09:36.832395 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:36.833690 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.834785 [debug] [MainThread]: On master: BEGIN
[0m03:09:36.835971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:36.841193 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:36.842882 [debug] [MainThread]: On master: COMMIT
[0m03:09:36.844070 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.845279 [debug] [MainThread]: On master: COMMIT
[0m03:09:36.846592 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:36.847732 [debug] [MainThread]: On master: Close
[0m03:09:36.849629 [info ] [MainThread]: 
[0m03:09:36.850967 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m03:09:36.852214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:36.853506 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m03:09:36.894106 [info ] [MainThread]: 
[0m03:09:36.896111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:36.897475 [info ] [MainThread]: 
[0m03:09:36.898779 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:36.900314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558a7ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355812d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354bd6afa0>]}
[0m03:09:36.902125 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:09:41.896570 | 9cfc3218-4a1e-4a7a-8387-0845b30a971a ==============================
[0m03:09:41.896603 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:09:41.897816 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:09:41.899241 [debug] [MainThread]: Tracking: tracking
[0m03:09:41.906732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30fc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30fcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30fcb20>]}
[0m03:09:42.000088 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:09:42.002624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f48c17c0>]}
[0m03:09:42.183160 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m03:09:42.187171 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:09:42.245970 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:09:42.252621 [debug] [MainThread]: Parsing macros/relations.sql
[0m03:09:42.257202 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m03:09:42.261947 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:42.266053 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:42.268289 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:42.273245 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:42.275874 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:42.278832 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:42.293738 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m03:09:42.297496 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m03:09:42.301604 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:09:42.307925 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:09:42.312339 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:09:42.316368 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:09:42.320297 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:09:42.323837 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:09:42.327152 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:09:42.331214 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:09:42.343674 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:09:42.358276 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:09:42.375313 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:09:42.378598 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:09:42.381854 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:42.387042 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:09:42.390059 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:09:42.392614 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:42.395266 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:42.400310 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:42.403595 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:42.408001 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:09:42.420824 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:09:42.424192 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:09:42.426862 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:09:42.429706 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:09:42.432003 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:09:42.437577 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:09:42.444525 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:42.450615 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:09:42.454263 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:09:42.458578 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:09:42.462367 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:09:42.466111 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:09:42.470088 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:09:42.473004 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:09:42.475967 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:09:42.498186 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:09:42.536280 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:09:42.549582 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:09:42.556261 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:09:42.582236 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:09:42.588752 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:09:42.609997 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:09:42.622498 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:09:42.631047 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:09:42.636312 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:09:42.644304 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:09:42.653833 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:09:42.668191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:09:42.685421 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:09:42.699116 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:09:42.731090 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:09:42.735224 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:09:42.761804 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:09:42.778995 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:09:42.782148 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:09:42.786132 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:09:42.791479 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:09:42.800506 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:09:42.823729 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:09:42.849815 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:09:42.871251 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:09:42.876308 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:09:42.880102 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:09:42.883489 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:09:42.891214 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:09:42.923835 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:09:42.938847 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:09:42.944670 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m03:09:42.948735 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m03:09:42.951350 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m03:09:42.954430 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m03:09:42.956635 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m03:09:42.962593 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m03:09:42.972194 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m03:09:42.975632 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m03:09:42.980750 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m03:09:42.997783 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m03:09:43.002130 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m03:09:43.005366 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m03:09:43.008589 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m03:09:43.011114 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m03:09:43.017623 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m03:09:43.020911 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m03:09:43.023360 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m03:09:43.027153 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m03:09:43.030513 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m03:09:43.035547 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m03:09:43.039424 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m03:09:43.043204 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m03:09:43.053747 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m03:09:43.057112 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m03:09:43.059714 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m03:09:43.062934 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m03:09:43.065755 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m03:09:43.109018 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m03:09:43.116055 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m03:09:43.120347 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m03:09:43.125423 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m03:09:43.142282 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m03:09:43.173538 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m03:09:43.187536 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m03:09:43.211722 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m03:09:43.268526 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m03:09:43.277865 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m03:09:43.282360 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m03:09:43.289153 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m03:09:43.298983 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m03:09:43.306058 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m03:09:43.313165 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m03:09:43.318916 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m03:09:43.324645 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m03:09:43.332549 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m03:09:43.343149 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m03:09:43.354057 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m03:09:43.365178 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m03:09:43.371887 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m03:09:43.379438 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m03:09:43.388003 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m03:09:43.401904 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m03:09:43.406399 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m03:09:43.410137 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m03:09:43.422289 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m03:09:43.426667 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m03:09:43.430659 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m03:09:43.438593 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m03:09:43.442487 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m03:09:43.450779 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m03:09:43.458636 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m03:09:43.478200 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m03:09:43.494258 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m03:09:43.498853 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m03:09:43.502706 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m03:09:44.113249 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m03:09:44.134604 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m03:09:44.140108 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m03:09:44.157894 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m03:09:44.171827 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m03:09:44.175407 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m03:09:44.224364 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m03:09:44.454829 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m03:09:44.590680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f24320d0>]}
[0m03:09:44.595918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f3002910>]}
[0m03:09:44.598556 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:09:44.600509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30fc610>]}
[0m03:09:44.606951 [info ] [MainThread]: 
[0m03:09:44.609845 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:44.612830 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:09:44.623921 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:09:44.625952 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:09:44.627500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:44.639417 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:09:44.642869 [debug] [ThreadPool]: On list_*****: Close
[0m03:09:44.647644 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:09:44.658352 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:44.660154 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:09:44.661363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:44.667872 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:09:44.669365 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:44.670773 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:44.675333 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m03:09:44.679430 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:09:44.683932 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:09:44.698850 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:44.700415 [debug] [MainThread]: On master: BEGIN
[0m03:09:44.701763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:44.707692 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:44.709361 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:44.710842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:44.723197 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m03:09:44.726576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f2423a30>]}
[0m03:09:44.728286 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:44.730061 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:44.731764 [debug] [MainThread]: On master: BEGIN
[0m03:09:44.733615 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:44.734771 [debug] [MainThread]: On master: COMMIT
[0m03:09:44.736314 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:44.737632 [debug] [MainThread]: On master: COMMIT
[0m03:09:44.739637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:44.741559 [debug] [MainThread]: On master: Close
[0m03:09:44.743828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:44.745956 [info ] [MainThread]: 
[0m03:09:44.767728 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m03:09:44.770116 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m03:09:44.772892 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m03:09:44.774532 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m03:09:44.775899 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m03:09:44.802187 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.804110 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m03:09:44.805745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:44.812165 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:09:44.813792 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.815568 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m03:09:44.823809 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m03:09:44.828473 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m03:09:44.851712 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:44.853056 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m03:09:44.918718 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m03:09:44.925351 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.926795 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m03:09:44.944191 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
[0m03:09:44.953601 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.955204 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months" rename to "util_months__dbt_backup"
[0m03:09:44.957603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:44.961929 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.963117 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m03:09:44.964851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:44.990162 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m03:09:44.992017 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.993297 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m03:09:44.995238 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.002351 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:45.003619 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m03:09:45.011877 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
[0m03:09:45.014120 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:45.015145 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m03:09:45.016747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f23afc10>]}
[0m03:09:45.017935 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m03:09:45.019196 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m03:09:45.021715 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:45.022644 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:45.023499 [debug] [MainThread]: On master: BEGIN
[0m03:09:45.024350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:45.028840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:45.029911 [debug] [MainThread]: On master: COMMIT
[0m03:09:45.030834 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:45.031697 [debug] [MainThread]: On master: COMMIT
[0m03:09:45.032658 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.033514 [debug] [MainThread]: On master: Close
[0m03:09:45.034938 [info ] [MainThread]: 
[0m03:09:45.035971 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m03:09:45.037326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:45.038135 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m03:09:45.039128 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m03:09:45.040013 [info ] [MainThread]: 
[0m03:09:45.040988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:45.042036 [info ] [MainThread]: 
[0m03:09:45.043090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:45.045097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f2435b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f13403d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f1340d30>]}
[0m03:09:45.046201 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:09:49.652502 | 20fdea3c-89d1-4c78-85ff-f75cd91c036d ==============================
[0m03:09:49.652529 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:09:49.653679 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:09:49.654837 [debug] [MainThread]: Tracking: tracking
[0m03:09:49.661001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045b79cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045b79af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045b79b50>]}
[0m03:09:49.832387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:09:49.833395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:09:49.843330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0458ee0d0>]}
[0m03:09:49.846520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045a27640>]}
[0m03:09:49.847807 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:09:49.848978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045a27880>]}
[0m03:09:49.851643 [info ] [MainThread]: 
[0m03:09:49.853122 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:49.854916 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:09:49.869532 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:09:49.871383 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:09:49.872798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:49.884273 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:09:49.886745 [debug] [ThreadPool]: On list_*****: Close
[0m03:09:49.889643 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:09:49.898662 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:49.899856 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:09:49.900854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:49.905459 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:09:49.906401 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:49.907145 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:49.910138 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m03:09:49.913160 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:09:49.914073 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:09:49.921824 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:49.923152 [debug] [MainThread]: On master: BEGIN
[0m03:09:49.924513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:49.929029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:49.930060 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:49.931936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:49.940752 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m03:09:49.943397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045b7a880>]}
[0m03:09:49.945258 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:49.946500 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:49.947385 [debug] [MainThread]: On master: BEGIN
[0m03:09:49.948932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:49.950277 [debug] [MainThread]: On master: COMMIT
[0m03:09:49.951250 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:49.952214 [debug] [MainThread]: On master: COMMIT
[0m03:09:49.953297 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:49.954363 [debug] [MainThread]: On master: Close
[0m03:09:49.955788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:49.957040 [info ] [MainThread]: 
[0m03:09:49.990695 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m03:09:49.992720 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m03:09:49.994652 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:49.996129 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m03:09:49.997414 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m03:09:50.007103 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m03:09:50.012599 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:50.013802 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m03:09:50.079497 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m03:09:50.085536 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.088404 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m03:09:50.089649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:50.094541 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:50.095781 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.096791 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m03:09:50.103364 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:09:50.114319 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.115785 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m03:09:50.117322 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:50.141232 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m03:09:50.143042 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.144230 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m03:09:50.146315 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:50.153815 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.155223 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m03:09:50.156709 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:09:50.158904 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:50.160004 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m03:09:50.162134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450b6c70>]}
[0m03:09:50.163670 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.17s]
[0m03:09:50.165185 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m03:09:50.167650 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:50.168593 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:50.169410 [debug] [MainThread]: On master: BEGIN
[0m03:09:50.170348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:50.175141 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:50.176182 [debug] [MainThread]: On master: COMMIT
[0m03:09:50.177129 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:50.178032 [debug] [MainThread]: On master: COMMIT
[0m03:09:50.179120 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:50.180148 [debug] [MainThread]: On master: Close
[0m03:09:50.181504 [info ] [MainThread]: 
[0m03:09:50.182593 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m03:09:50.183989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:50.184932 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m03:09:50.185950 [info ] [MainThread]: 
[0m03:09:50.186972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:50.188054 [info ] [MainThread]: 
[0m03:09:50.189133 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:50.190202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450b92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450b9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450b9490>]}
[0m03:09:50.191268 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:09:54.308627 | 1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16 ==============================
[0m03:09:54.308654 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:09:54.310297 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:09:54.312109 [debug] [MainThread]: Tracking: tracking
[0m03:09:54.319394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affdb6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affdb6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affdb6ac0>]}
[0m03:09:54.536617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:09:54.538071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:09:54.547679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affb240d0>]}
[0m03:09:54.551552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affc61610>]}
[0m03:09:54.553087 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:09:54.554237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affc61850>]}
[0m03:09:54.557727 [info ] [MainThread]: 
[0m03:09:54.559293 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:54.561198 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:09:54.580768 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:09:54.582205 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:09:54.583293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:54.589405 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:09:54.591930 [debug] [ThreadPool]: On list_*****: Close
[0m03:09:54.594779 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:09:54.603875 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:54.605808 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:09:54.607019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:54.612512 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:09:54.614413 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:54.616069 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:54.619995 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m03:09:54.624565 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:09:54.626221 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:09:54.636210 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.637930 [debug] [MainThread]: On master: BEGIN
[0m03:09:54.639582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:54.645903 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:54.647242 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.648435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:54.657975 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m03:09:54.660708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affc61220>]}
[0m03:09:54.662775 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:54.664266 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.665322 [debug] [MainThread]: On master: BEGIN
[0m03:09:54.667101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:54.668730 [debug] [MainThread]: On master: COMMIT
[0m03:09:54.669980 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.671190 [debug] [MainThread]: On master: COMMIT
[0m03:09:54.673090 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:54.674296 [debug] [MainThread]: On master: Close
[0m03:09:54.676221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:54.678121 [info ] [MainThread]: 
[0m03:09:54.704883 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m03:09:54.707010 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m03:09:54.709327 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m03:09:54.710944 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m03:09:54.712579 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m03:09:54.719579 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m03:09:54.727278 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:54.729038 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m03:09:54.803234 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m03:09:54.808931 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.810190 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m03:09:54.811629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:54.817255 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:09:54.818804 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.820225 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m03:09:54.825270 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:09:54.835673 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.837820 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m03:09:54.841046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:54.865499 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m03:09:54.867588 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.868687 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m03:09:54.871756 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:54.879714 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.881523 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m03:09:54.883735 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:09:54.886055 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:54.887657 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m03:09:54.889568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aff2de4f0>]}
[0m03:09:54.891667 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.18s]
[0m03:09:54.893211 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m03:09:54.896155 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:54.897523 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.898501 [debug] [MainThread]: On master: BEGIN
[0m03:09:54.899827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:54.905173 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:54.906605 [debug] [MainThread]: On master: COMMIT
[0m03:09:54.907736 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.908861 [debug] [MainThread]: On master: COMMIT
[0m03:09:54.910155 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:54.911421 [debug] [MainThread]: On master: Close
[0m03:09:54.913167 [info ] [MainThread]: 
[0m03:09:54.914368 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m03:09:54.915717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:54.916845 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m03:09:54.917954 [info ] [MainThread]: 
[0m03:09:54.919610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:54.920953 [info ] [MainThread]: 
[0m03:09:54.922256 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:54.923684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aff2de4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affb41ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affb411c0>]}
[0m03:09:54.924982 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:10:00.610570 | e27d793a-d5cd-48d0-b9b4-81a38f96d1d2 ==============================
[0m03:10:00.610602 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:00.612609 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:10:00.614596 [debug] [MainThread]: Tracking: tracking
[0m03:10:00.623217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1aa5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1aa5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1aa5ac0>]}
[0m03:10:00.836621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:00.838017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:00.877743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a18120d0>]}
[0m03:10:00.883324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1950610>]}
[0m03:10:00.885193 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:00.886535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1950850>]}
[0m03:10:00.889540 [info ] [MainThread]: 
[0m03:10:00.891328 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:00.893326 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:10:00.908248 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:10:00.909873 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:10:00.911242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:00.918853 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:10:00.921529 [debug] [ThreadPool]: On list_*****: Close
[0m03:10:00.924241 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:10:00.933016 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:00.934788 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:10:00.936075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:00.942061 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:10:00.943353 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:00.944405 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:10:00.948235 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m03:10:00.951848 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:10:00.953370 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:10:00.963287 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:00.964811 [debug] [MainThread]: On master: BEGIN
[0m03:10:00.965942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:00.971501 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:10:00.973000 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:00.974435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:00.987907 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m03:10:00.990921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1950220>]}
[0m03:10:00.992674 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:00.994188 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:00.995426 [debug] [MainThread]: On master: BEGIN
[0m03:10:00.997207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:00.998768 [debug] [MainThread]: On master: COMMIT
[0m03:10:01.001756 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:01.003154 [debug] [MainThread]: On master: COMMIT
[0m03:10:01.004789 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:01.005968 [debug] [MainThread]: On master: Close
[0m03:10:01.007871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:01.009124 [info ] [MainThread]: 
[0m03:10:01.028328 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m03:10:01.029852 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m03:10:01.032168 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m03:10:01.034667 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m03:10:01.035995 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m03:10:01.056668 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m03:10:01.068985 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m03:10:01.076812 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:01.078148 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m03:10:01.133038 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m03:10:01.139391 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.142201 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m03:10:01.144652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:01.150356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:01.151831 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.153679 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m03:10:01.159996 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:10:01.168409 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.169765 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m03:10:01.171539 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:01.197857 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m03:10:01.199515 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.200783 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m03:10:01.202689 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:10:01.212007 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.213312 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m03:10:01.214909 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:10:01.217172 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:01.218297 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m03:10:01.219985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a0f80850>]}
[0m03:10:01.221288 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.19s]
[0m03:10:01.222872 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m03:10:01.225939 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:01.227505 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:01.228820 [debug] [MainThread]: On master: BEGIN
[0m03:10:01.230174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:01.237109 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:10:01.238864 [debug] [MainThread]: On master: COMMIT
[0m03:10:01.240591 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:01.241850 [debug] [MainThread]: On master: COMMIT
[0m03:10:01.243750 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:01.244922 [debug] [MainThread]: On master: Close
[0m03:10:01.246659 [info ] [MainThread]: 
[0m03:10:01.247964 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m03:10:01.249182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:01.250230 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m03:10:01.251504 [info ] [MainThread]: 
[0m03:10:01.252899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:01.254242 [info ] [MainThread]: 
[0m03:10:01.255396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:10:01.256904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a181f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a181f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a181f460>]}
[0m03:10:01.258273 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:10:07.327189 | 543afeeb-4b11-4bbe-abcf-03895e6580dd ==============================
[0m03:10:07.327218 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:07.328533 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m03:10:07.330381 [debug] [MainThread]: Tracking: tracking
[0m03:10:07.336542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39662d6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39662d6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39662d6b20>]}


============================== 2022-12-01 03:10:07.530228 | cf844e58-58ca-4ed0-8abc-fa0484fe06b9 ==============================
[0m03:10:07.530260 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:07.532065 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m03:10:07.534133 [debug] [MainThread]: Tracking: tracking
[0m03:10:07.556085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf52ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf52e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf52eb20>]}


============================== 2022-12-01 03:10:07.630458 | a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2 ==============================
[0m03:10:07.630505 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:07.632761 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m03:10:07.637172 [debug] [MainThread]: Tracking: tracking
[0m03:10:07.668356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da6c4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da6c4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da6c4b50>]}


============================== 2022-12-01 03:10:07.700807 | 826dfcf4-6f89-4f7b-9427-5a4145a1dc31 ==============================
[0m03:10:07.700839 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:07.703175 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m03:10:07.708341 [debug] [MainThread]: Tracking: tracking
[0m03:10:07.741753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b8718cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b8718af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b8718b50>]}
[0m03:10:07.823823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:07.829512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:07.880766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '543afeeb-4b11-4bbe-abcf-03895e6580dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3966043fd0>]}
[0m03:10:07.892962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '543afeeb-4b11-4bbe-abcf-03895e6580dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396616f5e0>]}
[0m03:10:07.895934 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:07.898503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '543afeeb-4b11-4bbe-abcf-03895e6580dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396616f820>]}
[0m03:10:07.907436 [info ] [MainThread]: 
[0m03:10:07.911117 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:07.917088 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:10:07.944744 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:07.947355 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:10:07.949071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:07.961191 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:10:07.962897 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:07.964778 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:10:07.974927 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.01 seconds
[0m03:10:07.983380 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:10:07.992037 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:10:08.026345 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.029635 [debug] [MainThread]: On master: BEGIN
[0m03:10:08.033475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:08.047264 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:10:08.064080 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.078606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:08.141524 [debug] [MainThread]: SQL status: SELECT 8 in 0.05 seconds
[0m03:10:08.160854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '543afeeb-4b11-4bbe-abcf-03895e6580dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396616f430>]}
[0m03:10:08.178127 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:08.187657 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.190879 [debug] [MainThread]: On master: BEGIN
[0m03:10:08.197597 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:08.202165 [debug] [MainThread]: On master: COMMIT
[0m03:10:08.205491 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.212165 [debug] [MainThread]: On master: COMMIT
[0m03:10:08.219639 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:08.225885 [debug] [MainThread]: On master: Close
[0m03:10:08.236386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:08.246302 [info ] [MainThread]: 
[0m03:10:08.314065 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:08.319718 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m03:10:08.327472 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.332559 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:08.336680 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:08.337474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:08.342688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:08.393577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf844e58-58ca-4ed0-8abc-fa0484fe06b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf29c0d0>]}
[0m03:10:08.407891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:08.412682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:08.413629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf844e58-58ca-4ed0-8abc-fa0484fe06b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c9670>]}
[0m03:10:08.420696 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:08.423725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf844e58-58ca-4ed0-8abc-fa0484fe06b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c98b0>]}
[0m03:10:08.425550 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.458366 [info ] [MainThread]: 
[0m03:10:08.464580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da4310d0>]}
[0m03:10:08.466744 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m03:10:08.478524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da5706a0>]}
[0m03:10:08.475853 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:08.484399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:08.483532 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:08.478246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c94f0>]}
[0m03:10:08.496930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:08.490773 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:08.498801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da5708e0>]}
[0m03:10:08.501792 [debug] [MainThread]: Flushing usage events
[0m03:10:08.564818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '826dfcf4-6f89-4f7b-9427-5a4145a1dc31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b84850d0>]}
[0m03:10:08.579822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '826dfcf4-6f89-4f7b-9427-5a4145a1dc31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b859c640>]}
[0m03:10:08.576499 [info ] [MainThread]: 
[0m03:10:08.638740 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:08.654375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826dfcf4-6f89-4f7b-9427-5a4145a1dc31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b859c880>]}
[0m03:10:08.648171 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:08.658928 [info ] [MainThread]: 
[0m03:10:08.662003 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:10:08.670458 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:08.755382 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:10:08.795091 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:08.799254 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:10:08.805432 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:08.803557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:08.807081 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:10:08.815776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:08.809444 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.866276 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.868467 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m03:10:08.872354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:08.870563 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m03:10:08.874075 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:10:08.876409 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:08.880756 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:08.884782 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:10:08.907336 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:10:08.932991 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
[0m03:10:08.935684 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m03:10:08.935657 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.937729 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m03:10:08.939180 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.02 seconds
[0m03:10:08.942489 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:10:08.944704 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:10:08.948228 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:10:08.951869 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:10:08.985326 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.996011 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.006598 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.07 seconds
[0m03:10:09.009130 [debug] [MainThread]: On master: BEGIN
[0m03:10:09.017189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:09.000724 [debug] [MainThread]: On master: BEGIN
[0m03:10:09.017803 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:09.021179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:09.030371 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m03:10:09.074471 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m03:10:09.077591 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.75s]
[0m03:10:09.080878 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:09.084150 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.087365 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m03:10:09.087144 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m03:10:09.090364 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.088114 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m03:10:09.089505 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.094795 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.092741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:09.096364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:09.098802 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.108201 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.122744 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m03:10:09.126733 [debug] [MainThread]: SQL status: SELECT 8 in 0.03 seconds
[0m03:10:09.135735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826dfcf4-6f89-4f7b-9427-5a4145a1dc31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b859c3d0>]}
[0m03:10:09.134312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da6c4730>]}
[0m03:10:09.139477 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:09.142436 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:09.147790 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.154825 [debug] [MainThread]: On master: BEGIN
[0m03:10:09.152569 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.166068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:09.167758 [debug] [MainThread]: On master: BEGIN
[0m03:10:09.174559 [debug] [MainThread]: On master: COMMIT
[0m03:10:09.182698 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:09.185904 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.224192 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.215880 [debug] [MainThread]: On master: COMMIT
[0m03:10:09.250089 [debug] [MainThread]: On master: COMMIT
[0m03:10:09.264729 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.269556 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:09.316258 [debug] [MainThread]: On master: COMMIT
[0m03:10:09.317093 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.324602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:09.330313 [debug] [MainThread]: On master: Close
[0m03:10:09.330275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:09.334414 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.340075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:09.336807 [debug] [MainThread]: On master: Close
[0m03:10:09.344114 [info ] [MainThread]: 
[0m03:10:09.346836 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.434946 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m03:10:09.506565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:09.493480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:09.516878 [info ] [MainThread]: 
[0m03:10:09.624907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m03:10:09.643627 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.670587 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m03:10:09.678767 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:09.700499 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m03:10:09.730589 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:09.736603 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:09.740227 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:09.736931 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.06 seconds
[0m03:10:09.777868 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:09.782174 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m03:10:09.786301 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m03:10:09.793329 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.70s]
[0m03:10:09.870205 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:09.874261 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.938010 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m03:10:09.932147 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.023795 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m03:10:10.048601 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:10.054588 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:10.053177 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.060429 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.060538 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:10.063104 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.157640 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.186295 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:10.192577 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.199659 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.227184 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:10.201246 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.272030 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:10.288423 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.289390 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.293174 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:10.381755 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.384868 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m03:10:10.388083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:10.431220 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
[0m03:10:10.450575 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.463080 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m03:10:10.478019 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:10.571730 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.11 seconds
[0m03:10:10.631858 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:10.664510 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.669332 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m03:10:10.671709 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m03:10:10.673492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:10.676157 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m03:10:10.718527 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.67s]
[0m03:10:10.726412 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.730054 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:10.736431 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
[0m03:10:10.753884 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:10.745836 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m03:10:10.772740 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m03:10:10.777389 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:10.778234 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:10.795104 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:10.836219 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:10.843002 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m03:10:10.825463 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:10.868915 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:10.878143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:10.917520 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.925856 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m03:10:10.930484 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m03:10:10.979621 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 1.27s]
[0m03:10:10.980204 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:10.995440 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:10.996812 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.001000 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.003466 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:11.004088 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m03:10:11.006803 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:11.005048 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m03:10:11.034461 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m03:10:11.058203 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:11.058841 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.063578 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.066309 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:11.068056 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.069478 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m03:10:11.073545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.080014 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:11.118828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.05 seconds
[0m03:10:11.122067 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:11.131201 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m03:10:11.163444 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.177062 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.180802 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.209176 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.07 seconds
[0m03:10:11.222404 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.225131 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m03:10:11.227731 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.230468 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m03:10:11.237093 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.46s]
[0m03:10:11.241872 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:11.245612 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.248267 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m03:10:11.245186 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.248409 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.253906 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m03:10:11.253492 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.258563 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m03:10:11.260340 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.267144 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.255706 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m03:10:11.269546 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 1.28s]
[0m03:10:11.273472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.278753 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:11.293513 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m03:10:11.315890 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:11.329268 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.343779 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:10:11.324415 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.331513 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:11.363624 [debug] [MainThread]: On master: BEGIN
[0m03:10:11.364120 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:11.367053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:11.373830 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.382710 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.385096 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.391655 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m03:10:11.393180 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m03:10:11.395404 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m03:10:11.397684 [debug] [MainThread]: On master: COMMIT
[0m03:10:11.408209 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:11.409107 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.35s]
[0m03:10:11.411297 [debug] [MainThread]: On master: COMMIT
[0m03:10:11.415444 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.417386 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.419246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:11.425101 [debug] [MainThread]: On master: Close
[0m03:10:11.428921 [info ] [MainThread]: 
[0m03:10:11.429304 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:11.432170 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m03:10:11.434527 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:11.435412 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.437080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:11.438375 [debug] [MainThread]: On master: BEGIN
[0m03:10:11.448318 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m03:10:11.440354 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m03:10:11.485085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.479287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:11.484228 [info ] [MainThread]: 
[0m03:10:11.500014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:11.505724 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m03:10:11.503844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:11.508910 [debug] [MainThread]: On master: COMMIT
[0m03:10:11.506260 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.510507 [info ] [MainThread]: 
[0m03:10:11.512281 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:11.516996 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:10:11.517759 [debug] [MainThread]: On master: COMMIT
[0m03:10:11.513431 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m03:10:11.524410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b7c49850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b7c49730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b7c49af0>]}
[0m03:10:11.523988 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:11.529478 [debug] [MainThread]: On master: Close
[0m03:10:11.529969 [debug] [MainThread]: Flushing usage events
[0m03:10:11.535413 [info ] [MainThread]: 
[0m03:10:11.540302 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m03:10:11.542977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:11.545400 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m03:10:11.549868 [info ] [MainThread]: 
[0m03:10:11.555306 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m03:10:11.554328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:11.568033 [info ] [MainThread]: 
[0m03:10:11.571316 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:10:11.569871 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.578060 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m03:10:11.579022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9bf6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9bf68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9bf6760>]}
[0m03:10:11.582511 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m03:10:11.627874 [debug] [MainThread]: Flushing usage events
[0m03:10:11.635329 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.38s]
[0m03:10:11.639554 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.643542 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.645887 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m03:10:11.656895 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.666825 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.668453 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.686390 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.749451 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.756816 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.795456 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.837761 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.842141 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m03:10:11.846830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.863708 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m03:10:11.866922 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.869404 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m03:10:11.896360 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:11.900882 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.902589 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m03:10:11.904475 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m03:10:11.906760 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.25s]
[0m03:10:11.909362 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.911217 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:11.912689 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m03:10:11.915065 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.916734 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:11.918522 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:11.930869 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.936131 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.937814 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:11.957342 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.967905 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.969366 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m03:10:11.971047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.978310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:11.979941 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.982132 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m03:10:12.010241 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m03:10:12.018063 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.022317 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m03:10:12.031919 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m03:10:12.041224 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.13s]
[0m03:10:12.049968 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:12.055180 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.059586 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m03:10:12.067295 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.070812 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.073954 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.099519 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.157256 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.160457 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.171169 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.184627 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.187571 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m03:10:12.190043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:12.207916 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m03:10:12.211227 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.215333 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m03:10:12.324520 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.09 seconds
[0m03:10:12.341897 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.346870 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m03:10:12.350281 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m03:10:12.353433 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.29s]
[0m03:10:12.357501 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.360673 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.364640 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m03:10:12.373296 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.376603 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.380732 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.405349 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.442447 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.446065 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.455997 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.474506 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.476040 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m03:10:12.477279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:12.485044 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:12.487606 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.489848 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m03:10:12.507597 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:12.513062 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.515348 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m03:10:12.518346 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m03:10:12.520710 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.15s]
[0m03:10:12.522829 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.524866 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.527149 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m03:10:12.530641 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.532812 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.534912 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.545191 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.569142 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.579677 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.593044 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.619896 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.622577 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m03:10:12.624658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:12.632775 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:12.634959 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.636850 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m03:10:12.672573 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m03:10:12.683653 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.687652 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m03:10:12.691336 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m03:10:12.695722 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.17s]
[0m03:10:12.700320 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.703728 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:12.706383 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m03:10:12.710169 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.713384 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:12.715773 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:12.737410 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.746679 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.751639 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:12.768370 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.780234 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.783710 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m03:10:12.842195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:12.895495 [debug] [Thread-1  ]: SQL status: BEGIN in 0.05 seconds
[0m03:10:12.947156 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.950061 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m03:10:13.083004 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.13 seconds
[0m03:10:13.158080 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.167492 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m03:10:13.177914 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m03:10:13.186391 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.48s]
[0m03:10:13.193308 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:13.198332 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.212052 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m03:10:13.227733 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.242425 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.265067 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.363542 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.371790 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.375735 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.384558 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.416354 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.420121 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m03:10:13.422029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:13.430014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:13.432259 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.434214 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m03:10:13.495688 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.06 seconds
[0m03:10:13.502979 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.504988 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m03:10:13.506709 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m03:10:13.511105 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.29s]
[0m03:10:13.515278 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.517334 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.519060 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m03:10:13.522068 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.523778 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.525752 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.543595 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.552053 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.554138 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.635040 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.644510 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.646308 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m03:10:13.648355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:13.657773 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:13.659512 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.660794 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m03:10:13.680578 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:13.683992 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.685450 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m03:10:13.687255 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m03:10:13.692618 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.17s]
[0m03:10:13.699682 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.718166 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.720148 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m03:10:13.722105 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.723329 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.724483 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.733674 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.739342 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.741077 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.748154 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.826759 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.882025 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m03:10:13.884550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:13.899516 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:13.904204 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.906531 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m03:10:13.935908 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:13.944548 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.948135 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m03:10:13.950820 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m03:10:13.955846 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.23s]
[0m03:10:13.959677 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.961053 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:13.962569 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m03:10:13.965308 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:13.967320 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:13.969599 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:13.990780 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:13.998264 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:14.001060 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:14.009324 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:14.018853 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:14.020408 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m03:10:14.021803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:14.028577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:14.030143 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:14.032077 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:10:14.053694 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:14.058208 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:14.059706 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m03:10:14.073738 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m03:10:14.088607 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.12s]
[0m03:10:14.100472 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:14.108647 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:14.110199 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:14.111651 [debug] [MainThread]: On master: BEGIN
[0m03:10:14.113141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:14.123335 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:10:14.125239 [debug] [MainThread]: On master: COMMIT
[0m03:10:14.126905 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:14.128313 [debug] [MainThread]: On master: COMMIT
[0m03:10:14.130315 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:14.132092 [debug] [MainThread]: On master: Close
[0m03:10:14.135996 [info ] [MainThread]: 
[0m03:10:14.138647 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m03:10:14.140470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:14.141724 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m03:10:14.147313 [info ] [MainThread]: 
[0m03:10:14.153484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:14.156879 [info ] [MainThread]: 
[0m03:10:14.165044 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m03:10:14.168821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39657a45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39657a4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39657c6be0>]}
[0m03:10:14.172635 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:23.032766 | 7f44e5f5-7f4e-4a38-b072-d974721889eb ==============================
[0m04:07:23.032792 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:23.035420 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m04:07:23.037392 [debug] [MainThread]: Tracking: tracking
[0m04:07:23.048580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b5c6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b5c6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b5c6b80>]}
[0m04:07:23.268297 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:07:23.270113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b57f8e0>]}
[0m04:07:23.709771 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:07:23.712689 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:07:23.762439 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:07:23.767004 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:07:23.770573 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:07:23.774428 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:07:23.777909 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:07:23.779459 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:07:23.781927 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:07:23.783362 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:07:23.785560 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:07:23.797934 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:07:23.800607 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:07:23.804796 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:07:23.809440 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:07:23.812790 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:07:23.815747 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:07:23.818257 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:07:23.821283 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:07:23.823190 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:07:23.825951 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:07:23.838852 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:07:23.850556 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:07:23.870878 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:07:23.874138 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:07:23.878518 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:07:23.883544 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:07:23.887461 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:07:23.891295 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:07:23.894550 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:07:23.898492 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:07:23.901914 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:07:23.907749 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:07:23.922563 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:07:23.926393 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:07:23.929330 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:07:23.931978 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:07:23.935369 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:07:23.943232 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:07:23.945616 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:07:23.948803 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:07:23.951688 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:07:23.956731 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:07:23.959887 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:07:23.962378 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:07:23.965124 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:07:23.967483 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:07:23.970186 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:07:23.987858 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:07:24.015826 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:07:24.020600 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:07:24.026385 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:07:24.049159 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:07:24.055067 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:07:24.067997 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:07:24.077663 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:07:24.083505 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:07:24.088446 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:07:24.095955 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:07:24.102604 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:07:24.112797 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:07:24.127204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:07:24.138683 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:07:24.195023 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:07:24.198713 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:07:24.224928 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:07:24.242910 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:07:24.246869 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:07:24.251124 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:07:24.258867 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:07:24.268970 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:07:24.293895 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:07:24.322651 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:07:24.358989 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:07:24.363324 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:07:24.367523 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:07:24.371897 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:07:24.380700 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:07:24.417403 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:07:24.430268 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:07:24.436564 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:07:24.441571 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:07:24.444434 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:07:24.447169 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:07:24.449752 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:07:24.455884 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:07:24.466128 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:07:24.470236 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:07:24.476161 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:07:24.497239 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:07:24.503923 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:07:24.508368 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:07:24.512269 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:07:24.515291 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:07:24.523639 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:07:24.527166 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:07:24.530134 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:07:24.533758 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:07:24.536814 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:07:24.542576 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:07:24.547178 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:07:24.551421 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:07:24.564120 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:07:24.567182 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:07:24.570608 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:07:24.574087 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:07:24.579797 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:07:24.631164 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:07:24.637092 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:07:24.640721 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:07:24.646108 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:07:24.650132 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:07:24.658617 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:07:24.663685 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:07:24.668639 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:07:24.694489 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:07:24.700563 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:07:24.705092 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:07:24.712674 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:07:24.718360 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:07:24.727327 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:07:24.735052 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:07:24.742906 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:07:24.753065 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:07:24.773669 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:07:24.803031 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:07:24.814470 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:07:24.837393 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:07:24.845425 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:07:24.852705 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:07:24.861432 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:07:24.882935 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:07:24.888271 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:07:24.891736 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:07:24.903267 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:07:24.907428 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:07:24.913071 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:07:24.923939 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:07:24.927956 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:07:24.936169 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:07:24.947675 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:07:24.985857 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:07:25.004890 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:07:25.009370 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:07:25.014687 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:07:25.795527 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:07:25.819774 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:07:25.824995 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:07:25.841902 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:07:25.855727 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:07:25.860027 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:07:25.909840 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:07:26.158786 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:07:26.293084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a8e70d0>]}
[0m04:07:26.337281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b3b3ca0>]}
[0m04:07:26.339384 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:26.343723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b4eba00>]}
[0m04:07:26.350184 [info ] [MainThread]: 
[0m04:07:26.355387 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:26.359421 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:07:26.402023 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:07:26.409123 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:07:26.411252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:26.418524 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:07:26.421441 [debug] [ThreadPool]: On list_*****: Close
[0m04:07:26.425436 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:07:26.436356 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:26.437971 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:07:26.440110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:07:26.446755 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:07:26.448493 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:26.449872 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:07:26.453835 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m04:07:26.459003 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:07:26.460940 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:07:26.471487 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:26.474078 [debug] [MainThread]: On master: BEGIN
[0m04:07:26.475818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:26.482556 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:26.484084 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:26.485540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:07:26.491268 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m04:07:26.494752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a8e8c40>]}
[0m04:07:26.496551 [debug] [MainThread]: On master: ROLLBACK
[0m04:07:26.498338 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:26.499612 [debug] [MainThread]: On master: BEGIN
[0m04:07:26.501513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:07:26.503066 [debug] [MainThread]: On master: COMMIT
[0m04:07:26.504448 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:26.505877 [debug] [MainThread]: On master: COMMIT
[0m04:07:26.507444 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:26.509018 [debug] [MainThread]: On master: Close
[0m04:07:26.511176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:07:26.513297 [info ] [MainThread]: 
[0m04:07:26.532350 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m04:07:26.534251 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m04:07:26.536191 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m04:07:26.537966 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m04:07:26.539890 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:26.541471 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m04:07:26.616819 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:07:26.619842 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m04:07:26.621969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:07:26.632449 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:07:26.634337 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:07:26.635998 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */

    create table "*****"."public"."subscription_periods" (subscription_id integer,customer_id integer,start_date date,end_date date,monthly_amount integer)
  
[0m04:07:26.640263 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m04:07:26.919566 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:07:26.924944 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m04:07:26.934677 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m04:07:26.951769 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m04:07:27.084076 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m04:07:27.087884 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:07:27.090247 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m04:07:27.097123 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:07:27.100489 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:27.104848 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m04:07:27.143179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a73ce20>]}
[0m04:07:27.147420 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.61s]
[0m04:07:27.151114 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m04:07:27.158892 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:27.161553 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:27.164036 [debug] [MainThread]: On master: BEGIN
[0m04:07:27.166191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:27.177536 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:27.179581 [debug] [MainThread]: On master: COMMIT
[0m04:07:27.181490 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:27.183531 [debug] [MainThread]: On master: COMMIT
[0m04:07:27.186399 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:27.189207 [debug] [MainThread]: On master: Close
[0m04:07:27.194474 [info ] [MainThread]: 
[0m04:07:27.196999 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m04:07:27.199391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:27.201292 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m04:07:27.250703 [info ] [MainThread]: 
[0m04:07:27.252819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:07:27.255041 [info ] [MainThread]: 
[0m04:07:27.260269 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:07:27.274246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b5be220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a8e7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a741700>]}
[0m04:07:27.283204 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:33.769969 | 736a72cf-dd8d-4773-b2ea-dfa681fb3fd9 ==============================
[0m04:07:33.769995 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:33.773107 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:07:33.774352 [debug] [MainThread]: Tracking: tracking
[0m04:07:33.783067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f4aecaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef76c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef76c730>]}
[0m04:07:33.892124 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:07:33.894844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f0f31d90>]}
[0m04:07:34.078113 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:07:34.081478 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:07:34.195979 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:07:34.204831 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:07:34.209155 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:07:34.215149 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:07:34.218658 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:07:34.220532 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:07:34.224087 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:07:34.260952 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:07:34.274905 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:07:34.298463 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:07:34.301724 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:07:34.305794 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:07:34.311936 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:07:34.315865 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:07:34.319404 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:07:34.321791 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:07:34.325260 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:07:34.337178 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:07:34.339181 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:07:34.368292 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:07:34.382265 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:07:34.417053 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:07:34.428622 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:07:34.459218 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:07:34.480938 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:07:34.489553 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:07:34.495799 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:07:34.502493 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:07:34.511666 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:07:34.517522 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:07:34.526152 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:07:34.547166 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:07:34.561662 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:07:34.568539 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:07:34.581138 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:07:34.595137 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:07:34.599286 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:07:34.604134 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:07:34.607848 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:07:34.612576 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:07:34.619381 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:07:34.625333 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:07:34.632645 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:07:34.640516 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:07:34.646197 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:07:34.654280 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:07:34.683678 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:07:34.714332 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:07:34.719698 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:07:34.725536 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:07:34.752172 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:07:34.756939 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:07:34.770818 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:07:34.779270 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:07:34.786230 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:07:34.791895 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:07:34.800930 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:07:34.807528 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:07:34.822383 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:07:34.838398 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:07:34.854757 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:07:34.892143 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:07:34.896148 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:07:34.932735 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:07:34.955812 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:07:34.960457 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:07:34.966122 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:07:34.974651 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:07:34.987538 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:07:35.017328 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:07:35.050750 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:07:35.076978 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:07:35.082331 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:07:35.086759 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:07:35.091383 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:07:35.103018 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:07:35.153415 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:07:35.180984 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:07:35.189405 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:07:35.196366 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:07:35.199885 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:07:35.204437 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:07:35.208349 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:07:35.218850 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:07:35.234703 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:07:35.238434 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:07:35.271048 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:07:35.308157 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:07:35.312957 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:07:35.317913 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:07:35.322406 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:07:35.326367 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:07:35.334212 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:07:35.351661 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:07:35.355196 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:07:35.370276 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:07:35.376239 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:07:35.386460 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:07:35.394191 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:07:35.412759 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:07:35.439646 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:07:35.446488 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:07:35.450034 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:07:35.453488 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:07:35.456414 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:07:35.548388 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:07:35.556198 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:07:35.560991 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:07:35.567817 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:07:35.574850 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:07:35.586122 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:07:35.590807 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:07:35.596885 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:07:35.625978 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:07:35.638598 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:07:35.642338 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:07:35.649563 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:07:35.655340 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:07:35.661942 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:07:35.669960 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:07:35.674994 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:07:35.680754 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:07:35.696923 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:07:35.714244 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:07:35.728792 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:07:35.739721 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:07:35.747393 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:07:35.754461 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:07:35.763733 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:07:35.782336 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:07:35.787589 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:07:35.792593 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:07:35.810459 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:07:35.818583 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:07:35.823200 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:07:35.833307 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:07:35.841246 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:07:35.851249 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:07:35.860786 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:07:35.916639 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:07:35.942034 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:07:35.947953 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:07:35.952051 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:07:36.953354 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:07:36.976997 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:07:36.984237 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:07:37.009959 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:07:37.027600 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:07:37.035694 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:07:37.093795 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:07:37.316351 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:07:37.474337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eee810d0>]}
[0m04:07:37.481948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef61f340>]}
[0m04:07:37.484477 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:37.486579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef76c640>]}
[0m04:07:37.491968 [info ] [MainThread]: 
[0m04:07:37.500947 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:37.524675 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:07:37.550379 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:07:37.554923 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:07:37.556425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:37.569660 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:07:37.574707 [debug] [ThreadPool]: On list_*****: Close
[0m04:07:37.583782 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:07:37.603231 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:37.611749 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:07:37.615144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:07:37.621844 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:07:37.623693 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:37.625275 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:07:37.632808 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.01 seconds
[0m04:07:37.637618 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:07:37.641186 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:07:37.660126 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:37.667529 [debug] [MainThread]: On master: BEGIN
[0m04:07:37.670077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:37.684404 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:37.688372 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:37.692837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:07:37.716578 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m04:07:37.721150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eee9da90>]}
[0m04:07:37.725958 [debug] [MainThread]: On master: ROLLBACK
[0m04:07:37.732512 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:37.734209 [debug] [MainThread]: On master: BEGIN
[0m04:07:37.741039 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:37.743996 [debug] [MainThread]: On master: COMMIT
[0m04:07:37.745734 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:37.747667 [debug] [MainThread]: On master: COMMIT
[0m04:07:37.750236 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:37.751852 [debug] [MainThread]: On master: Close
[0m04:07:37.756198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:07:37.764479 [info ] [MainThread]: 
[0m04:07:37.792395 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m04:07:37.795409 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m04:07:37.798832 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m04:07:37.800249 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m04:07:37.801747 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m04:07:37.829083 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:37.831003 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m04:07:37.834014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:07:37.843226 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:07:37.845566 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:37.848750 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m04:07:37.858303 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:07:37.866122 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m04:07:37.876371 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:37.878235 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m04:07:37.953601 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m04:07:37.974774 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:37.976594 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m04:07:37.997585 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
[0m04:07:38.015244 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:38.017266 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m04:07:38.020802 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:07:38.064225 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m04:07:38.066646 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:38.068936 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m04:07:38.071241 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:07:38.085840 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:38.089292 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m04:07:38.094429 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:07:38.099820 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:38.103669 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m04:07:38.106302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee5ddd30>]}
[0m04:07:38.109507 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m04:07:38.112700 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m04:07:38.119677 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:38.121679 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:38.123749 [debug] [MainThread]: On master: BEGIN
[0m04:07:38.125706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:38.133245 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:38.135137 [debug] [MainThread]: On master: COMMIT
[0m04:07:38.136776 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:38.138050 [debug] [MainThread]: On master: COMMIT
[0m04:07:38.139687 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:38.140932 [debug] [MainThread]: On master: Close
[0m04:07:38.143458 [info ] [MainThread]: 
[0m04:07:38.145845 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m04:07:38.149173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:38.150604 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m04:07:38.152556 [info ] [MainThread]: 
[0m04:07:38.154569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:07:38.156228 [info ] [MainThread]: 
[0m04:07:38.157855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:07:38.159348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee5f24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee5f2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee5f2ca0>]}
[0m04:07:38.161056 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:43.287731 | 1960cb93-b966-4ca7-beb7-c52c0f7c4b6b ==============================
[0m04:07:43.287759 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:43.289066 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m04:07:43.290315 [debug] [MainThread]: Tracking: tracking
[0m04:07:43.297388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cdf55cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cdf55af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cdf55b50>]}
[0m04:07:43.475640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:43.476751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:43.488297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1960cb93-b966-4ca7-beb7-c52c0f7c4b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cdcc30d0>]}
[0m04:07:43.493240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1960cb93-b966-4ca7-beb7-c52c0f7c4b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea640>]}
[0m04:07:43.495273 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:43.496649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1960cb93-b966-4ca7-beb7-c52c0f7c4b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea880>]}
[0m04:07:43.500186 [info ] [MainThread]: 
[0m04:07:43.503298 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:07:43.506408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea4c0>]}
[0m04:07:43.508421 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:48.180324 | 047dfee6-cd02-4c77-aecd-51856fdba014 ==============================
[0m04:07:48.180353 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:48.181382 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:07:48.182528 [debug] [MainThread]: Tracking: tracking
[0m04:07:48.189210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6006a23cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6006a23af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6006a23b50>]}
[0m04:07:48.498330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:48.500715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:48.513989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60067940d0>]}
[0m04:07:48.517602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60068cc640>]}
[0m04:07:48.519257 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:48.521059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60068cc880>]}
[0m04:07:48.525089 [info ] [MainThread]: 
[0m04:07:48.527162 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:48.529800 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:07:48.555256 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:07:48.557485 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:07:48.559207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:48.568837 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:07:48.573605 [debug] [ThreadPool]: On list_*****: Close
[0m04:07:48.580410 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:07:48.600079 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:48.610723 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:07:48.615845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:07:48.622687 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:07:48.624385 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:48.625722 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:07:48.634000 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m04:07:48.641630 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:07:48.648056 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:07:48.667150 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.670620 [debug] [MainThread]: On master: BEGIN
[0m04:07:48.673715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:48.680030 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:48.681741 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.683088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:07:48.694708 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m04:07:48.698229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6006a24b50>]}
[0m04:07:48.699988 [debug] [MainThread]: On master: ROLLBACK
[0m04:07:48.701740 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.703377 [debug] [MainThread]: On master: BEGIN
[0m04:07:48.706085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:07:48.707699 [debug] [MainThread]: On master: COMMIT
[0m04:07:48.709239 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.710938 [debug] [MainThread]: On master: COMMIT
[0m04:07:48.712730 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:48.714255 [debug] [MainThread]: On master: Close
[0m04:07:48.716314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:07:48.719949 [info ] [MainThread]: 
[0m04:07:48.750225 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m04:07:48.752305 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m04:07:48.754775 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.756251 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m04:07:48.757736 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m04:07:48.765670 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m04:07:48.786938 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:48.791065 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m04:07:48.861060 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m04:07:48.883554 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.886181 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m04:07:48.888707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:07:48.896743 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:07:48.898914 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.901253 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m04:07:48.911494 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:07:48.924626 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.926148 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m04:07:48.929113 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:07:48.956680 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m04:07:48.958165 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.959554 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m04:07:48.964153 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:07:48.972222 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.973724 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m04:07:48.975412 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:07:48.977824 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:48.979265 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m04:07:48.981037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6005f76c70>]}
[0m04:07:48.982452 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.23s]
[0m04:07:48.984183 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m04:07:48.988103 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:48.989623 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.990926 [debug] [MainThread]: On master: BEGIN
[0m04:07:48.992173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:48.997749 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:48.999079 [debug] [MainThread]: On master: COMMIT
[0m04:07:49.001814 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:49.003034 [debug] [MainThread]: On master: COMMIT
[0m04:07:49.004396 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:49.005695 [debug] [MainThread]: On master: Close
[0m04:07:49.007350 [info ] [MainThread]: 
[0m04:07:49.008894 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m04:07:49.010633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:49.011923 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m04:07:49.013319 [info ] [MainThread]: 
[0m04:07:49.014794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:07:49.016344 [info ] [MainThread]: 
[0m04:07:49.017770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:07:49.019126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6005f5e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6005f5e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6005f5e4f0>]}
[0m04:07:49.020449 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:54.360719 | fc9af739-f51c-47f3-a12d-3f9fe74831d2 ==============================
[0m04:07:54.360806 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:54.362477 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m04:07:54.363873 [debug] [MainThread]: Tracking: tracking
[0m04:07:54.372277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81c34c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81c34070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81c34b20>]}
[0m04:07:54.668592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:54.670324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:54.682999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc9af739-f51c-47f3-a12d-3f9fe74831d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d819a10d0>]}
[0m04:07:54.688764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc9af739-f51c-47f3-a12d-3f9fe74831d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81acf670>]}
[0m04:07:54.690915 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:54.693435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc9af739-f51c-47f3-a12d-3f9fe74831d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81acf8b0>]}
[0m04:07:54.698563 [info ] [MainThread]: 
[0m04:07:54.701780 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:54.712066 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:07:54.738970 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:54.741017 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:07:54.742662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:54.750836 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:07:54.752749 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:54.754356 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:07:54.759239 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m04:07:54.764599 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:07:54.766743 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:07:54.783244 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:54.785324 [debug] [MainThread]: On master: BEGIN
[0m04:07:54.787021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:54.794201 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:54.795831 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:54.797813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:07:54.814496 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m04:07:54.819793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc9af739-f51c-47f3-a12d-3f9fe74831d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81acf400>]}
[0m04:07:54.821866 [debug] [MainThread]: On master: ROLLBACK
[0m04:07:54.827082 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:54.828914 [debug] [MainThread]: On master: BEGIN
[0m04:07:54.831220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:07:54.832735 [debug] [MainThread]: On master: COMMIT
[0m04:07:54.834291 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:54.835631 [debug] [MainThread]: On master: COMMIT
[0m04:07:54.837280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:54.841189 [debug] [MainThread]: On master: Close
[0m04:07:54.844402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:07:54.846908 [info ] [MainThread]: 
[0m04:07:54.875247 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.877278 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m04:07:54.879809 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.881119 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.882658 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.909082 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.916670 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:54.918151 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.947906 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.955327 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.957455 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m04:07:54.959149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:07:54.968203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:07:54.969646 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.971155 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m04:07:54.980483 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:07:54.985218 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:54.986657 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m04:07:54.988071 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m04:07:54.990113 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.11s]
[0m04:07:54.992326 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.996116 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:54.999461 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:55.001050 [debug] [MainThread]: On master: BEGIN
[0m04:07:55.002786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:55.014368 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:55.016607 [debug] [MainThread]: On master: COMMIT
[0m04:07:55.019014 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:55.020722 [debug] [MainThread]: On master: COMMIT
[0m04:07:55.023427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:55.025794 [debug] [MainThread]: On master: Close
[0m04:07:55.029419 [info ] [MainThread]: 
[0m04:07:55.032069 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m04:07:55.033866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:55.035463 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m04:07:55.037014 [info ] [MainThread]: 
[0m04:07:55.038457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:07:55.040144 [info ] [MainThread]: 
[0m04:07:55.041639 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:07:55.043708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d811715e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d811719a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81171040>]}
[0m04:07:55.045106 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:59.955761 | 06becb39-1da8-483d-8bd9-72dba47b7cdd ==============================
[0m04:07:59.955793 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:59.956937 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:07:59.958151 [debug] [MainThread]: Tracking: tracking
[0m04:07:59.965593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa654cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa654c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa654cb20>]}
[0m04:08:00.136597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:00.137925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:00.147194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa62bb0d0>]}
[0m04:08:00.156711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa63e8670>]}
[0m04:08:00.158322 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:08:00.159843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa63e88b0>]}
[0m04:08:00.162546 [info ] [MainThread]: 
[0m04:08:00.164008 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:00.166209 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:08:00.182203 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:08:00.184644 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:08:00.186784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:00.195412 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:08:00.198412 [debug] [ThreadPool]: On list_*****: Close
[0m04:08:00.202164 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:08:00.212752 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:00.214424 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:08:00.215685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:00.221849 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:08:00.223331 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:00.224703 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:00.228857 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m04:08:00.233022 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:08:00.234681 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:08:00.243925 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.245415 [debug] [MainThread]: On master: BEGIN
[0m04:08:00.246631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:00.252406 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:00.254003 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.255581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:00.265787 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m04:08:00.268787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa65451c0>]}
[0m04:08:00.270057 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:00.271394 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.272713 [debug] [MainThread]: On master: BEGIN
[0m04:08:00.275020 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:00.276441 [debug] [MainThread]: On master: COMMIT
[0m04:08:00.278095 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.279308 [debug] [MainThread]: On master: COMMIT
[0m04:08:00.280842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:00.282194 [debug] [MainThread]: On master: Close
[0m04:08:00.284325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:00.286019 [info ] [MainThread]: 
[0m04:08:00.306141 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m04:08:00.307939 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m04:08:00.309760 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m04:08:00.310956 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m04:08:00.312173 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m04:08:00.317178 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m04:08:00.322868 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:00.324314 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m04:08:00.378547 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m04:08:00.384422 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.390544 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m04:08:00.391699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:00.396366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m04:08:00.397628 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.398819 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m04:08:00.402527 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:08:00.410206 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.411685 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m04:08:00.413247 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:08:00.440508 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m04:08:00.459892 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.461713 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m04:08:00.464640 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:08:00.472858 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.474081 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m04:08:00.475415 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:08:00.477690 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:00.478750 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m04:08:00.482337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa5a7e130>]}
[0m04:08:00.483628 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.17s]
[0m04:08:00.484956 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m04:08:00.487544 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:00.488757 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.489762 [debug] [MainThread]: On master: BEGIN
[0m04:08:00.490769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:00.495391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:00.496610 [debug] [MainThread]: On master: COMMIT
[0m04:08:00.497625 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.498588 [debug] [MainThread]: On master: COMMIT
[0m04:08:00.499746 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:00.500795 [debug] [MainThread]: On master: Close
[0m04:08:00.502264 [info ] [MainThread]: 
[0m04:08:00.503412 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m04:08:00.504658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:00.505639 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m04:08:00.506849 [info ] [MainThread]: 
[0m04:08:00.507964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:00.509185 [info ] [MainThread]: 
[0m04:08:00.510648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:08:00.511992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa62bfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa62bfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa62bf490>]}
[0m04:08:00.513599 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:08:05.433171 | b778695c-a337-4321-9c31-6c97fed1ae3a ==============================
[0m04:08:05.433245 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:08:05.435658 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m04:08:05.437543 [debug] [MainThread]: Tracking: tracking
[0m04:08:05.446929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b1b1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b1b1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b1b1b20>]}
[0m04:08:05.688926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:05.689934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:05.700239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b778695c-a337-4321-9c31-6c97fed1ae3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116af200d0>]}
[0m04:08:05.703148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b778695c-a337-4321-9c31-6c97fed1ae3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b04c670>]}
[0m04:08:05.705387 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:08:05.708450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b778695c-a337-4321-9c31-6c97fed1ae3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b04c8b0>]}
[0m04:08:05.711871 [info ] [MainThread]: 
[0m04:08:05.714043 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:05.717405 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:08:05.737300 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:05.739466 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:08:05.740846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:05.754531 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:08:05.756822 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:05.758405 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:05.766253 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.01 seconds
[0m04:08:05.771439 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:08:05.773374 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:08:05.784212 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:05.785805 [debug] [MainThread]: On master: BEGIN
[0m04:08:05.788263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:05.795082 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:05.796743 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:05.798115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:05.808686 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m04:08:05.812223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b778695c-a337-4321-9c31-6c97fed1ae3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b04c4c0>]}
[0m04:08:05.814141 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:05.815699 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:05.817117 [debug] [MainThread]: On master: BEGIN
[0m04:08:05.819414 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:05.822490 [debug] [MainThread]: On master: COMMIT
[0m04:08:05.824093 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:05.825547 [debug] [MainThread]: On master: COMMIT
[0m04:08:05.828805 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:05.831595 [debug] [MainThread]: On master: Close
[0m04:08:05.833727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:05.835587 [info ] [MainThread]: 
[0m04:08:05.856661 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.858391 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m04:08:05.861932 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.864360 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.866184 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.890088 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.896002 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:05.897987 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.920358 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.925609 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.927191 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m04:08:05.928872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:05.935029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:05.936647 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.938233 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m04:08:05.945209 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:05.949588 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:05.950980 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m04:08:05.952563 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m04:08:05.955107 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.09s]
[0m04:08:05.957139 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.958646 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:05.959855 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m04:08:05.961945 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:05.963412 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:05.965144 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:05.981505 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:05.986859 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:05.988414 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:05.992899 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:05.997638 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:05.999492 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m04:08:06.000723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:06.008819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:06.010525 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:06.012585 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:08:06.021310 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:06.025053 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:06.026426 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m04:08:06.028010 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m04:08:06.030114 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.07s]
[0m04:08:06.032006 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:06.035180 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:06.036517 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:06.037747 [debug] [MainThread]: On master: BEGIN
[0m04:08:06.038917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:06.044739 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:06.046839 [debug] [MainThread]: On master: COMMIT
[0m04:08:06.048311 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:06.049568 [debug] [MainThread]: On master: COMMIT
[0m04:08:06.050978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:06.052050 [debug] [MainThread]: On master: Close
[0m04:08:06.054150 [info ] [MainThread]: 
[0m04:08:06.055601 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m04:08:06.056853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:06.058016 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m04:08:06.059171 [info ] [MainThread]: 
[0m04:08:06.060606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:06.062463 [info ] [MainThread]: 
[0m04:08:06.063883 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:08:06.065545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116a6d6ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116a6d6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116a695100>]}
[0m04:08:06.066882 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:08:11.350649 | 6f38a286-fb81-4032-99d9-d2c13374fd92 ==============================
[0m04:08:11.350721 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:08:11.352110 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:08:11.356568 [debug] [MainThread]: Tracking: tracking
[0m04:08:11.363187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1427435c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1427435070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1427435b20>]}
[0m04:08:11.628993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:11.630337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:11.639593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14271a30d0>]}
[0m04:08:11.642898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14272d0670>]}
[0m04:08:11.644107 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:08:11.645348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14272d08b0>]}
[0m04:08:11.647841 [info ] [MainThread]: 
[0m04:08:11.649272 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:11.652047 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:08:11.668939 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:08:11.670958 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:08:11.672140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:11.678764 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:08:11.681323 [debug] [ThreadPool]: On list_*****: Close
[0m04:08:11.684913 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:08:11.694955 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:11.696165 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:08:11.697415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:11.711260 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:08:11.713268 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:11.715520 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:11.725634 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m04:08:11.730408 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:08:11.732172 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:08:11.744080 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:11.745503 [debug] [MainThread]: On master: BEGIN
[0m04:08:11.746768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:11.753147 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:11.755171 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:11.756839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:11.768506 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m04:08:11.772760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14274371c0>]}
[0m04:08:11.774619 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:11.776505 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:11.777725 [debug] [MainThread]: On master: BEGIN
[0m04:08:11.779609 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:11.780924 [debug] [MainThread]: On master: COMMIT
[0m04:08:11.782240 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:11.783890 [debug] [MainThread]: On master: COMMIT
[0m04:08:11.786068 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:11.788476 [debug] [MainThread]: On master: Close
[0m04:08:11.790565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:11.792121 [info ] [MainThread]: 
[0m04:08:11.813455 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m04:08:11.815384 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m04:08:11.819377 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m04:08:11.822106 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m04:08:11.823675 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m04:08:11.844231 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:08:11.861376 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m04:08:11.879044 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:11.880472 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m04:08:11.963159 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m04:08:11.978332 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:11.980410 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m04:08:11.981739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:11.987690 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:11.989070 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:11.990142 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m04:08:11.998473 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:08:12.008985 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:12.010717 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m04:08:12.012970 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:08:12.037530 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m04:08:12.039485 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:12.040753 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m04:08:12.043230 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:08:12.053062 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:12.054676 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m04:08:12.056368 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:08:12.059150 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:12.060458 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m04:08:12.062909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142692f1c0>]}
[0m04:08:12.066671 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.25s]
[0m04:08:12.069918 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m04:08:12.074224 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:12.075610 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:12.077193 [debug] [MainThread]: On master: BEGIN
[0m04:08:12.080176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:12.088359 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:12.090094 [debug] [MainThread]: On master: COMMIT
[0m04:08:12.091517 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:12.092760 [debug] [MainThread]: On master: COMMIT
[0m04:08:12.094549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:12.095919 [debug] [MainThread]: On master: Close
[0m04:08:12.097969 [info ] [MainThread]: 
[0m04:08:12.099564 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m04:08:12.100930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:12.102127 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m04:08:12.103432 [info ] [MainThread]: 
[0m04:08:12.104617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:12.106290 [info ] [MainThread]: 
[0m04:08:12.107711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:08:12.109153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142718af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14271af280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14271af130>]}
[0m04:08:12.111355 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:08:17.180861 | 147bbb87-d452-434c-af92-f91d315dd598 ==============================
[0m04:08:17.180888 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:08:17.182086 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m04:08:17.183383 [debug] [MainThread]: Tracking: tracking
[0m04:08:17.188917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa238034610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa238034ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa238034b20>]}
[0m04:08:17.367557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:17.368662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:17.377410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '147bbb87-d452-434c-af92-f91d315dd598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237da1fd0>]}
[0m04:08:17.379969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '147bbb87-d452-434c-af92-f91d315dd598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237eb85e0>]}
[0m04:08:17.381228 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:08:17.382793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147bbb87-d452-434c-af92-f91d315dd598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237eb8820>]}
[0m04:08:17.386295 [info ] [MainThread]: 
[0m04:08:17.387782 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:17.390196 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:08:17.405429 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:17.406979 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:08:17.408358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:17.413970 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.415239 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:17.416249 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:17.419635 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m04:08:17.423531 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:08:17.424794 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:08:17.433251 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:17.434461 [debug] [MainThread]: On master: BEGIN
[0m04:08:17.435502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:17.440733 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.442655 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:17.444386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:17.462558 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m04:08:17.466144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147bbb87-d452-434c-af92-f91d315dd598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237eb8430>]}
[0m04:08:17.470550 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:17.472705 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:17.475058 [debug] [MainThread]: On master: BEGIN
[0m04:08:17.477809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:17.479618 [debug] [MainThread]: On master: COMMIT
[0m04:08:17.481585 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:17.483153 [debug] [MainThread]: On master: COMMIT
[0m04:08:17.484877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:17.486216 [debug] [MainThread]: On master: Close
[0m04:08:17.488163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:17.490509 [info ] [MainThread]: 
[0m04:08:17.513250 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.515475 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m04:08:17.517624 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.519125 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.520514 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.543864 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.550510 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.552515 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.579120 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.587709 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.589130 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m04:08:17.590244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.595964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.597216 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.598538 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m04:08:17.615639 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m04:08:17.620197 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.621869 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m04:08:17.623497 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m04:08:17.625120 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.11s]
[0m04:08:17.627380 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.629016 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.630396 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m04:08:17.632348 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.634215 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.635787 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.652497 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.657805 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.659777 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.664421 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.682826 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.684448 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m04:08:17.686008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.691359 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.692694 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.693990 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m04:08:17.707847 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:17.711057 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.712291 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m04:08:17.714902 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m04:08:17.717143 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.09s]
[0m04:08:17.718953 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.720122 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.721595 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m04:08:17.723563 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.724815 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.725932 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.737788 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.744638 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.746674 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.755061 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.760533 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.761985 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m04:08:17.763020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.768898 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.770203 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.771558 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m04:08:17.784104 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:17.786744 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.788133 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m04:08:17.789487 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m04:08:17.791238 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.07s]
[0m04:08:17.792753 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.794048 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.795150 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m04:08:17.797692 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.799783 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.802038 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.809784 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.816343 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.818398 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.824396 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.833088 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.834612 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m04:08:17.835721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.841550 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.843084 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.844439 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m04:08:17.858851 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:17.862887 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.864214 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m04:08:17.865770 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m04:08:17.867523 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.07s]
[0m04:08:17.870004 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.871495 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.873077 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m04:08:17.875249 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.876796 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.878541 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.887541 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.893053 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.894684 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.899277 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.903490 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.904715 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m04:08:17.905915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.914914 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.919729 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.923457 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m04:08:17.941545 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:17.944706 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.946002 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m04:08:17.947417 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m04:08:17.949015 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.07s]
[0m04:08:17.951330 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.952421 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m04:08:17.953636 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m04:08:17.955449 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:17.956755 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m04:08:17.957961 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m04:08:17.964926 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:17.982422 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.983758 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m04:08:17.988006 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:17.992756 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:17.994067 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m04:08:17.995008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.000116 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.001446 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:18.002638 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m04:08:18.017404 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.020440 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.021756 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m04:08:18.023241 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m04:08:18.024904 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.07s]
[0m04:08:18.027820 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m04:08:18.029037 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.030212 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m04:08:18.032174 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.033345 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.034350 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.042877 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.050152 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.051609 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.056448 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.061124 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.062746 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m04:08:18.063962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.069480 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.070592 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.071700 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m04:08:18.085192 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.088031 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.091361 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m04:08:18.095840 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m04:08:18.099936 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.07s]
[0m04:08:18.103953 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.105844 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.107376 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m04:08:18.109831 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.111441 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.112778 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.119852 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.132371 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.134095 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.138485 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.143015 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.144373 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m04:08:18.145496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.150185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m04:08:18.151530 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.152675 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m04:08:18.164437 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.167731 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.169032 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m04:08:18.170439 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m04:08:18.172083 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.06s]
[0m04:08:18.173617 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.174905 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.175943 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m04:08:18.177329 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.178240 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.179387 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.184728 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.189123 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.190146 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.193785 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.197630 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.198867 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m04:08:18.200043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.205046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.206893 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.208720 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m04:08:18.222934 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.225898 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.227210 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m04:08:18.229013 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m04:08:18.230865 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.05s]
[0m04:08:18.232450 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.233977 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.235109 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m04:08:18.237012 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.238391 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.242791 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.253486 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.260539 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.262058 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.266807 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.282948 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.284760 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m04:08:18.286310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.292246 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.293914 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.295261 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m04:08:18.310850 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.314534 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.316063 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m04:08:18.317647 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m04:08:18.319690 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.08s]
[0m04:08:18.322531 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.324408 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.326632 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m04:08:18.329759 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.331383 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.332979 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.340685 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.346785 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.348188 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.352908 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.377985 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.380712 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m04:08:18.382404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.388801 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.390345 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.392052 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m04:08:18.407001 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.411493 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.413153 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m04:08:18.415170 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m04:08:18.417501 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.09s]
[0m04:08:18.419481 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.420990 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.422520 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m04:08:18.424553 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.425930 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.427204 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.434333 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.440099 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.441649 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.446664 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.451520 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.453018 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m04:08:18.454630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.460321 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.461864 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.463206 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m04:08:18.477761 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.480848 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.482062 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m04:08:18.483287 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m04:08:18.484965 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.06s]
[0m04:08:18.486681 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.487975 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.489169 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m04:08:18.490827 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.491982 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.492996 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.499682 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.505469 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.507290 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.515723 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.533942 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.535341 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m04:08:18.536655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.542442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.543680 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.545064 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m04:08:18.560223 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.564144 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.565989 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m04:08:18.567599 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m04:08:18.569415 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.08s]
[0m04:08:18.571454 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.573069 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.574831 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m04:08:18.578434 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.579916 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.582062 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.591034 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.596854 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.598641 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.606601 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.613096 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.614486 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m04:08:18.615659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.622435 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.624348 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.626480 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m04:08:18.644079 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m04:08:18.648120 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.650101 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m04:08:18.652140 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m04:08:18.654629 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.08s]
[0m04:08:18.657234 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.659192 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.661151 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m04:08:18.664680 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.666093 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.667626 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.682486 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.687662 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.689000 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.693422 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.697666 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.698926 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m04:08:18.700197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.706261 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.708155 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.709762 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:08:18.727112 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m04:08:18.731668 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.733077 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m04:08:18.734438 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m04:08:18.736097 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.07s]
[0m04:08:18.737603 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.741149 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:18.742478 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:18.743540 [debug] [MainThread]: On master: BEGIN
[0m04:08:18.744681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:18.749524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:18.750644 [debug] [MainThread]: On master: COMMIT
[0m04:08:18.751855 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:18.753157 [debug] [MainThread]: On master: COMMIT
[0m04:08:18.754910 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:18.756467 [debug] [MainThread]: On master: Close
[0m04:08:18.758489 [info ] [MainThread]: 
[0m04:08:18.760010 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m04:08:18.761540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:18.762981 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m04:08:18.764597 [info ] [MainThread]: 
[0m04:08:18.766109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:18.767560 [info ] [MainThread]: 
[0m04:08:18.768840 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m04:08:18.770331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237501520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237501460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2375017f0>]}
[0m04:08:18.771730 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:25:31.562839 | 61d94b13-480c-40ba-9db5-b0f1f2a45fba ==============================
[0m04:25:31.562868 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:25:31.564489 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m04:25:31.567682 [debug] [MainThread]: Tracking: tracking
[0m04:25:31.584723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6840cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6840cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6840cc10>]}
[0m04:25:31.589405 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wq9ztvm7'
[0m04:25:31.631205 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:25:32.143883 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:25:32.145928 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:25:32.381575 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:25:32.564251 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:25:38.489166 [info ] [MainThread]:   Installed from version 0.8.0
[0m04:25:38.491978 [info ] [MainThread]:   Updated version available: 0.9.6
[0m04:25:38.495251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '61d94b13-480c-40ba-9db5-b0f1f2a45fba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c683bd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c685289a0>]}
[0m04:25:38.497993 [info ] [MainThread]: 
[0m04:25:38.500417 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m04:25:38.503826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c684a6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c684a6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c683b8400>]}
[0m04:25:38.506618 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:25:43.822950 | 29316580-8522-4411-ba74-ae4f49d2f025 ==============================
[0m04:25:43.822980 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:25:43.824175 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:25:43.825460 [debug] [MainThread]: Tracking: tracking
[0m04:25:43.834913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ea4e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ea4e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ea4e130>]}
[0m04:25:43.958096 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:25:43.960199 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m04:25:43.961251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29316580-8522-4411-ba74-ae4f49d2f025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb53d94f70>]}
[0m04:25:44.248290 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:25:44.251461 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:25:44.291910 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:25:44.298885 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:25:44.303584 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:25:44.307204 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:25:44.310600 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:25:44.314399 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:25:44.317868 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:25:44.320149 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:25:44.325975 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:25:44.342253 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:25:44.349583 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:25:44.359949 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:25:44.368416 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:25:44.374964 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:25:44.384386 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:25:44.387692 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:25:44.393229 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:25:44.399806 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:25:44.405554 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:25:44.418870 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:25:44.432349 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:25:44.448214 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:25:44.451492 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:25:44.454892 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:25:44.458953 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:25:44.461633 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:25:44.463838 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:25:44.466116 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:25:44.469410 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:25:44.472455 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:25:44.479758 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:25:44.500732 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:25:44.505803 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:25:44.508444 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:25:44.510661 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:25:44.512567 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:25:44.516760 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:25:44.518763 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:25:44.521219 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:25:44.523469 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:25:44.526436 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:25:44.528460 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:25:44.533918 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:25:44.536087 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:25:44.538324 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:25:44.540491 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:25:44.556437 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:25:44.580817 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:25:44.585268 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:25:44.590635 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:25:44.613922 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:25:44.618491 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:25:44.630143 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:25:44.637979 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:25:44.643458 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:25:44.647570 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:25:44.653995 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:25:44.660340 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:25:44.670307 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:25:44.683050 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:25:44.693199 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:25:44.723072 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:25:44.727362 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:25:44.755856 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:25:44.774343 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:25:44.777292 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:25:44.781485 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:25:44.787266 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:25:44.796911 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:25:44.819591 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:25:44.843813 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:25:44.863540 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:25:44.867373 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:25:44.871694 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:25:44.879856 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:25:44.888819 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:25:44.919791 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:25:44.931316 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:25:44.936862 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:25:44.941277 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:25:44.944000 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:25:44.950106 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:25:44.952390 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:25:44.958541 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:25:44.967743 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:25:44.970823 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:25:44.975974 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:25:44.993335 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:25:44.995816 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:25:44.998325 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:25:45.001461 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:25:45.003735 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:25:45.009297 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:25:45.011732 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:25:45.013655 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:25:45.016264 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:25:45.018413 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:25:45.022123 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:25:45.025361 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:25:45.028445 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:25:45.036949 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:25:45.040223 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:25:45.044314 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:25:45.047238 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:25:45.049588 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:25:45.087004 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:25:45.092088 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:25:45.095406 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:25:45.099228 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:25:45.102580 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:25:45.108135 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:25:45.111213 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:25:45.114438 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:25:45.129717 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:25:45.133673 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:25:45.136404 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:25:45.140265 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:25:45.143719 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:25:45.147356 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:25:45.151923 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:25:45.154581 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:25:45.157155 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:25:45.161886 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:25:45.169852 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:25:45.178066 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:25:45.186363 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:25:45.191229 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:25:45.196551 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:25:45.202104 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:25:45.212803 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:25:45.216324 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:25:45.219219 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:25:45.228575 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:25:45.231553 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:25:45.234749 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:25:45.241132 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:25:45.244216 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:25:45.250145 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:25:45.255358 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:25:45.268599 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:25:45.316734 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:25:45.320990 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:25:45.324382 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:25:45.824935 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:25:45.842609 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:25:45.847598 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:25:45.863782 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:25:45.884633 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:25:45.888212 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:25:45.928200 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:25:46.126130 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:25:46.260984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29316580-8522-4411-ba74-ae4f49d2f025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4de360d0>]}
[0m04:25:46.284200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29316580-8522-4411-ba74-ae4f49d2f025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ddda0a0>]}
[0m04:25:46.285407 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:25:46.286582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29316580-8522-4411-ba74-ae4f49d2f025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5027a190>]}
[0m04:25:46.288511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ea9b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4e898100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4de02640>]}
[0m04:25:46.289592 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:57:34.924327 | bb75c9b9-07d1-4523-8e53-5fc8691a6745 ==============================
[0m04:57:34.924373 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:57:34.926247 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m04:57:34.927864 [debug] [MainThread]: Tracking: tracking
[0m04:57:34.945065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baac8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baac8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baac8c40>]}
[0m04:57:34.952650 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nrrq5epo'
[0m04:57:34.954253 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:57:35.271355 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:57:35.275577 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:57:35.575039 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:57:35.799102 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:57:40.645275 [info ] [MainThread]:   Installed from version 0.8.0
[0m04:57:40.648655 [info ] [MainThread]:   Updated version available: 0.9.6
[0m04:57:40.655940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bb75c9b9-07d1-4523-8e53-5fc8691a6745', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baa7edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baa7ed30>]}
[0m04:57:40.658161 [info ] [MainThread]: 
[0m04:57:40.660302 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m04:57:40.663571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baadc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baa81190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baa810d0>]}
[0m04:57:40.665435 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:57:44.427661 | 05f8f9c2-946b-4a5d-8baa-8754ffe31028 ==============================
[0m04:57:44.427689 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:57:44.430536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:57:44.431881 [debug] [MainThread]: Tracking: tracking
[0m04:57:44.439447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e7c2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e7c20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e7c2130>]}
[0m04:57:44.915818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:44.917167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:44.929702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05f8f9c2-946b-4a5d-8baa-8754ffe31028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e58d0d0>]}
[0m04:57:44.980387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05f8f9c2-946b-4a5d-8baa-8754ffe31028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b4df0>]}
[0m04:57:44.982199 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:57:44.985328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05f8f9c2-946b-4a5d-8baa-8754ffe31028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b4be0>]}
[0m04:57:44.988807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b49d0>]}
[0m04:57:44.993520 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:58:40.748405 | c6c9bba7-398f-4211-8916-1cde74bc55a5 ==============================
[0m04:58:40.748449 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:58:40.751618 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m04:58:40.753674 [debug] [MainThread]: Tracking: tracking
[0m04:58:40.783143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e53aebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e53aeb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e53aeb80>]}
[0m04:58:41.281425 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m04:58:41.328335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e5367730>]}
[0m04:58:41.871446 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:58:41.894798 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:58:41.967380 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:58:41.974004 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:58:41.979582 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:58:41.983667 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:58:41.988678 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:58:41.992018 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:58:41.999658 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:58:42.002413 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:58:42.005653 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:58:42.022147 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:58:42.025785 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:58:42.030727 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:58:42.037841 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:58:42.051202 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:58:42.056377 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:58:42.059561 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:58:42.064002 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:58:42.066481 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:58:42.068667 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:58:42.080719 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:58:42.090789 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:58:42.106606 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:58:42.109467 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:58:42.112090 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:58:42.116369 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:58:42.118745 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:58:42.121203 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:58:42.123526 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:58:42.126892 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:58:42.129550 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:58:42.135532 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:58:42.149305 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:58:42.152963 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:58:42.155877 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:58:42.158104 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:58:42.160969 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:58:42.163877 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:58:42.166994 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:58:42.169821 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:58:42.172025 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:58:42.175057 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:58:42.177211 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:58:42.179643 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:58:42.183352 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:58:42.185644 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:58:42.188554 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:58:42.209630 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:58:42.236280 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:58:42.240783 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:58:42.246477 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:58:42.267072 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:58:42.271919 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:58:42.286848 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:58:42.295244 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:58:42.301168 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:58:42.305650 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:58:42.312977 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:58:42.323680 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:58:42.335084 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:58:42.349103 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:58:42.361464 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:58:42.393629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:58:42.397728 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:58:42.425415 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:58:42.442934 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:58:42.447482 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:58:42.451621 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:58:42.460405 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:58:42.470909 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:58:42.494585 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:58:42.520540 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:58:42.542088 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:58:42.546146 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:58:42.549656 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:58:42.553077 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:58:42.560658 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:58:42.594175 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:58:42.606668 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:58:42.613368 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:58:42.617543 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:58:42.620382 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:58:42.623424 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:58:42.625646 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:58:42.631816 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:58:42.640641 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:58:42.644855 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:58:42.650728 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:58:42.669677 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:58:42.672472 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:58:42.675287 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:58:42.679544 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:58:42.682067 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:58:42.690691 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:58:42.694209 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:58:42.697097 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:58:42.700734 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:58:42.703558 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:58:42.708349 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:58:42.712565 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:58:42.716635 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:58:42.729517 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:58:42.732916 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:58:42.735681 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:58:42.738668 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:58:42.741337 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:58:42.782509 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:58:42.794120 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:58:42.798591 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:58:42.804576 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:58:42.808227 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:58:42.815961 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:58:42.819931 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:58:42.824024 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:58:42.889165 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:58:42.894388 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:58:42.897612 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:58:42.901815 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:58:42.905388 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:58:42.917891 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:58:42.924303 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:58:42.928850 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:58:42.933458 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:58:42.980536 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:58:42.993556 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:58:43.003928 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:58:43.014032 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:58:43.018995 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:58:43.026604 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:58:43.033504 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:58:43.045941 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:58:43.050380 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:58:43.053308 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:58:43.068434 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:58:43.132037 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:58:43.143534 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:58:43.207671 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:58:43.219328 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:58:43.232656 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:58:43.240985 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:58:43.300038 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:58:43.377152 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:58:43.387274 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:58:43.399545 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:58:44.228986 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:58:44.255687 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:58:44.264181 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:58:44.287360 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:58:44.305596 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:58:44.312166 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:58:44.391435 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:58:44.790376 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:58:44.918290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e46d40d0>]}
[0m04:58:44.955522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e46ccf70>]}
[0m04:58:44.957053 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:58:44.959272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e5170460>]}
[0m04:58:44.964242 [info ] [MainThread]: 
[0m04:58:44.966650 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:58:44.969063 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:58:44.979519 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:58:44.980922 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:58:44.982190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:58:44.991215 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:58:44.995141 [debug] [ThreadPool]: On list_*****: Close
[0m04:58:44.998639 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:58:45.009214 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:58:45.010586 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:58:45.011911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:58:45.018305 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:58:45.019705 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:58:45.020937 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:58:45.025202 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m04:58:45.029314 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:58:45.030702 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:58:45.040338 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.041874 [debug] [MainThread]: On master: BEGIN
[0m04:58:45.043036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:58:45.049503 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:58:45.051167 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.052530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:58:45.063307 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m04:58:45.066402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e46d9b20>]}
[0m04:58:45.067980 [debug] [MainThread]: On master: ROLLBACK
[0m04:58:45.070598 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.071948 [debug] [MainThread]: On master: BEGIN
[0m04:58:45.074907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:58:45.076279 [debug] [MainThread]: On master: COMMIT
[0m04:58:45.077447 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.078964 [debug] [MainThread]: On master: COMMIT
[0m04:58:45.080631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:58:45.082381 [debug] [MainThread]: On master: Close
[0m04:58:45.084448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:58:45.088079 [info ] [MainThread]: 
[0m04:58:45.114002 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m04:58:45.116039 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m04:58:45.118761 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m04:58:45.120464 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m04:58:45.122064 [debug] [Thread-1  ]: finished collecting timing info
[0m04:58:45.123634 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m04:58:45.202977 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:58:45.204958 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m04:58:45.206440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:58:45.215421 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:58:45.217359 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:58:45.218831 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */
truncate table "*****"."public"."subscription_periods"
[0m04:58:45.224564 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m04:58:45.445781 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:58:45.447717 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m04:58:45.451888 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m04:58:45.466614 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m04:58:45.510186 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m04:58:45.513744 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:58:45.516014 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m04:58:45.519858 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:58:45.522115 [debug] [Thread-1  ]: finished collecting timing info
[0m04:58:45.523404 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m04:58:45.525201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e451f130>]}
[0m04:58:45.526670 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.41s]
[0m04:58:45.528451 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m04:58:45.531675 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:58:45.533202 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.535921 [debug] [MainThread]: On master: BEGIN
[0m04:58:45.537488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:58:45.546347 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:58:45.548702 [debug] [MainThread]: On master: COMMIT
[0m04:58:45.550962 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.552931 [debug] [MainThread]: On master: COMMIT
[0m04:58:45.554888 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:58:45.557612 [debug] [MainThread]: On master: Close
[0m04:58:45.560486 [info ] [MainThread]: 
[0m04:58:45.563055 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m04:58:45.566032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:45.568691 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m04:58:45.632467 [info ] [MainThread]: 
[0m04:58:45.634549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:58:45.636224 [info ] [MainThread]: 
[0m04:58:45.637675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:58:45.639462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e5367970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e46d4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e451ffa0>]}
[0m04:58:45.641099 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:14.820753 | 7910ad99-ebc9-4df1-96f2-79d8a31886e5 ==============================
[0m04:59:14.820826 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:14.825143 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:59:14.828073 [debug] [MainThread]: Tracking: tracking
[0m04:59:14.854379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcfccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcfcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcfcb50>]}
[0m04:59:15.217619 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:59:15.220664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcfc8b0>]}
[0m04:59:15.478209 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:59:15.483330 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:59:15.535042 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:59:15.541246 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:59:15.546486 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:59:15.551492 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:59:15.555569 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:59:15.557506 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:59:15.561066 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:59:15.564191 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:59:15.567424 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:59:15.582746 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:59:15.586329 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:59:15.591495 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:59:15.599058 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:59:15.603799 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:59:15.607699 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:59:15.611347 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:59:15.615784 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:59:15.618543 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:59:15.621387 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:59:15.635986 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:59:15.648736 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:59:15.666217 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:59:15.669476 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:59:15.676210 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:59:15.683059 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:59:15.686424 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:59:15.689258 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:59:15.692563 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:59:15.699324 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:59:15.703363 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:59:15.708605 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:59:15.722638 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:59:15.727230 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:59:15.731791 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:59:15.735367 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:59:15.738659 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:59:15.743206 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:59:15.747502 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:59:15.755789 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:59:15.759484 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:59:15.765191 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:59:15.769185 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:59:15.773355 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:59:15.777399 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:59:15.781769 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:59:15.785558 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:59:15.808374 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:59:15.848410 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:59:15.857310 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:59:15.867862 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:59:15.899592 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:59:15.905887 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:59:15.923187 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:59:15.938192 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:59:15.948398 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:59:15.956580 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:59:15.975159 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:59:15.989867 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:59:16.006623 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:59:16.048028 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:59:16.068586 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:59:16.121770 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:59:16.127094 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:59:16.171191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:59:16.209055 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:59:16.214721 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:59:16.221466 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:59:16.228719 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:59:16.276569 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:59:16.313449 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:59:16.366037 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:59:16.536675 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:59:16.563347 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:59:16.575028 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:59:16.590384 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:59:16.606451 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:59:16.677506 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:59:16.706706 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:59:16.723272 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:59:16.742228 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:59:16.762003 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:59:16.769243 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:59:16.785827 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:59:16.824537 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:59:16.856251 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:59:16.864448 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:59:16.876683 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:59:16.930820 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:59:16.953522 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:59:16.967686 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:59:16.987819 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:59:16.993385 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:59:17.011174 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:59:17.022439 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:59:17.026812 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:59:17.031951 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:59:17.036068 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:59:17.051488 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:59:17.057194 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:59:17.079165 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:59:17.096773 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:59:17.103037 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:59:17.108264 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:59:17.116488 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:59:17.120331 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:59:17.222515 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:59:17.235788 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:59:17.246668 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:59:17.261578 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:59:17.268673 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:59:17.289517 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:59:17.295561 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:59:17.302575 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:59:17.328737 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:59:17.336099 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:59:17.340300 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:59:17.349459 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:59:17.355540 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:59:17.362431 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:59:17.372892 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:59:17.384967 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:59:17.410723 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:59:17.424733 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:59:17.439116 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:59:17.453110 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:59:17.466479 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:59:17.472490 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:59:17.482710 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:59:17.490862 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:59:17.505052 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:59:17.509285 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:59:17.515756 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:59:17.538967 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:59:17.543167 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:59:17.549174 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:59:17.560525 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:59:17.566806 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:59:17.575340 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:59:17.584346 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:59:17.604393 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:59:17.626769 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:59:17.659659 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:59:17.663456 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:59:19.280457 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:59:19.341535 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:59:19.350872 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:59:19.376509 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:59:19.404888 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:59:19.410809 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:59:19.468105 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:59:19.860651 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:59:20.025478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7b2340d0>]}
[0m04:59:20.031177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcbdb20>]}
[0m04:59:20.033613 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:20.036098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7d4d1d30>]}
[0m04:59:20.040335 [info ] [MainThread]: 
[0m04:59:20.042649 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:20.045636 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:59:20.059017 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:59:20.061107 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:59:20.062818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:20.074573 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:59:20.079931 [debug] [ThreadPool]: On list_*****: Close
[0m04:59:20.096652 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:59:20.111121 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:20.113953 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:59:20.115813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:20.126174 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:59:20.128395 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:20.130059 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:59:20.137712 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.01 seconds
[0m04:59:20.148191 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:59:20.151106 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:59:20.168506 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:20.171945 [debug] [MainThread]: On master: BEGIN
[0m04:59:20.173881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:20.181423 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:20.183508 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:20.185438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:20.203339 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m04:59:20.211419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7b22ea60>]}
[0m04:59:20.214894 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:20.217254 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:20.219288 [debug] [MainThread]: On master: BEGIN
[0m04:59:20.221244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:20.223109 [debug] [MainThread]: On master: COMMIT
[0m04:59:20.224702 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:20.226262 [debug] [MainThread]: On master: COMMIT
[0m04:59:20.228201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:20.230100 [debug] [MainThread]: On master: Close
[0m04:59:20.237144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:20.239302 [info ] [MainThread]: 
[0m04:59:20.267126 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m04:59:20.270139 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m04:59:20.273826 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m04:59:20.276619 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m04:59:20.278762 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m04:59:20.366889 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:20.370186 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m04:59:20.372550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:59:20.436644 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
[0m04:59:20.455763 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:20.461658 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m04:59:20.548410 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.08 seconds
[0m04:59:20.644866 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m04:59:20.776260 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:20.790618 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m04:59:21.306406 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m04:59:21.358788 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.366150 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m04:59:21.422415 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.05 seconds
[0m04:59:21.492184 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.495598 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months" rename to "util_months__dbt_backup"
[0m04:59:21.505894 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m04:59:21.528715 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.535562 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m04:59:21.542364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:21.723463 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m04:59:21.726741 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.730297 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m04:59:21.734873 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:59:21.777455 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.788982 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m04:59:21.799684 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
[0m04:59:21.820348 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:21.824569 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m04:59:21.833236 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7a1770a0>]}
[0m04:59:21.846577 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 1.56s]
[0m04:59:21.862620 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m04:59:21.872966 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:21.875002 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:21.876686 [debug] [MainThread]: On master: BEGIN
[0m04:59:21.879894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:21.889390 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:21.891342 [debug] [MainThread]: On master: COMMIT
[0m04:59:21.893136 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:21.894330 [debug] [MainThread]: On master: COMMIT
[0m04:59:21.897824 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:21.900410 [debug] [MainThread]: On master: Close
[0m04:59:21.905095 [info ] [MainThread]: 
[0m04:59:21.907998 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m04:59:21.915201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:21.917439 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m04:59:21.919799 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m04:59:21.923740 [info ] [MainThread]: 
[0m04:59:21.927639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:21.929845 [info ] [MainThread]: 
[0m04:59:21.932313 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:59:21.937448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcc87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7a1403d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7a1407c0>]}
[0m04:59:21.939873 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:29.224068 | 55ea2cfd-f009-4e15-8304-bc8dd7693577 ==============================
[0m04:59:29.224101 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:29.226369 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m04:59:29.228242 [debug] [MainThread]: Tracking: tracking
[0m04:59:29.250882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653d44d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653d44ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653d44b20>]}
[0m04:59:30.137891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:30.143220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:30.171918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ea2cfd-f009-4e15-8304-bc8dd7693577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653ab20d0>]}
[0m04:59:30.179054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ea2cfd-f009-4e15-8304-bc8dd7693577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0610>]}
[0m04:59:30.181939 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:30.184697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ea2cfd-f009-4e15-8304-bc8dd7693577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0850>]}
[0m04:59:30.192768 [info ] [MainThread]: 
[0m04:59:30.196102 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:59:30.199296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0490>]}
[0m04:59:30.201954 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:37.416772 | 389f3072-47a1-462f-9489-fe6e8eb9a4f6 ==============================
[0m04:59:37.416804 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:37.418448 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:59:37.424083 [debug] [MainThread]: Tracking: tracking
[0m04:59:37.536842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fd43c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fd43070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fd43b20>]}
[0m04:59:37.902616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:37.904604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:37.921146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fab10d0>]}
[0m04:59:37.972098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fbe7670>]}
[0m04:59:37.985544 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:37.993145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fbe78b0>]}
[0m04:59:38.008820 [info ] [MainThread]: 
[0m04:59:38.013990 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:38.021793 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:59:38.078026 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:59:38.080158 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:59:38.081839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:38.101587 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m04:59:38.107196 [debug] [ThreadPool]: On list_*****: Close
[0m04:59:38.112425 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:59:38.127195 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:38.129996 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:59:38.131449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:59:38.139810 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:59:38.143722 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:38.148434 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:59:38.160024 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.01 seconds
[0m04:59:38.166472 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:59:38.169838 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:59:38.199458 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.202791 [debug] [MainThread]: On master: BEGIN
[0m04:59:38.206124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:38.217306 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:38.219669 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.222570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:38.243991 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m04:59:38.247601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fd411c0>]}
[0m04:59:38.249606 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:38.253790 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.255339 [debug] [MainThread]: On master: BEGIN
[0m04:59:38.258445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:38.260021 [debug] [MainThread]: On master: COMMIT
[0m04:59:38.261830 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.263314 [debug] [MainThread]: On master: COMMIT
[0m04:59:38.265098 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:38.266571 [debug] [MainThread]: On master: Close
[0m04:59:38.269340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:38.271263 [info ] [MainThread]: 
[0m04:59:38.300169 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m04:59:38.302189 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m04:59:38.305465 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.307726 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m04:59:38.309994 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m04:59:38.320934 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m04:59:38.329949 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:38.332032 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m04:59:38.451115 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m04:59:38.468842 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.470098 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m04:59:38.471663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:59:38.480725 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:59:38.484523 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.485659 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m04:59:38.497940 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:59:38.522813 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.524975 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m04:59:38.527547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:38.559353 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m04:59:38.560901 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.562175 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m04:59:38.564069 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:59:38.576931 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.578458 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m04:59:38.582964 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:59:38.585610 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:38.587101 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m04:59:38.590174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5f277ca0>]}
[0m04:59:38.592014 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.29s]
[0m04:59:38.595818 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m04:59:38.601616 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:38.603387 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.604736 [debug] [MainThread]: On master: BEGIN
[0m04:59:38.605928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:38.612998 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:38.614479 [debug] [MainThread]: On master: COMMIT
[0m04:59:38.615661 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.616749 [debug] [MainThread]: On master: COMMIT
[0m04:59:38.618008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:38.619211 [debug] [MainThread]: On master: Close
[0m04:59:38.620771 [info ] [MainThread]: 
[0m04:59:38.621999 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m04:59:38.623165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:38.625394 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m04:59:38.626415 [info ] [MainThread]: 
[0m04:59:38.627460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:38.628616 [info ] [MainThread]: 
[0m04:59:38.629686 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:59:38.630781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5f27ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5f27a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5f27a790>]}
[0m04:59:38.631834 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:44.586686 | 100cf817-adbb-4508-a506-3149767ec408 ==============================
[0m04:59:44.586733 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:44.588727 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m04:59:44.591054 [debug] [MainThread]: Tracking: tracking
[0m04:59:44.604901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91e23cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91e23af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91e23b50>]}
[0m04:59:44.886248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:44.888152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:44.907943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100cf817-adbb-4508-a506-3149767ec408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91b980d0>]}
[0m04:59:44.915359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100cf817-adbb-4508-a506-3149767ec408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91cd0640>]}
[0m04:59:44.917409 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:44.918993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100cf817-adbb-4508-a506-3149767ec408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91cd0880>]}
[0m04:59:44.923392 [info ] [MainThread]: 
[0m04:59:44.925736 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:44.932354 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:59:44.962404 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:44.964105 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:59:44.965443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:44.973566 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:59:44.974770 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:44.976035 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:59:44.984545 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.01 seconds
[0m04:59:44.990042 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:59:44.992059 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:59:45.017310 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.019442 [debug] [MainThread]: On master: BEGIN
[0m04:59:45.020941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:45.028134 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:45.029585 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.031330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:45.044967 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m04:59:45.049215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100cf817-adbb-4508-a506-3149767ec408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91cd03d0>]}
[0m04:59:45.051934 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:45.054039 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.055352 [debug] [MainThread]: On master: BEGIN
[0m04:59:45.057215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:45.058459 [debug] [MainThread]: On master: COMMIT
[0m04:59:45.059771 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.061139 [debug] [MainThread]: On master: COMMIT
[0m04:59:45.062339 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:45.063301 [debug] [MainThread]: On master: Close
[0m04:59:45.065397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:45.066780 [info ] [MainThread]: 
[0m04:59:45.088562 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.090079 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m04:59:45.092926 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.094874 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.097047 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.129563 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.137385 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:45.138949 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.173159 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.178628 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.180049 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m04:59:45.181307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:59:45.189924 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:59:45.191080 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.192583 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m04:59:45.206217 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:59:45.210730 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:45.212139 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m04:59:45.213690 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m04:59:45.215871 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.12s]
[0m04:59:45.217964 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.221765 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:45.223046 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.224440 [debug] [MainThread]: On master: BEGIN
[0m04:59:45.226057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:45.231958 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:45.233229 [debug] [MainThread]: On master: COMMIT
[0m04:59:45.234781 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.236303 [debug] [MainThread]: On master: COMMIT
[0m04:59:45.237775 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:45.238983 [debug] [MainThread]: On master: Close
[0m04:59:45.240824 [info ] [MainThread]: 
[0m04:59:45.242695 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m04:59:45.244720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:45.247013 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m04:59:45.248982 [info ] [MainThread]: 
[0m04:59:45.251581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:45.253350 [info ] [MainThread]: 
[0m04:59:45.255340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:59:45.258200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91368610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc913689a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91368a60>]}
[0m04:59:45.259982 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:50.530188 | ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616 ==============================
[0m04:59:50.530220 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:50.531836 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:59:50.534226 [debug] [MainThread]: Tracking: tracking
[0m04:59:50.542942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c9833c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c9833070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c9833b20>]}
[0m04:59:50.718076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:50.719339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:50.728158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c95a00d0>]}
[0m04:59:50.731186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c96b8670>]}
[0m04:59:50.732366 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:50.733697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c96b88b0>]}
[0m04:59:50.736294 [info ] [MainThread]: 
[0m04:59:50.738122 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:50.740234 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:59:50.758621 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:59:50.760492 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:59:50.761865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:50.768160 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:59:50.770713 [debug] [ThreadPool]: On list_*****: Close
[0m04:59:50.773332 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:59:50.782494 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:50.783848 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:59:50.785102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:50.790606 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:59:50.792121 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:50.793384 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:59:50.797354 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m04:59:50.800882 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:59:50.802272 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:59:50.810564 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:50.812107 [debug] [MainThread]: On master: BEGIN
[0m04:59:50.813336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:50.818015 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:50.819127 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:50.820277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:50.829615 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m04:59:50.832342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c98319a0>]}
[0m04:59:50.833777 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:50.835196 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:50.836385 [debug] [MainThread]: On master: BEGIN
[0m04:59:50.837958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:50.839119 [debug] [MainThread]: On master: COMMIT
[0m04:59:50.840177 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:50.841291 [debug] [MainThread]: On master: COMMIT
[0m04:59:50.842587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:50.843650 [debug] [MainThread]: On master: Close
[0m04:59:50.845415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:50.846938 [info ] [MainThread]: 
[0m04:59:50.865449 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m04:59:50.867508 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m04:59:50.870409 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m04:59:50.871401 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m04:59:50.872398 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m04:59:50.877614 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m04:59:50.883482 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:50.884881 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m04:59:50.944119 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m04:59:50.950666 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:50.952971 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m04:59:50.955022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:59:50.961241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:59:50.964356 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:50.966934 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m04:59:50.972886 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:59:50.984482 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:50.986249 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m04:59:50.988934 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:51.016778 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m04:59:51.018446 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:51.019828 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m04:59:51.021830 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:59:51.029849 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:51.031097 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m04:59:51.032726 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:59:51.035593 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:51.037196 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m04:59:51.039044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c8d79e50>]}
[0m04:59:51.040663 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.17s]
[0m04:59:51.042481 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m04:59:51.045745 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:51.047239 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:51.048667 [debug] [MainThread]: On master: BEGIN
[0m04:59:51.050070 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:51.056213 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:51.057746 [debug] [MainThread]: On master: COMMIT
[0m04:59:51.058783 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:51.060085 [debug] [MainThread]: On master: COMMIT
[0m04:59:51.061463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:51.062569 [debug] [MainThread]: On master: Close
[0m04:59:51.064310 [info ] [MainThread]: 
[0m04:59:51.065568 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m04:59:51.066736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:51.067919 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m04:59:51.068837 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m04:59:51.070009 [info ] [MainThread]: 
[0m04:59:51.071130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:51.072288 [info ] [MainThread]: 
[0m04:59:51.073396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:59:51.076771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c96b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c95ad2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c95ad0d0>]}
[0m04:59:51.079279 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 05:00:01.330581 | 90649a2c-0ab0-4320-89cb-2c6009f71cff ==============================
[0m05:00:01.330661 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:00:01.333721 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m05:00:01.337064 [debug] [MainThread]: Tracking: tracking
[0m05:00:01.372629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3253b9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3253b9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3253b9b50>]}
[0m05:00:02.280459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:02.286205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:02.349477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90649a2c-0ab0-4320-89cb-2c6009f71cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3251300d0>]}
[0m05:00:02.358068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90649a2c-0ab0-4320-89cb-2c6009f71cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32525d640>]}
[0m05:00:02.360766 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m05:00:02.363003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90649a2c-0ab0-4320-89cb-2c6009f71cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32525d880>]}
[0m05:00:02.369140 [info ] [MainThread]: 
[0m05:00:02.372087 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:02.379476 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m05:00:02.463324 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:02.465450 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m05:00:02.467319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:02.542264 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m05:00:02.544933 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:02.546450 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:00:02.555264 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.01 seconds
[0m05:00:02.561586 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m05:00:02.589785 [debug] [ThreadPool]: On list_*****_public: Close
[0m05:00:02.614630 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:02.664668 [debug] [MainThread]: On master: BEGIN
[0m05:00:02.671695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:02.681132 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:02.685733 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:02.690748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:02.745934 [debug] [MainThread]: SQL status: SELECT 6 in 0.05 seconds
[0m05:00:02.752658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90649a2c-0ab0-4320-89cb-2c6009f71cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32525d490>]}
[0m05:00:02.756331 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:02.758978 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:02.761392 [debug] [MainThread]: On master: BEGIN
[0m05:00:02.764072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:00:02.765894 [debug] [MainThread]: On master: COMMIT
[0m05:00:02.768092 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:02.770044 [debug] [MainThread]: On master: COMMIT
[0m05:00:02.773813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:02.777056 [debug] [MainThread]: On master: Close
[0m05:00:02.779935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:00:02.781813 [info ] [MainThread]: 
[0m05:00:03.069134 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.071001 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m05:00:03.077392 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.080035 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.082232 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.159450 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.170790 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:03.173254 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.265071 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.272219 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.279032 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m05:00:03.296927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:03.311626 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:03.313555 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.315094 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m05:00:03.333056 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:03.342021 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:03.358373 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m05:00:03.361105 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m05:00:03.366662 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.29s]
[0m05:00:03.369391 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.371296 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.373102 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m05:00:03.381031 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.382727 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.384165 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.418067 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.427663 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:03.429387 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.441215 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.480017 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.483077 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m05:00:03.487679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:03.497842 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:03.499737 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.501142 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:00:03.515417 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:03.521610 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:03.523779 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m05:00:03.539397 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m05:00:03.542281 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.16s]
[0m05:00:03.546282 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.551702 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:03.554424 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:03.556913 [debug] [MainThread]: On master: BEGIN
[0m05:00:03.558525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:00:03.567620 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:03.569313 [debug] [MainThread]: On master: COMMIT
[0m05:00:03.570711 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:03.572630 [debug] [MainThread]: On master: COMMIT
[0m05:00:03.575078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:03.578581 [debug] [MainThread]: On master: Close
[0m05:00:03.582558 [info ] [MainThread]: 
[0m05:00:03.586215 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m05:00:03.600472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:00:03.603305 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m05:00:03.607374 [info ] [MainThread]: 
[0m05:00:03.611848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:00:03.616050 [info ] [MainThread]: 
[0m05:00:03.620204 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:00:03.625164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3248f9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3248f9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3248f9400>]}
[0m05:00:03.631582 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 05:00:13.486504 | f3bf3649-eb7e-4c4b-a415-b87bc6e73bce ==============================
[0m05:00:13.486545 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:00:13.488448 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:00:13.490281 [debug] [MainThread]: Tracking: tracking
[0m05:00:13.497723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181324610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181324ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181324b20>]}
[0m05:00:13.799258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:13.801618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:13.816306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518108bfd0>]}
[0m05:00:13.820527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51811c15e0>]}
[0m05:00:13.822500 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m05:00:13.825084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51811c1820>]}
[0m05:00:13.828537 [info ] [MainThread]: 
[0m05:00:13.830951 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:13.849557 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m05:00:13.868654 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m05:00:13.870489 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m05:00:13.872120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:13.881882 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m05:00:13.884891 [debug] [ThreadPool]: On list_*****: Close
[0m05:00:13.888835 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m05:00:13.899017 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:13.900931 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m05:00:13.902371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:13.908869 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:00:13.910680 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:13.912069 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:00:13.917106 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m05:00:13.921031 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m05:00:13.922587 [debug] [ThreadPool]: On list_*****_public: Close
[0m05:00:13.932581 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:13.934000 [debug] [MainThread]: On master: BEGIN
[0m05:00:13.935895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:13.942754 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:13.944963 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:13.946297 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:13.960136 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m05:00:13.963293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51812ea490>]}
[0m05:00:13.964653 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:13.966037 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:13.977021 [debug] [MainThread]: On master: BEGIN
[0m05:00:13.979096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:00:13.980314 [debug] [MainThread]: On master: COMMIT
[0m05:00:13.985667 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:13.987515 [debug] [MainThread]: On master: COMMIT
[0m05:00:13.989027 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:13.990187 [debug] [MainThread]: On master: Close
[0m05:00:13.991652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:00:13.993376 [info ] [MainThread]: 
[0m05:00:14.014667 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m05:00:14.016729 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m05:00:14.018866 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m05:00:14.020210 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m05:00:14.021378 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m05:00:14.038561 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m05:00:14.051347 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m05:00:14.076219 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:14.078343 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m05:00:14.141217 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m05:00:14.148949 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.150672 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m05:00:14.155019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:14.161357 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:14.162749 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.163823 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m05:00:14.175396 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m05:00:14.193057 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.194796 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m05:00:14.197537 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:00:14.219982 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m05:00:14.221973 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.223492 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m05:00:14.228215 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m05:00:14.238631 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.240175 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m05:00:14.248617 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m05:00:14.251601 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:14.253217 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m05:00:14.257939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51807f9820>]}
[0m05:00:14.260610 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.24s]
[0m05:00:14.263309 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m05:00:14.268734 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:14.270666 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:14.272139 [debug] [MainThread]: On master: BEGIN
[0m05:00:14.273435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:00:14.280051 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:14.282065 [debug] [MainThread]: On master: COMMIT
[0m05:00:14.284180 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:14.285757 [debug] [MainThread]: On master: COMMIT
[0m05:00:14.289422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:14.291156 [debug] [MainThread]: On master: Close
[0m05:00:14.294094 [info ] [MainThread]: 
[0m05:00:14.296445 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m05:00:14.298280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:00:14.300449 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m05:00:14.302591 [info ] [MainThread]: 
[0m05:00:14.304120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:00:14.305683 [info ] [MainThread]: 
[0m05:00:14.307776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:00:14.310241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51810970d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51810972e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181097460>]}
[0m05:00:14.311791 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 05:00:20.554537 | 9f8d1d39-aedf-4c26-9cfe-a5c738e457dc ==============================
[0m05:00:20.554565 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:00:20.556378 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m05:00:20.558143 [debug] [MainThread]: Tracking: tracking
[0m05:00:20.566613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5904d1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5904d1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5904d1b50>]}
[0m05:00:20.897926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:20.899447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:20.910197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f8d1d39-aedf-4c26-9cfe-a5c738e457dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59023e0d0>]}
[0m05:00:20.913423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f8d1d39-aedf-4c26-9cfe-a5c738e457dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa590376640>]}
[0m05:00:20.914981 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m05:00:20.916151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f8d1d39-aedf-4c26-9cfe-a5c738e457dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa590376880>]}
[0m05:00:20.920617 [info ] [MainThread]: 
[0m05:00:20.922763 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:20.925714 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m05:00:20.944628 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:20.946712 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m05:00:20.948113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:20.962563 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:00:20.964566 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:20.966380 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:00:20.970961 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m05:00:20.974409 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m05:00:20.975921 [debug] [ThreadPool]: On list_*****_public: Close
[0m05:00:20.985374 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:20.986975 [debug] [MainThread]: On master: BEGIN
[0m05:00:20.988294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:20.993360 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:20.994798 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:20.996124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:21.005425 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m05:00:21.008273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f8d1d39-aedf-4c26-9cfe-a5c738e457dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa590376490>]}
[0m05:00:21.010399 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:21.012100 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:21.045673 [debug] [MainThread]: On master: BEGIN
[0m05:00:21.048371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:00:21.050173 [debug] [MainThread]: On master: COMMIT
[0m05:00:21.051653 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:21.052955 [debug] [MainThread]: On master: COMMIT
[0m05:00:21.054501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:21.055714 [debug] [MainThread]: On master: Close
[0m05:00:21.061381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:00:21.062740 [info ] [MainThread]: 
[0m05:00:21.080387 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.083224 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m05:00:21.093863 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.095310 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.096979 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.113523 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.232243 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.233894 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.261368 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.277862 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.279272 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m05:00:21.280435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.287117 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.288786 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.290165 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m05:00:21.308061 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:21.311723 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.312852 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m05:00:21.314434 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m05:00:21.316433 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.22s]
[0m05:00:21.318272 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.319638 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.320702 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m05:00:21.322250 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.323693 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.325048 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.340386 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.345757 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.347308 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.351585 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.356971 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.358524 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m05:00:21.359795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.365465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.366768 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.367846 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:00:21.383128 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.386411 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.388607 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m05:00:21.391174 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m05:00:21.396010 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.07s]
[0m05:00:21.398648 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.400676 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.402416 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m05:00:21.404488 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.405734 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.407131 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.417961 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.430842 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.433156 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.444801 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.452515 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.453819 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m05:00:21.455700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.461117 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.462714 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.464433 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m05:00:21.474222 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.477457 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.478894 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m05:00:21.480481 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m05:00:21.482183 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.08s]
[0m05:00:21.483700 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.485334 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.487435 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m05:00:21.489629 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.492544 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.495231 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.502326 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.509243 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.512474 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.519270 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.528890 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.530459 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m05:00:21.531362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.538398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.539935 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.541251 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m05:00:21.560598 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:21.563487 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.564647 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m05:00:21.566093 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m05:00:21.567420 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.08s]
[0m05:00:21.569239 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.570975 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.572257 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m05:00:21.573980 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.575293 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.576552 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.583962 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.590568 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.595594 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.602230 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.609151 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.610396 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m05:00:21.611405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.615958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:00:21.617199 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.618550 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m05:00:21.631926 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.634808 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.636015 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m05:00:21.637166 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m05:00:21.638646 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.07s]
[0m05:00:21.640603 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.642028 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.643384 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m05:00:21.645007 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.646018 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.647029 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.652780 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.657428 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.659471 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.663962 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.679215 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.680386 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m05:00:21.681585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.687581 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.688861 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.689891 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m05:00:21.704219 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.708713 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.710933 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m05:00:21.713099 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m05:00:21.714830 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.07s]
[0m05:00:21.717342 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.718785 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.720374 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m05:00:21.722281 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.723295 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.724198 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.731111 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.736176 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.737591 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.741703 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.747347 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.748545 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m05:00:21.749847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.755532 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.756678 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.757705 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m05:00:21.768776 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.772959 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.774902 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m05:00:21.776743 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m05:00:21.778616 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.06s]
[0m05:00:21.780307 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.781704 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.782916 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m05:00:21.784356 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.791300 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.793184 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.800908 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.806570 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.807922 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.813436 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.828947 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.830450 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m05:00:21.831794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.837109 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.838291 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.839231 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m05:00:21.850880 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.854030 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.859135 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m05:00:21.861114 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m05:00:21.863195 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.08s]
[0m05:00:21.865443 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.866969 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.868440 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m05:00:21.870588 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.871730 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.878924 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.887955 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.891531 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.892777 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.896408 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.902689 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.906271 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m05:00:21.907847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.921536 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.923625 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.924995 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m05:00:21.937015 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.939953 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.941321 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m05:00:21.942424 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m05:00:21.944778 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.07s]
[0m05:00:21.946520 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.948313 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:21.949754 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m05:00:21.952218 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.954167 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:21.955739 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:21.964925 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.978659 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.980327 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:21.984836 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.989264 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.990354 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m05:00:21.991314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.995753 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:00:21.996918 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.997944 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m05:00:22.010580 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:22.013794 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.014999 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m05:00:22.016385 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m05:00:22.018263 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.07s]
[0m05:00:22.019568 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:22.020768 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.021850 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m05:00:22.023523 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.024507 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.025469 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.034680 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.044991 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.046437 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.050131 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.055866 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.057305 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m05:00:22.058869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.064176 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.065206 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.066088 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m05:00:22.077329 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:22.080052 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.081210 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m05:00:22.082720 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m05:00:22.084595 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.06s]
[0m05:00:22.086076 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.087187 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.088465 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m05:00:22.090099 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.091230 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.092141 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.097870 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.102566 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.104231 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.109363 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.128294 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.129713 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m05:00:22.130606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.135106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:00:22.136161 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.137073 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m05:00:22.156561 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:22.160227 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.161668 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m05:00:22.163580 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m05:00:22.165466 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.08s]
[0m05:00:22.168037 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.171148 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.173382 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m05:00:22.180310 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.183193 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.187652 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.199277 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.205092 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.207076 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.213451 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.228455 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.229868 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m05:00:22.232503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.239067 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.240782 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.241966 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m05:00:22.257695 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:22.260535 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.262211 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m05:00:22.268269 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m05:00:22.270917 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.09s]
[0m05:00:22.273138 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.274723 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.276103 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m05:00:22.278542 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.280221 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.281607 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.292616 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.298625 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.300607 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.307671 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.328449 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.329750 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m05:00:22.330680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.336289 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.337728 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.339429 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m05:00:22.355100 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:22.358891 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.361039 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m05:00:22.362700 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m05:00:22.364565 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.09s]
[0m05:00:22.366291 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.368008 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.379032 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m05:00:22.381043 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.382187 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.383411 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.394621 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.402693 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.404343 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.409393 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.428573 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.429794 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m05:00:22.430978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.438512 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.440726 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.442249 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:00:22.459104 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:22.462582 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.464258 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m05:00:22.466281 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m05:00:22.468770 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.09s]
[0m05:00:22.471451 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.475096 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:22.476542 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:22.477779 [debug] [MainThread]: On master: BEGIN
[0m05:00:22.479039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:00:22.485869 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.488517 [debug] [MainThread]: On master: COMMIT
[0m05:00:22.490348 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:22.530127 [debug] [MainThread]: On master: COMMIT
[0m05:00:22.535156 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:22.537199 [debug] [MainThread]: On master: Close
[0m05:00:22.539688 [info ] [MainThread]: 
[0m05:00:22.541334 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m05:00:22.542925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:00:22.546138 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m05:00:22.548117 [info ] [MainThread]: 
[0m05:00:22.550779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:00:22.554298 [info ] [MainThread]: 
[0m05:00:22.556796 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m05:00:22.559503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58f99f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58f99f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58f99f850>]}
[0m05:00:22.561238 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:33:39.345893 | 130f45a0-71a5-4489-b4c4-901b79878c19 ==============================
[0m18:33:39.345910 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:33:39.348324 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m18:33:39.350602 [debug] [MainThread]: Tracking: tracking
[0m18:33:39.361388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0f3cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0f3cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0f3cbe0>]}
[0m18:33:39.369313 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-is7nl75j'
[0m18:33:39.371256 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:33:39.809970 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:33:39.813648 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:33:40.033033 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:33:40.159209 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:33:44.741587 [info ] [MainThread]:   Installed from version 0.8.0
[0m18:33:44.743567 [info ] [MainThread]:   Updated version available: 0.9.6
[0m18:33:44.748879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '130f45a0-71a5-4489-b4c4-901b79878c19', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0eed1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0f3cd90>]}
[0m18:33:44.750841 [info ] [MainThread]: 
[0m18:33:44.752808 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m18:33:44.756429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0fd8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0fd86a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0ee7610>]}
[0m18:33:44.758945 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:33:48.769353 | 77e9b508-005f-4de5-81f6-57fe81662f70 ==============================
[0m18:33:48.769387 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:33:48.770568 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:33:48.772097 [debug] [MainThread]: Tracking: tracking
[0m18:33:48.780100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093e6cb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093e6cb430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093e6cb490>]}
[0m18:33:48.879951 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m18:33:48.884160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77e9b508-005f-4de5-81f6-57fe81662f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093e6f25b0>]}
[0m18:33:49.268651 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m18:33:49.271706 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:33:49.314288 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:33:49.320688 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:33:49.324538 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m18:33:49.328069 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:33:49.331158 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:33:49.332812 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:33:49.335648 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:33:49.337517 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:33:49.339726 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:33:49.352787 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m18:33:49.356123 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:33:49.359308 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:33:49.363855 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:33:49.366841 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:33:49.369630 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:33:49.371738 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:33:49.374505 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:33:49.376436 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:33:49.378302 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:33:49.388280 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:33:49.397734 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:33:49.412429 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:33:49.416084 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:33:49.418280 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:33:49.422386 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:33:49.424843 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:33:49.426938 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:33:49.429423 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:33:49.433001 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:33:49.435655 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:33:49.439208 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:33:49.451275 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:33:49.455294 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:33:49.458303 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:33:49.462823 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:33:49.465601 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:33:49.468628 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:33:49.471253 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:33:49.476741 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:33:49.484597 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:33:49.489815 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:33:49.495351 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:33:49.499307 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:33:49.503076 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:33:49.506531 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:33:49.509993 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:33:49.533444 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:33:49.570850 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:33:49.575756 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:33:49.582753 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:33:49.606953 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:33:49.611946 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:33:49.624448 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:33:49.632321 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:33:49.638558 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:33:49.642941 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:33:49.649578 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:33:49.655389 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:33:49.664909 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:33:49.678529 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:33:49.689234 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:33:49.719687 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:33:49.723418 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:33:49.750619 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:33:49.768315 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:33:49.771716 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:33:49.777054 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:33:49.784565 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:33:49.796025 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:33:49.822174 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:33:49.851648 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:33:49.876167 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:33:49.882242 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:33:49.886461 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:33:49.891147 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:33:49.900551 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:33:49.938968 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:33:49.953254 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:33:49.959642 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m18:33:49.964548 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m18:33:49.967567 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m18:33:49.971360 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m18:33:49.974173 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m18:33:49.981427 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m18:33:49.991878 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m18:33:49.996719 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m18:33:50.003166 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m18:33:50.025239 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m18:33:50.028921 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m18:33:50.032703 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m18:33:50.036730 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m18:33:50.039365 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m18:33:50.046413 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m18:33:50.050707 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m18:33:50.053541 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m18:33:50.057436 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m18:33:50.060569 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m18:33:50.066135 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m18:33:50.070408 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m18:33:50.074742 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m18:33:50.086146 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:33:50.089867 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:33:50.092933 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:33:50.096354 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:33:50.099989 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m18:33:50.149595 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m18:33:50.159087 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m18:33:50.163536 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m18:33:50.169699 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m18:33:50.173977 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m18:33:50.181241 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m18:33:50.185227 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m18:33:50.190121 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m18:33:50.213992 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m18:33:50.219969 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m18:33:50.223531 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m18:33:50.228208 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m18:33:50.232412 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m18:33:50.237321 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m18:33:50.242584 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m18:33:50.246809 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m18:33:50.250385 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m18:33:50.256555 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:33:50.266103 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:33:50.275851 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:33:50.287617 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:33:50.292567 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:33:50.298837 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:33:50.304638 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:33:50.318058 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:33:50.322336 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:33:50.325740 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:33:50.337802 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:33:50.341577 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:33:50.347333 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:33:50.357484 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:33:50.362943 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:33:50.371496 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:33:50.379594 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:33:50.401637 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:33:50.425246 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:33:50.430125 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:33:50.433829 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:33:51.271888 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m18:33:51.293418 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m18:33:51.301762 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m18:33:51.323542 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m18:33:51.340771 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m18:33:51.345210 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m18:33:51.389076 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m18:33:51.614321 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m18:33:51.883350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77e9b508-005f-4de5-81f6-57fe81662f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093e608280>]}
[0m18:33:51.919715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77e9b508-005f-4de5-81f6-57fe81662f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09439d73a0>]}
[0m18:33:51.921916 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:33:51.923226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77e9b508-005f-4de5-81f6-57fe81662f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093db2e250>]}
[0m18:33:51.925968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093e6080d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093e5e8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093e5e8730>]}
[0m18:33:51.927989 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:34:28.012000 | 673206a7-dc4b-4736-a1cb-0e1553e07eee ==============================
[0m18:34:28.012027 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:34:28.013674 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m18:34:28.015888 [debug] [MainThread]: Tracking: tracking
[0m18:34:28.043406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bca606bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bca606b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bca606b80>]}
[0m18:34:28.180128 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m18:34:28.183440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '673206a7-dc4b-4736-a1cb-0e1553e07eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bca5c8fd0>]}
[0m18:34:28.363796 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m18:34:28.367797 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:34:28.419412 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:34:28.425977 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:34:28.430194 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m18:34:28.435035 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:34:28.439471 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:34:28.442335 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:34:28.446124 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:34:28.448511 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:34:28.452294 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:34:28.468816 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m18:34:28.475519 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:34:28.485893 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:34:28.502013 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:34:28.506730 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:34:28.511153 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:34:28.514090 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:34:28.518329 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:34:28.521917 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:34:28.524992 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:34:28.539236 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:34:28.551113 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:34:28.571732 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:34:28.574780 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:34:28.578542 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:34:28.584179 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:34:28.587948 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:34:28.592837 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:34:28.596939 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:34:28.603014 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:34:28.607457 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:34:28.613128 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:34:28.626890 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:34:28.631612 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:34:28.635309 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:34:28.639012 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:34:28.641521 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:34:28.644897 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:34:28.650904 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:34:28.655439 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:34:28.659829 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:34:28.665720 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:34:28.668966 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:34:28.672080 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:34:28.675344 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:34:28.678176 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:34:28.681053 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:34:28.704288 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:34:28.738274 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:34:28.744277 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:34:28.751328 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:34:28.777633 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:34:28.783914 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:34:28.801466 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:34:28.813696 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:34:28.824183 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:34:28.831821 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:34:28.846310 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:34:28.857473 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:34:28.869801 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:34:28.889438 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:34:28.904535 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:34:28.967876 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:34:28.975727 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:34:29.024170 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:34:29.065212 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:34:29.069719 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:34:29.076462 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:34:29.086975 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:34:29.111976 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:34:29.159203 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:34:29.226126 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:34:29.257173 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:34:29.262949 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:34:29.269487 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:34:29.275453 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:34:29.288136 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:34:29.341626 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:34:29.356552 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:34:29.365899 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m18:34:29.372174 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m18:34:29.375393 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m18:34:29.380030 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m18:34:29.383117 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m18:34:29.390819 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m18:34:29.401167 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m18:34:29.406089 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m18:34:29.413440 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m18:34:29.436854 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m18:34:29.441835 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m18:34:29.446775 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m18:34:29.450983 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m18:34:29.453833 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m18:34:29.460817 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m18:34:29.465119 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m18:34:29.467625 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m18:34:29.474602 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m18:34:29.478341 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m18:34:29.485990 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m18:34:29.493293 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m18:34:29.499683 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m18:34:29.523441 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:34:29.527495 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:34:29.532414 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:34:29.535579 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:34:29.539733 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m18:34:29.585000 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m18:34:29.590999 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m18:34:29.594122 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m18:34:29.598497 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m18:34:29.601924 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m18:34:29.609141 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m18:34:29.613123 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m18:34:29.616884 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m18:34:29.651121 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m18:34:29.655691 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m18:34:29.658830 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m18:34:29.663266 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m18:34:29.667075 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m18:34:29.671279 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m18:34:29.678179 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m18:34:29.681528 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m18:34:29.684860 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m18:34:29.692239 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:34:29.702561 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:34:29.710794 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:34:29.721162 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:34:29.726183 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:34:29.732727 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:34:29.740897 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:34:29.767201 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:34:29.772527 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:34:29.776229 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:34:29.788133 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:34:29.792421 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:34:29.795954 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:34:29.803444 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:34:29.808202 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:34:29.815695 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:34:29.822498 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:34:29.839372 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:34:29.857108 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:34:29.862307 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:34:29.865492 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:34:30.589984 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m18:34:30.610899 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m18:34:30.616693 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m18:34:30.634869 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m18:34:30.651296 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m18:34:30.655124 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m18:34:30.713799 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m18:34:30.987525 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m18:34:31.153465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '673206a7-dc4b-4736-a1cb-0e1553e07eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc99340d0>]}
[0m18:34:31.222233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '673206a7-dc4b-4736-a1cb-0e1553e07eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc992df70>]}
[0m18:34:31.230676 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:34:31.235406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '673206a7-dc4b-4736-a1cb-0e1553e07eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bca3b3b20>]}
[0m18:34:31.242362 [info ] [MainThread]: 
[0m18:34:31.249326 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:34:31.254349 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m18:34:31.267491 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m18:34:31.269177 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:34:31.270463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:31.284064 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:34:31.288455 [debug] [ThreadPool]: On list_*****: Close
[0m18:34:31.294718 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m18:34:31.312585 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:34:31.319119 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m18:34:31.322053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:31.330773 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:34:31.333733 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:34:31.335412 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:34:31.342475 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m18:34:31.347833 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m18:34:31.349799 [debug] [ThreadPool]: On list_*****_public: Close
[0m18:34:31.361352 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:31.363436 [debug] [MainThread]: On master: BEGIN
[0m18:34:31.365057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:31.372299 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:31.374599 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:31.376688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:31.385187 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m18:34:31.388592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '673206a7-dc4b-4736-a1cb-0e1553e07eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc9956940>]}
[0m18:34:31.390856 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:31.392778 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:31.394531 [debug] [MainThread]: On master: BEGIN
[0m18:34:31.397356 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:31.399166 [debug] [MainThread]: On master: COMMIT
[0m18:34:31.400563 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:31.402257 [debug] [MainThread]: On master: COMMIT
[0m18:34:31.404085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:31.405275 [debug] [MainThread]: On master: Close
[0m18:34:31.407449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:31.409066 [info ] [MainThread]: 
[0m18:34:31.429091 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m18:34:31.430923 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m18:34:31.433158 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m18:34:31.434457 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m18:34:31.435786 [debug] [Thread-1  ]: finished collecting timing info
[0m18:34:31.437479 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m18:34:31.514877 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m18:34:31.516519 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m18:34:31.518458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:34:31.526845 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:34:31.528684 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m18:34:31.530305 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */

    create table "*****"."public"."subscription_periods" (subscription_id integer,customer_id integer,start_date date,end_date date,monthly_amount integer)
  
[0m18:34:31.534145 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m18:34:31.721680 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m18:34:31.723528 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m18:34:31.727892 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m18:34:31.740246 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m18:34:31.805481 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m18:34:31.808011 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m18:34:31.809326 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m18:34:31.811796 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:34:31.813696 [debug] [Thread-1  ]: finished collecting timing info
[0m18:34:31.814983 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m18:34:31.816749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '673206a7-dc4b-4736-a1cb-0e1553e07eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc97825e0>]}
[0m18:34:31.818398 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.38s]
[0m18:34:31.820313 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m18:34:31.823805 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:34:31.825784 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:31.827511 [debug] [MainThread]: On master: BEGIN
[0m18:34:31.829135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:31.835631 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:31.837260 [debug] [MainThread]: On master: COMMIT
[0m18:34:31.841763 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:31.843450 [debug] [MainThread]: On master: COMMIT
[0m18:34:31.845663 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:31.847107 [debug] [MainThread]: On master: Close
[0m18:34:31.849154 [info ] [MainThread]: 
[0m18:34:31.850754 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m18:34:31.851940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:31.852854 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m18:34:31.881934 [info ] [MainThread]: 
[0m18:34:31.883484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:31.885110 [info ] [MainThread]: 
[0m18:34:31.886834 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:31.890700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bca5c8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc9934310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc9785dc0>]}
[0m18:34:31.892855 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:34:38.898665 | 9c648f5e-5270-4d42-a558-f1a63f41716f ==============================
[0m18:34:38.898693 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:34:38.900852 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:34:38.902646 [debug] [MainThread]: Tracking: tracking
[0m18:34:38.928725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd136a38c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd136a38070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd136a38b20>]}
[0m18:34:39.100097 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:34:39.102994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c648f5e-5270-4d42-a558-f1a63f41716f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1381f2b80>]}
[0m18:34:39.320401 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m18:34:39.328912 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:34:39.388915 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:34:39.398502 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:34:39.403891 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m18:34:39.411509 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:34:39.416238 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:34:39.419141 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:34:39.423450 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:34:39.426822 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:34:39.430884 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:34:39.445597 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m18:34:39.449239 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:34:39.454353 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:34:39.461297 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:34:39.467037 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:34:39.471219 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:34:39.474561 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:34:39.478748 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:34:39.482968 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:34:39.486737 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:34:39.506189 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:34:39.522835 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:34:39.545862 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:34:39.550313 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:34:39.554455 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:34:39.571353 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:34:39.576324 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:34:39.581153 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:34:39.585218 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:34:39.590461 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:34:39.595182 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:34:39.601553 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:34:39.617496 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:34:39.621363 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:34:39.626022 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:34:39.629602 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:34:39.632894 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:34:39.636006 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:34:39.638509 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:34:39.642067 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:34:39.645083 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:34:39.650835 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:34:39.656332 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:34:39.663853 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:34:39.672206 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:34:39.675974 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:34:39.680448 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:34:39.700526 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:34:39.735981 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:34:39.751648 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:34:39.758664 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:34:39.793814 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:34:39.798948 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:34:39.814076 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:34:39.825944 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:34:39.834154 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:34:39.840232 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:34:39.853719 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:34:39.866583 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:34:39.883273 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:34:39.902973 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:34:39.924000 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:34:39.966266 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:34:39.971283 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:34:40.009481 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:34:40.036050 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:34:40.040193 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:34:40.048837 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:34:40.062612 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:34:40.082510 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:34:40.121930 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:34:40.170070 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:34:40.217276 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:34:40.224794 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:34:40.244469 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:34:40.255697 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:34:40.270693 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:34:40.327702 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:34:40.346416 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:34:40.355067 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m18:34:40.361164 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m18:34:40.369838 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m18:34:40.374201 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m18:34:40.378862 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m18:34:40.394247 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m18:34:40.417952 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m18:34:40.424040 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m18:34:40.434233 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m18:34:40.467156 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m18:34:40.473031 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m18:34:40.478539 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m18:34:40.486479 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m18:34:40.491006 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m18:34:40.504965 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m18:34:40.509990 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m18:34:40.513806 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m18:34:40.518856 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m18:34:40.523297 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m18:34:40.530806 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m18:34:40.538414 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m18:34:40.545863 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m18:34:40.561108 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:34:40.566849 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:34:40.582296 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:34:40.589015 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:34:40.593966 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m18:34:40.693677 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m18:34:40.701334 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m18:34:40.706697 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m18:34:40.716749 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m18:34:40.734805 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m18:34:40.745450 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m18:34:40.750478 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m18:34:40.755341 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m18:34:40.790526 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m18:34:40.800314 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m18:34:40.811372 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m18:34:40.824664 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m18:34:40.835523 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m18:34:40.851586 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m18:34:40.860124 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m18:34:40.865627 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m18:34:40.873100 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m18:34:40.880883 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:34:40.891565 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:34:40.907154 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:34:40.921085 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:34:40.926254 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:34:40.936687 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:34:40.948184 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:34:40.960984 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:34:40.965357 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:34:40.970114 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:34:40.990655 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:34:40.995498 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:34:40.999437 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:34:41.010042 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:34:41.015799 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:34:41.024671 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:34:41.032964 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:34:41.049579 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:34:41.064969 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:34:41.069267 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:34:41.072421 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:34:41.892727 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m18:34:41.919651 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m18:34:41.931312 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m18:34:41.952907 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m18:34:41.970689 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m18:34:41.974874 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m18:34:42.034679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m18:34:42.332242 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m18:34:42.470448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c648f5e-5270-4d42-a558-f1a63f41716f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd135fad0d0>]}
[0m18:34:42.473775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c648f5e-5270-4d42-a558-f1a63f41716f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd136a38b20>]}
[0m18:34:42.475524 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:34:42.481140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c648f5e-5270-4d42-a558-f1a63f41716f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1369a1580>]}
[0m18:34:42.486035 [info ] [MainThread]: 
[0m18:34:42.488045 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:34:42.490701 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m18:34:42.503200 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m18:34:42.504914 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:34:42.506645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:42.516875 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:34:42.519762 [debug] [ThreadPool]: On list_*****: Close
[0m18:34:42.524009 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m18:34:42.535145 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:34:42.537167 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m18:34:42.538621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:42.544424 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:34:42.546700 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:34:42.548202 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:34:42.553195 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.0 seconds
[0m18:34:42.558603 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m18:34:42.561860 [debug] [ThreadPool]: On list_*****_public: Close
[0m18:34:42.572166 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:42.573400 [debug] [MainThread]: On master: BEGIN
[0m18:34:42.574699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:42.581073 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:42.585413 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:42.587038 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:42.616892 [debug] [MainThread]: SQL status: SELECT 3 in 0.03 seconds
[0m18:34:42.622220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c648f5e-5270-4d42-a558-f1a63f41716f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd135f67a90>]}
[0m18:34:42.624142 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:42.626375 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:42.628945 [debug] [MainThread]: On master: BEGIN
[0m18:34:42.632012 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:42.634053 [debug] [MainThread]: On master: COMMIT
[0m18:34:42.635517 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:42.636805 [debug] [MainThread]: On master: COMMIT
[0m18:34:42.638846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:42.640251 [debug] [MainThread]: On master: Close
[0m18:34:42.642826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:42.645007 [info ] [MainThread]: 
[0m18:34:42.669219 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m18:34:42.671157 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m18:34:42.673407 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m18:34:42.675000 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m18:34:42.676486 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m18:34:42.715514 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m18:34:42.718280 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m18:34:42.721532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:34:42.741507 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m18:34:42.745445 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m18:34:42.747340 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m18:34:42.754421 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:34:42.760507 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m18:34:42.788339 [debug] [Thread-1  ]: finished collecting timing info
[0m18:34:42.790440 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m18:34:42.903328 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m18:34:42.934839 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m18:34:42.936893 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m18:34:42.952506 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:34:42.965503 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m18:34:42.969660 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m18:34:42.972890 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:43.009934 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m18:34:43.011975 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m18:34:43.014317 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m18:34:43.018643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:34:43.033642 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m18:34:43.035889 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m18:34:43.037960 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:43.040955 [debug] [Thread-1  ]: finished collecting timing info
[0m18:34:43.042621 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m18:34:43.045159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c648f5e-5270-4d42-a558-f1a63f41716f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134ea5e50>]}
[0m18:34:43.047868 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.37s]
[0m18:34:43.050584 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m18:34:43.057405 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:34:43.060132 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:43.061734 [debug] [MainThread]: On master: BEGIN
[0m18:34:43.063527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:43.074204 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:43.075955 [debug] [MainThread]: On master: COMMIT
[0m18:34:43.077537 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:43.078965 [debug] [MainThread]: On master: COMMIT
[0m18:34:43.080889 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:43.082851 [debug] [MainThread]: On master: Close
[0m18:34:43.085734 [info ] [MainThread]: 
[0m18:34:43.087952 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m18:34:43.090033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:43.092069 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m18:34:43.093913 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m18:34:43.095720 [info ] [MainThread]: 
[0m18:34:43.097726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:43.101270 [info ] [MainThread]: 
[0m18:34:43.103142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:43.105900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13698f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134eae970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134eaec40>]}
[0m18:34:43.107629 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:34:50.406044 | 46dcb466-76af-4b9b-8e33-5a9ddb112590 ==============================
[0m18:34:50.406074 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:34:50.407146 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m18:34:50.408252 [debug] [MainThread]: Tracking: tracking
[0m18:34:50.415484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b06c8d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b06c8dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b06c8db20>]}
[0m18:34:50.689481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:50.692236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:50.712253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46dcb466-76af-4b9b-8e33-5a9ddb112590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b069f8fd0>]}
[0m18:34:50.716975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46dcb466-76af-4b9b-8e33-5a9ddb112590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b06b0f5e0>]}
[0m18:34:50.718657 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:34:50.720742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46dcb466-76af-4b9b-8e33-5a9ddb112590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b06b0f820>]}
[0m18:34:50.723847 [info ] [MainThread]: 
[0m18:34:50.725789 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m18:34:50.728612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b06b0f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b06b0f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b06b0f460>]}
[0m18:34:50.732699 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:34:57.811793 | b85ec44a-1c7b-4e08-9ff1-dbc2256d6c17 ==============================
[0m18:34:57.811825 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:34:57.813116 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:34:57.814726 [debug] [MainThread]: Tracking: tracking
[0m18:34:57.825327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229b87d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229b87dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229b87db20>]}
[0m18:34:58.076594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:58.077825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:58.105250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b85ec44a-1c7b-4e08-9ff1-dbc2256d6c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229b5e7fd0>]}
[0m18:34:58.110493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b85ec44a-1c7b-4e08-9ff1-dbc2256d6c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229b6fd5e0>]}
[0m18:34:58.112262 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:34:58.113687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b85ec44a-1c7b-4e08-9ff1-dbc2256d6c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229b6fd820>]}
[0m18:34:58.118165 [info ] [MainThread]: 
[0m18:34:58.120011 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:34:58.122663 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m18:34:58.139637 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m18:34:58.141915 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:34:58.143505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:58.154772 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:34:58.162705 [debug] [ThreadPool]: On list_*****: Close
[0m18:34:58.166703 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m18:34:58.179014 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:34:58.180725 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m18:34:58.182563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:58.191112 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:34:58.193387 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:34:58.195602 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:34:58.203370 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.01 seconds
[0m18:34:58.208263 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m18:34:58.211786 [debug] [ThreadPool]: On list_*****_public: Close
[0m18:34:58.225965 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:58.228237 [debug] [MainThread]: On master: BEGIN
[0m18:34:58.230136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:58.238689 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:58.240742 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:58.242463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:58.259857 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m18:34:58.263906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b85ec44a-1c7b-4e08-9ff1-dbc2256d6c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229b84a490>]}
[0m18:34:58.265727 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:58.267692 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:58.269323 [debug] [MainThread]: On master: BEGIN
[0m18:34:58.271672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:58.274779 [debug] [MainThread]: On master: COMMIT
[0m18:34:58.276432 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:58.279077 [debug] [MainThread]: On master: COMMIT
[0m18:34:58.280668 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:58.282371 [debug] [MainThread]: On master: Close
[0m18:34:58.284778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:58.287294 [info ] [MainThread]: 
[0m18:34:58.316928 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m18:34:58.319683 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m18:34:58.322368 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m18:34:58.325137 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m18:34:58.327357 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m18:34:58.336048 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m18:34:58.343961 [debug] [Thread-1  ]: finished collecting timing info
[0m18:34:58.345636 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m18:34:58.421784 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m18:34:58.429197 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m18:34:58.430983 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m18:34:58.432529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:34:58.441695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:34:58.444450 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m18:34:58.446126 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m18:34:58.458611 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:34:58.493741 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m18:34:58.496705 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m18:34:58.500017 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:58.530870 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m18:34:58.533416 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m18:34:58.535313 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m18:34:58.538609 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:34:58.549034 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m18:34:58.551070 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m18:34:58.553815 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:58.557716 [debug] [Thread-1  ]: finished collecting timing info
[0m18:34:58.559951 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m18:34:58.562715 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b85ec44a-1c7b-4e08-9ff1-dbc2256d6c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229adafc10>]}
[0m18:34:58.564692 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.24s]
[0m18:34:58.567047 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m18:34:58.570842 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:34:58.572360 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:58.574257 [debug] [MainThread]: On master: BEGIN
[0m18:34:58.576683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:58.584307 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:58.595464 [debug] [MainThread]: On master: COMMIT
[0m18:34:58.599417 [debug] [MainThread]: Using ***** connection "master"
[0m18:34:58.602716 [debug] [MainThread]: On master: COMMIT
[0m18:34:58.607603 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:58.611035 [debug] [MainThread]: On master: Close
[0m18:34:58.616730 [info ] [MainThread]: 
[0m18:34:58.620948 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m18:34:58.623723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:58.625928 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m18:34:58.628514 [info ] [MainThread]: 
[0m18:34:58.630711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:58.632489 [info ] [MainThread]: 
[0m18:34:58.634322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:58.636824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229adb4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229adb4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f229adb4b50>]}
[0m18:34:58.638941 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:35:04.698128 | a9714920-c2d8-4400-9bfc-e7c665bab55d ==============================
[0m18:35:04.698199 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:35:04.699992 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m18:35:04.701635 [debug] [MainThread]: Tracking: tracking
[0m18:35:04.710906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58e24c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58e24070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58e24b20>]}
[0m18:35:05.031461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:05.033305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:05.049178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9714920-c2d8-4400-9bfc-e7c665bab55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58b8e0d0>]}
[0m18:35:05.053088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9714920-c2d8-4400-9bfc-e7c665bab55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58ca7670>]}
[0m18:35:05.054911 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:35:05.056784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9714920-c2d8-4400-9bfc-e7c665bab55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58ca78b0>]}
[0m18:35:05.061946 [info ] [MainThread]: 
[0m18:35:05.064744 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:05.068622 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m18:35:05.097125 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:05.099073 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m18:35:05.100313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:05.109602 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:35:05.111210 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:05.112619 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:35:05.117732 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m18:35:05.124555 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m18:35:05.126191 [debug] [ThreadPool]: On list_*****_public: Close
[0m18:35:05.138788 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:05.141616 [debug] [MainThread]: On master: BEGIN
[0m18:35:05.144978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:05.154818 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:05.156219 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:05.157633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:05.168835 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m18:35:05.174270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9714920-c2d8-4400-9bfc-e7c665bab55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58ca7400>]}
[0m18:35:05.176560 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:05.178141 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:05.179444 [debug] [MainThread]: On master: BEGIN
[0m18:35:05.181968 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:05.183933 [debug] [MainThread]: On master: COMMIT
[0m18:35:05.185387 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:05.186594 [debug] [MainThread]: On master: COMMIT
[0m18:35:05.188442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:05.190175 [debug] [MainThread]: On master: Close
[0m18:35:05.191982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:05.194595 [info ] [MainThread]: 
[0m18:35:05.217985 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:35:05.220146 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m18:35:05.222526 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m18:35:05.224764 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:35:05.227305 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:35:05.257047 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m18:35:05.269589 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:05.271483 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:35:05.310604 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m18:35:05.320893 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m18:35:05.322825 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m18:35:05.324715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:05.333548 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:05.335312 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m18:35:05.336825 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m18:35:05.352159 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:05.356608 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:05.358939 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m18:35:05.363143 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m18:35:05.366213 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.14s]
[0m18:35:05.371084 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:35:05.375001 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:05.376636 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:05.378298 [debug] [MainThread]: On master: BEGIN
[0m18:35:05.380350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:05.388116 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:05.390046 [debug] [MainThread]: On master: COMMIT
[0m18:35:05.391880 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:05.394002 [debug] [MainThread]: On master: COMMIT
[0m18:35:05.396238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:05.399678 [debug] [MainThread]: On master: Close
[0m18:35:05.402671 [info ] [MainThread]: 
[0m18:35:05.404562 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:35:05.406033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:05.407836 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m18:35:05.409443 [info ] [MainThread]: 
[0m18:35:05.410914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:05.412546 [info ] [MainThread]: 
[0m18:35:05.413777 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:35:05.415375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b583605e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b583609a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58360e20>]}
[0m18:35:05.416832 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:35:10.486693 | 679329d5-5094-4f14-9736-f66bab6bf576 ==============================
[0m18:35:10.486721 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:35:10.487795 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:35:10.489067 [debug] [MainThread]: Tracking: tracking
[0m18:35:10.496287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14657bec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14657be070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14657beb20>]}
[0m18:35:10.683254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:10.684529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:10.694394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '679329d5-5094-4f14-9736-f66bab6bf576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14655290d0>]}
[0m18:35:10.697833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '679329d5-5094-4f14-9736-f66bab6bf576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1465641670>]}
[0m18:35:10.699339 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:35:10.700759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679329d5-5094-4f14-9736-f66bab6bf576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14656418b0>]}
[0m18:35:10.703675 [info ] [MainThread]: 
[0m18:35:10.705830 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:10.707985 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m18:35:10.725906 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m18:35:10.727640 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:35:10.728871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:10.735905 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:35:10.738852 [debug] [ThreadPool]: On list_*****: Close
[0m18:35:10.742188 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m18:35:10.752157 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:10.753440 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m18:35:10.754594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:10.760990 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:35:10.762591 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:10.763932 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:35:10.768011 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m18:35:10.772204 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m18:35:10.773984 [debug] [ThreadPool]: On list_*****_public: Close
[0m18:35:10.784140 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:10.785658 [debug] [MainThread]: On master: BEGIN
[0m18:35:10.787550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:10.797260 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:10.798885 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:10.800168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:10.810305 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m18:35:10.813320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679329d5-5094-4f14-9736-f66bab6bf576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14657bc9a0>]}
[0m18:35:10.814859 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:10.816758 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:10.818506 [debug] [MainThread]: On master: BEGIN
[0m18:35:10.824997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:10.826669 [debug] [MainThread]: On master: COMMIT
[0m18:35:10.828083 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:10.829307 [debug] [MainThread]: On master: COMMIT
[0m18:35:10.831075 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:10.832470 [debug] [MainThread]: On master: Close
[0m18:35:10.834289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:10.836337 [info ] [MainThread]: 
[0m18:35:10.857268 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m18:35:10.859003 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m18:35:10.861812 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m18:35:10.863063 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m18:35:10.864663 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m18:35:10.871442 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m18:35:10.877254 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:10.878654 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m18:35:10.935359 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m18:35:10.941603 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m18:35:10.942751 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m18:35:10.943911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:10.948796 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:35:10.950323 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m18:35:10.951590 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m18:35:10.956342 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:10.968387 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m18:35:10.970036 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m18:35:10.971913 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:10.997022 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m18:35:10.998532 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m18:35:10.999715 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m18:35:11.001770 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:35:11.010032 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m18:35:11.011397 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m18:35:11.012877 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:11.015243 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:11.016262 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m18:35:11.017799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '679329d5-5094-4f14-9736-f66bab6bf576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1464d031f0>]}
[0m18:35:11.019271 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.16s]
[0m18:35:11.021064 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m18:35:11.023896 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:11.025155 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:11.026326 [debug] [MainThread]: On master: BEGIN
[0m18:35:11.027450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:11.035848 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:11.037279 [debug] [MainThread]: On master: COMMIT
[0m18:35:11.038571 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:11.039704 [debug] [MainThread]: On master: COMMIT
[0m18:35:11.041202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:11.042277 [debug] [MainThread]: On master: Close
[0m18:35:11.044270 [info ] [MainThread]: 
[0m18:35:11.046623 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:35:11.047862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:11.048920 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m18:35:11.050828 [info ] [MainThread]: 
[0m18:35:11.052206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:11.053586 [info ] [MainThread]: 
[0m18:35:11.055077 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:35:11.057028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146552ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146552cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146552c490>]}
[0m18:35:11.059828 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:35:16.149442 | 565ffc82-f88b-40a2-b433-0a1e7833b2c1 ==============================
[0m18:35:16.149514 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:35:16.151282 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m18:35:16.153291 [debug] [MainThread]: Tracking: tracking
[0m18:35:16.162338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38cf3bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38cf44550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38cf44700>]}
[0m18:35:16.356308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:16.357733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:16.366724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '565ffc82-f88b-40a2-b433-0a1e7833b2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38ccaff40>]}
[0m18:35:16.370981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '565ffc82-f88b-40a2-b433-0a1e7833b2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38cdc8580>]}
[0m18:35:16.372794 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:35:16.374228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '565ffc82-f88b-40a2-b433-0a1e7833b2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38cdc87c0>]}
[0m18:35:16.377093 [info ] [MainThread]: 
[0m18:35:16.378938 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:16.381766 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m18:35:16.401070 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:16.403412 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m18:35:16.404994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:16.412346 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:35:16.414938 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:16.416586 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:35:16.421551 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m18:35:16.427233 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m18:35:16.429469 [debug] [ThreadPool]: On list_*****_public: Close
[0m18:35:16.442556 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:16.444130 [debug] [MainThread]: On master: BEGIN
[0m18:35:16.445466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:16.452699 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:16.454571 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:16.455809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:16.465236 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m18:35:16.468229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '565ffc82-f88b-40a2-b433-0a1e7833b2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38cdc83a0>]}
[0m18:35:16.469956 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:16.471467 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:16.472957 [debug] [MainThread]: On master: BEGIN
[0m18:35:16.474692 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:16.475860 [debug] [MainThread]: On master: COMMIT
[0m18:35:16.477312 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:16.478602 [debug] [MainThread]: On master: COMMIT
[0m18:35:16.480311 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:16.481661 [debug] [MainThread]: On master: Close
[0m18:35:16.483755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:16.485334 [info ] [MainThread]: 
[0m18:35:16.507582 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:35:16.509372 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m18:35:16.512688 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m18:35:16.514679 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:35:16.516166 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:35:16.538434 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m18:35:16.544833 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:16.546633 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:35:16.571571 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m18:35:16.579688 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m18:35:16.581361 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m18:35:16.583022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:16.589968 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:16.591701 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m18:35:16.593184 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m18:35:16.599883 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:16.604326 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:16.617934 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m18:35:16.626447 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m18:35:16.628465 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.12s]
[0m18:35:16.630170 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:35:16.631487 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:35:16.632632 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m18:35:16.634332 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m18:35:16.635415 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:35:16.636523 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:35:16.646068 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m18:35:16.652857 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:16.654394 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:35:16.659793 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m18:35:16.675746 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m18:35:16.677293 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m18:35:16.678642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:16.684965 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:16.686574 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m18:35:16.689041 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:35:16.697331 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:16.700577 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:16.702352 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m18:35:16.704161 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m18:35:16.706402 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.07s]
[0m18:35:16.708358 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:35:16.711751 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:16.713158 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:16.714608 [debug] [MainThread]: On master: BEGIN
[0m18:35:16.715833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:16.701530 [debug] [MainThread]: SQL status: BEGIN in -0.01 seconds
[0m18:35:16.703386 [debug] [MainThread]: On master: COMMIT
[0m18:35:16.704838 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:16.705958 [debug] [MainThread]: On master: COMMIT
[0m18:35:16.707862 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:16.709015 [debug] [MainThread]: On master: Close
[0m18:35:16.710979 [info ] [MainThread]: 
[0m18:35:16.712188 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:35:16.713663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:16.714999 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m18:35:16.716374 [info ] [MainThread]: 
[0m18:35:16.717757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:16.719132 [info ] [MainThread]: 
[0m18:35:16.720224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:35:16.721871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38c4819a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38c4813d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38c481040>]}
[0m18:35:16.723133 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:35:22.508271 | 28c2496d-1530-41ee-aa1c-91dfe82def68 ==============================
[0m18:35:22.508341 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:35:22.509512 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:35:22.510906 [debug] [MainThread]: Tracking: tracking
[0m18:35:22.518112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9deeb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9deeaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9deeb50>]}
[0m18:35:22.709418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:22.710554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:22.721097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28c2496d-1530-41ee-aa1c-91dfe82def68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9b610d0>]}
[0m18:35:22.724557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28c2496d-1530-41ee-aa1c-91dfe82def68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9c7a6a0>]}
[0m18:35:22.727002 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:35:22.728145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28c2496d-1530-41ee-aa1c-91dfe82def68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9c7a8e0>]}
[0m18:35:22.730948 [info ] [MainThread]: 
[0m18:35:22.733114 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:22.735399 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m18:35:22.754830 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m18:35:22.756787 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:35:22.758501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:22.766558 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m18:35:22.770258 [debug] [ThreadPool]: On list_*****: Close
[0m18:35:22.774388 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m18:35:22.785063 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:22.787093 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m18:35:22.788421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:22.794434 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:35:22.796586 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:22.800206 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:35:22.805565 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m18:35:22.810238 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m18:35:22.811904 [debug] [ThreadPool]: On list_*****_public: Close
[0m18:35:22.822430 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:22.824038 [debug] [MainThread]: On master: BEGIN
[0m18:35:22.825505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:22.832358 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:22.834448 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:22.836260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:22.846397 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m18:35:22.849015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28c2496d-1530-41ee-aa1c-91dfe82def68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9c7a610>]}
[0m18:35:22.850459 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:22.852137 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:22.853491 [debug] [MainThread]: On master: BEGIN
[0m18:35:22.856532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:22.858194 [debug] [MainThread]: On master: COMMIT
[0m18:35:22.859427 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:22.860524 [debug] [MainThread]: On master: COMMIT
[0m18:35:22.862034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:22.863277 [debug] [MainThread]: On master: Close
[0m18:35:22.865230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:22.867635 [info ] [MainThread]: 
[0m18:35:22.888244 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m18:35:22.890057 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m18:35:22.892242 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m18:35:22.893717 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m18:35:22.895412 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m18:35:22.914420 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m18:35:22.926701 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m18:35:22.934243 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:22.936068 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m18:35:22.993875 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m18:35:23.009181 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m18:35:23.010627 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m18:35:23.011909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:23.017857 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:23.019547 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m18:35:23.020892 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m18:35:23.030893 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m18:35:23.042054 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m18:35:23.043810 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m18:35:23.045962 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:23.088167 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m18:35:23.090164 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m18:35:23.091763 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m18:35:23.094238 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:35:23.105259 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m18:35:23.107174 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m18:35:23.109399 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:23.112108 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:23.113943 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m18:35:23.116134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28c2496d-1530-41ee-aa1c-91dfe82def68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf92b0dc0>]}
[0m18:35:23.117803 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.22s]
[0m18:35:23.120085 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m18:35:23.123615 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:23.125251 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:23.126499 [debug] [MainThread]: On master: BEGIN
[0m18:35:23.127642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:23.133973 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:23.135854 [debug] [MainThread]: On master: COMMIT
[0m18:35:23.137381 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:23.138486 [debug] [MainThread]: On master: COMMIT
[0m18:35:23.139891 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:23.141243 [debug] [MainThread]: On master: Close
[0m18:35:23.142942 [info ] [MainThread]: 
[0m18:35:23.144363 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m18:35:23.146000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:23.147158 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m18:35:23.148403 [info ] [MainThread]: 
[0m18:35:23.149918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:23.151433 [info ] [MainThread]: 
[0m18:35:23.153074 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:35:23.154671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9b4cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9b4cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf9b6f160>]}
[0m18:35:23.155954 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:35:28.485788 | 79bfd967-70ec-4e12-8f11-8e369339941c ==============================
[0m18:35:28.485821 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:35:28.487137 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m18:35:28.489601 [debug] [MainThread]: Tracking: tracking
[0m18:35:28.497893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178f76d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178f76ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178f76b20>]}
[0m18:35:28.700505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:28.701641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:28.717599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79bfd967-70ec-4e12-8f11-8e369339941c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178ce10d0>]}
[0m18:35:28.721830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79bfd967-70ec-4e12-8f11-8e369339941c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178df8610>]}
[0m18:35:28.724596 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:35:28.726951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79bfd967-70ec-4e12-8f11-8e369339941c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178df8850>]}
[0m18:35:28.730985 [info ] [MainThread]: 
[0m18:35:28.733068 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:28.738557 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m18:35:28.757836 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:28.759525 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m18:35:28.760722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:28.768278 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:35:28.771171 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m18:35:28.772507 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:35:28.776850 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m18:35:28.782703 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m18:35:28.785062 [debug] [ThreadPool]: On list_*****_public: Close
[0m18:35:28.805424 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:28.807270 [debug] [MainThread]: On master: BEGIN
[0m18:35:28.808976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:28.815747 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:28.817495 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:28.818946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:28.828338 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m18:35:28.831896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79bfd967-70ec-4e12-8f11-8e369339941c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178df8460>]}
[0m18:35:28.833407 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:28.834927 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:28.836068 [debug] [MainThread]: On master: BEGIN
[0m18:35:28.837980 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:28.839211 [debug] [MainThread]: On master: COMMIT
[0m18:35:28.840486 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:28.842208 [debug] [MainThread]: On master: COMMIT
[0m18:35:28.843904 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:28.845441 [debug] [MainThread]: On master: Close
[0m18:35:28.847799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:28.849744 [info ] [MainThread]: 
[0m18:35:28.870540 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:35:28.872392 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m18:35:28.874769 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m18:35:28.876430 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:35:28.877903 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:35:28.900283 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m18:35:28.916532 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:28.918537 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:35:28.946559 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m18:35:28.967500 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m18:35:28.969096 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m18:35:28.970485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:28.977147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:28.978767 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m18:35:28.980268 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m18:35:28.997364 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m18:35:29.001677 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.003498 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m18:35:29.005367 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m18:35:29.008255 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.13s]
[0m18:35:29.010319 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:35:29.012305 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:35:29.014008 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m18:35:29.016212 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m18:35:29.017792 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:35:29.019239 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:35:29.035781 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m18:35:29.040975 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.042419 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:35:29.046598 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m18:35:29.064109 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m18:35:29.065596 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m18:35:29.067098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.073849 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.075536 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m18:35:29.077206 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m18:35:29.093392 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:29.096557 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.098063 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m18:35:29.099621 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m18:35:29.102874 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.09s]
[0m18:35:29.105370 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:35:29.107078 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:35:29.110110 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m18:35:29.112402 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m18:35:29.113789 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:35:29.115428 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:35:29.127230 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m18:35:29.132083 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.133333 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:35:29.139242 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m18:35:29.146341 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m18:35:29.147768 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m18:35:29.149657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.157231 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.158766 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m18:35:29.160183 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m18:35:29.181215 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m18:35:29.184494 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.185902 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m18:35:29.187547 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m18:35:29.189709 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.08s]
[0m18:35:29.192229 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:35:29.193861 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:35:29.195157 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m18:35:29.197173 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m18:35:29.198479 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:35:29.199557 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:35:29.207437 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m18:35:29.213989 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.215722 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:35:29.220159 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m18:35:29.225169 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m18:35:29.226440 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m18:35:29.227415 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.234142 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.235675 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m18:35:29.237201 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m18:35:29.253072 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:29.256642 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.258722 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m18:35:29.260596 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m18:35:29.262573 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.07s]
[0m18:35:29.264409 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:35:29.265870 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:35:29.267385 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m18:35:29.269375 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m18:35:29.270953 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:35:29.272887 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:35:29.280761 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m18:35:29.285789 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.287370 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:35:29.293270 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m18:35:29.315157 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m18:35:29.316917 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m18:35:29.318218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.324375 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.325733 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m18:35:29.326858 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m18:35:29.341377 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:29.344968 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.346776 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m18:35:29.348702 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m18:35:29.350726 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.08s]
[0m18:35:29.352433 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:35:29.353776 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m18:35:29.355182 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m18:35:29.357796 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m18:35:29.359026 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m18:35:29.360388 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m18:35:29.367451 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m18:35:29.371945 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.373741 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m18:35:29.380453 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m18:35:29.385458 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m18:35:29.386762 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m18:35:29.388488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.394603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.396207 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m18:35:29.397809 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m18:35:29.412528 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:29.416014 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.417500 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m18:35:29.419428 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m18:35:29.421701 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.06s]
[0m18:35:29.423593 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m18:35:29.425031 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:35:29.426185 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m18:35:29.428160 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m18:35:29.429388 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:35:29.430492 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:35:29.438924 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m18:35:29.444428 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.446007 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:35:29.450603 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m18:35:29.466074 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m18:35:29.467206 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m18:35:29.468559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.474679 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.476050 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m18:35:29.477645 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m18:35:29.497331 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m18:35:29.502128 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.504005 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m18:35:29.506611 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m18:35:29.509508 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.08s]
[0m18:35:29.512282 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:35:29.514838 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:35:29.517191 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m18:35:29.520098 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m18:35:29.522060 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:35:29.523904 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:35:29.531834 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m18:35:29.539949 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.545454 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:35:29.552172 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m18:35:29.568237 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m18:35:29.569896 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m18:35:29.571457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.580932 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.585696 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m18:35:29.587595 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m18:35:29.610448 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m18:35:29.616815 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.618677 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m18:35:29.620389 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m18:35:29.622241 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.10s]
[0m18:35:29.624498 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:35:29.626535 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:35:29.628148 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m18:35:29.631150 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m18:35:29.632608 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:35:29.634116 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:35:29.642757 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m18:35:29.664391 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.665785 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:35:29.670185 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m18:35:29.675024 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m18:35:29.676457 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m18:35:29.677686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.683881 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.685591 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m18:35:29.686781 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m18:35:29.701882 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:29.705184 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.706721 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m18:35:29.708306 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m18:35:29.709930 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.08s]
[0m18:35:29.711697 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:35:29.713037 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:35:29.714387 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m18:35:29.716606 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m18:35:29.718101 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:35:29.719195 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:35:29.727871 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m18:35:29.733215 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.734425 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:35:29.739053 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m18:35:29.744502 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m18:35:29.745937 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m18:35:29.747160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.753008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.754588 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m18:35:29.755839 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m18:35:29.770888 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:29.774321 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.775707 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m18:35:29.777255 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m18:35:29.779365 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.06s]
[0m18:35:29.783997 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:35:29.787442 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m18:35:29.796160 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m18:35:29.802632 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m18:35:29.805992 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m18:35:29.808474 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m18:35:29.817684 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m18:35:29.830126 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.832184 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m18:35:29.839449 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m18:35:29.849184 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m18:35:29.850948 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m18:35:29.853062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.860431 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.862643 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m18:35:29.864497 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m18:35:29.881599 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m18:35:29.887271 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.889029 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m18:35:29.890672 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m18:35:29.893025 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.09s]
[0m18:35:29.894857 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m18:35:29.896403 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:35:29.897590 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m18:35:29.899395 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m18:35:29.900790 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:35:29.902041 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:35:29.909691 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m18:35:29.914884 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.916422 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:35:29.921099 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m18:35:29.925946 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m18:35:29.927992 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m18:35:29.929244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:29.936695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:29.938900 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m18:35:29.940928 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m18:35:29.956627 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:29.959999 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.961359 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m18:35:29.963188 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m18:35:29.966722 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.07s]
[0m18:35:29.969632 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:35:29.971490 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:35:29.973433 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m18:35:29.975560 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m18:35:29.976899 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:35:29.978283 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:35:29.986645 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m18:35:29.992744 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:29.994397 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:35:30.003916 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m18:35:30.014866 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m18:35:30.016551 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m18:35:30.017905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:30.023572 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:30.025005 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m18:35:30.026373 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m18:35:30.043397 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m18:35:30.047421 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:30.049096 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m18:35:30.050919 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m18:35:30.052837 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.08s]
[0m18:35:30.054786 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:35:30.056972 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:35:30.059265 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m18:35:30.062113 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m18:35:30.063664 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:35:30.065546 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:35:30.073245 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m18:35:30.079048 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:30.080651 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:35:30.085463 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m18:35:30.091085 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m18:35:30.096150 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m18:35:30.097842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:30.103787 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:30.105183 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m18:35:30.106281 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m18:35:30.121427 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:30.125205 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:30.126806 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m18:35:30.131784 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m18:35:30.138281 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.08s]
[0m18:35:30.140745 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:35:30.142822 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m18:35:30.144254 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m18:35:30.146461 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m18:35:30.147804 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m18:35:30.148913 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m18:35:30.162127 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m18:35:30.168528 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:30.169791 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m18:35:30.174449 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m18:35:30.179863 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m18:35:30.180990 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m18:35:30.183439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:30.191370 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m18:35:30.193425 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m18:35:30.194958 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:35:30.214493 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m18:35:30.217885 [debug] [Thread-1  ]: finished collecting timing info
[0m18:35:30.219446 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m18:35:30.221437 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m18:35:30.223395 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.08s]
[0m18:35:30.224880 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m18:35:30.229101 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m18:35:30.231005 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:30.232202 [debug] [MainThread]: On master: BEGIN
[0m18:35:30.233434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:30.240019 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:30.241697 [debug] [MainThread]: On master: COMMIT
[0m18:35:30.243014 [debug] [MainThread]: Using ***** connection "master"
[0m18:35:30.244422 [debug] [MainThread]: On master: COMMIT
[0m18:35:30.246003 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.247231 [debug] [MainThread]: On master: Close
[0m18:35:30.249268 [info ] [MainThread]: 
[0m18:35:30.251191 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m18:35:30.252754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:30.253926 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m18:35:30.255290 [info ] [MainThread]: 
[0m18:35:30.256997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:30.258835 [info ] [MainThread]: 
[0m18:35:30.260609 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m18:35:30.262609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31784423a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178442580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3178468af0>]}
[0m18:35:30.264556 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:23:32.137904 | 87feee4c-5133-4e51-87b0-7f1583293cdc ==============================
[0m23:23:32.139642 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:23:32.153887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m23:23:32.158530 [debug] [MainThread]: Tracking: tracking
[0m23:23:32.177565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5077ba9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5077ba9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5077ba9c10>]}
[0m23:23:32.184986 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-az8bpx36'
[0m23:23:32.196140 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:23:32.522041 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:23:32.524318 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:23:32.811051 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:23:33.058104 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:23:38.121602 [info ] [MainThread]:   Installed from version 0.8.0
[0m23:23:38.123480 [info ] [MainThread]:   Updated version available: 0.9.6
[0m23:23:38.125991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '87feee4c-5133-4e51-87b0-7f1583293cdc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5077c47d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5077c7eeb0>]}
[0m23:23:38.128143 [info ] [MainThread]: 
[0m23:23:38.131038 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:23:38.134375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5077b56640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5077b5c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5077b5c0d0>]}
[0m23:23:38.136838 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:23:42.133012 | c250f21c-b08b-45d1-af75-3ee5f3871d72 ==============================
[0m23:23:42.133045 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:23:42.134174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m23:23:42.135839 [debug] [MainThread]: Tracking: tracking
[0m23:23:42.144785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a2096520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a2096430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a2096490>]}
[0m23:23:42.212346 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m23:23:42.214182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c250f21c-b08b-45d1-af75-3ee5f3871d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a20bd610>]}
[0m23:23:42.657924 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m23:23:42.662759 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:23:42.721206 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:23:42.728268 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:23:42.732949 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:23:42.737993 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:23:42.742552 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:23:42.745015 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:23:42.749493 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:23:42.752806 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:23:42.756388 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:23:42.776430 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:23:42.780318 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:23:42.785662 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:23:42.792099 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:23:42.796196 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:23:42.799948 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:23:42.803872 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:23:42.807711 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:23:42.810835 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:23:42.813314 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:23:42.827065 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:23:42.837222 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:23:42.854325 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:23:42.857836 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:23:42.860725 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:23:42.865807 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:23:42.868556 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:23:42.871359 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:23:42.874334 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:23:42.878915 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:23:42.882211 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:23:42.887017 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:23:42.899775 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:23:42.903737 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:23:42.906879 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:23:42.909363 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:23:42.912129 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:23:42.915201 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:23:42.918072 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:23:42.922181 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:23:42.925148 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:23:42.929035 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:23:42.932480 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:23:42.936496 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:23:42.940050 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:23:42.942715 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:23:42.945863 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:23:42.964937 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:23:42.994335 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:23:42.998718 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:23:43.004302 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:23:43.030406 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:23:43.037788 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:23:43.056001 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:23:43.067589 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:23:43.074333 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:23:43.079776 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:23:43.088306 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:23:43.095729 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:23:43.108179 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:23:43.125702 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:23:43.138912 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:23:43.174667 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:23:43.179103 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:23:43.209736 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:23:43.230385 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:23:43.233816 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:23:43.238810 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:23:43.253102 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:23:43.264718 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:23:43.300277 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:23:43.345253 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:23:43.372920 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:23:43.380475 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:23:43.388796 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:23:43.395925 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:23:43.405148 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:23:43.446979 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:23:43.460979 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:23:43.466962 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m23:23:43.471410 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m23:23:43.474313 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m23:23:43.477413 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m23:23:43.480600 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m23:23:43.488081 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m23:23:43.508702 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m23:23:43.515148 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m23:23:43.526210 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m23:23:43.548192 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m23:23:43.551822 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m23:23:43.555781 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m23:23:43.560624 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m23:23:43.563712 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m23:23:43.573341 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m23:23:43.578214 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m23:23:43.583815 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m23:23:43.588006 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m23:23:43.592264 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m23:23:43.601327 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m23:23:43.608527 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m23:23:43.614372 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m23:23:43.627386 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m23:23:43.631792 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m23:23:43.634840 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m23:23:43.639040 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m23:23:43.643370 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m23:23:43.697480 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m23:23:43.704659 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m23:23:43.709325 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m23:23:43.714577 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m23:23:43.720833 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m23:23:43.728794 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m23:23:43.733165 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m23:23:43.737969 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m23:23:43.758522 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m23:23:43.763705 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m23:23:43.766730 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m23:23:43.772947 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m23:23:43.777450 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m23:23:43.782527 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m23:23:43.788475 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m23:23:43.792478 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m23:23:43.795992 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m23:23:43.802224 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m23:23:43.812367 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m23:23:43.821213 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m23:23:43.832111 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m23:23:43.837172 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m23:23:43.844668 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m23:23:43.851931 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m23:23:43.865846 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m23:23:43.870325 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m23:23:43.874391 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m23:23:43.886245 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m23:23:43.890689 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m23:23:43.894602 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m23:23:43.902732 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m23:23:43.906836 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m23:23:43.915031 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m23:23:43.924079 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m23:23:43.942646 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m23:23:43.961413 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m23:23:43.967024 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m23:23:43.972995 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m23:23:44.625672 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m23:23:44.645564 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m23:23:44.651472 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m23:23:44.669222 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m23:23:44.683521 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m23:23:44.687300 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m23:23:44.734152 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m23:23:44.964756 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m23:23:45.107258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c250f21c-b08b-45d1-af75-3ee5f3871d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a1f8bc70>]}
[0m23:23:45.138867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c250f21c-b08b-45d1-af75-3ee5f3871d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a5f9c070>]}
[0m23:23:45.140855 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:23:45.142691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c250f21c-b08b-45d1-af75-3ee5f3871d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a1410dc0>]}
[0m23:23:45.145381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a20bdca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a1fda8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a1f8bd60>]}
[0m23:23:45.147027 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:45:31.816261 | bc4f4b7d-120d-4328-b0ce-97c7451cb474 ==============================
[0m23:45:31.816294 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:45:31.818903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m23:45:31.821153 [debug] [MainThread]: Tracking: tracking
[0m23:45:31.829635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73338dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73338d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73338dbb0>]}
[0m23:45:31.979604 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m23:45:31.981688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc4f4b7d-120d-4328-b0ce-97c7451cb474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73334d940>]}
[0m23:45:32.167426 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m23:45:32.179622 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:45:32.292828 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:45:32.301512 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:45:32.310959 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:45:32.329295 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:45:32.334943 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:45:32.338959 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:45:32.347597 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:45:32.355293 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:45:32.358681 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:45:32.404216 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:45:32.411212 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:45:32.420029 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:45:32.434777 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:45:32.442857 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:45:32.454646 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:45:32.462810 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:45:32.467731 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:45:32.472956 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:45:32.480634 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:45:32.516030 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:45:32.571458 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:45:32.610373 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:45:32.615587 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:45:32.620934 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:45:32.628417 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:45:32.632712 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:45:32.636847 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:45:32.640989 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:45:32.650179 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:45:32.657506 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:45:32.662794 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:45:32.683661 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:45:32.688837 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:45:32.699832 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:45:32.707148 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:45:32.712418 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:45:32.719472 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:45:32.727029 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:45:32.732484 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:45:32.737788 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:45:32.743439 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:45:32.747765 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:45:32.753076 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:45:32.757294 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:45:32.761768 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:45:32.773312 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:45:32.819370 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:45:32.875817 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:45:32.883362 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:45:32.894190 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:45:32.927143 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:45:32.934599 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:45:32.972039 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:45:32.984045 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:45:32.993419 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:45:33.000151 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:45:33.009611 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:45:33.017899 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:45:33.030716 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:45:33.047674 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:45:33.061524 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:45:33.097055 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:45:33.101907 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:45:33.136077 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:45:33.155040 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:45:33.158866 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:45:33.163378 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:45:33.170780 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:45:33.187771 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:45:33.213699 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:45:33.242880 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:45:33.266693 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:45:33.271896 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:45:33.275672 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:45:33.282295 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:45:33.291735 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:45:33.328815 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:45:33.350279 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:45:33.357750 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m23:45:33.363194 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m23:45:33.366726 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m23:45:33.370786 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m23:45:33.374185 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m23:45:33.381746 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m23:45:33.394269 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m23:45:33.398342 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m23:45:33.404858 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m23:45:33.433723 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m23:45:33.437854 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m23:45:33.441546 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m23:45:33.445404 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m23:45:33.448479 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m23:45:33.457265 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m23:45:33.461558 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m23:45:33.465018 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m23:45:33.471094 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m23:45:33.475741 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m23:45:33.482808 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m23:45:33.490982 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m23:45:33.498495 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m23:45:33.518081 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m23:45:33.523852 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m23:45:33.527978 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m23:45:33.531986 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m23:45:33.535355 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m23:45:33.627029 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m23:45:33.641187 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m23:45:33.645811 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m23:45:33.656557 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m23:45:33.666326 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m23:45:33.677674 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m23:45:33.683815 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m23:45:33.691435 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m23:45:33.719098 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m23:45:33.728253 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m23:45:33.740659 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m23:45:33.748851 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m23:45:33.756987 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m23:45:33.774345 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m23:45:33.782386 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m23:45:33.790165 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m23:45:33.795450 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m23:45:33.806530 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m23:45:33.825541 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m23:45:33.841361 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m23:45:33.858947 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m23:45:33.864998 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m23:45:33.876074 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m23:45:33.886374 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m23:45:33.905438 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m23:45:33.911812 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m23:45:33.915917 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m23:45:33.931576 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m23:45:33.936328 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m23:45:33.941456 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m23:45:33.951323 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m23:45:33.956134 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m23:45:33.965236 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m23:45:33.975138 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m23:45:33.994784 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m23:45:34.014078 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m23:45:34.020529 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m23:45:34.024988 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m23:45:34.721777 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m23:45:34.757940 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m23:45:34.763389 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m23:45:34.784439 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m23:45:34.804036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m23:45:34.812890 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m23:45:34.865627 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m23:45:35.103004 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m23:45:35.265340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc4f4b7d-120d-4328-b0ce-97c7451cb474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7328a50d0>]}
[0m23:45:35.301503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc4f4b7d-120d-4328-b0ce-97c7451cb474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa733306910>]}
[0m23:45:35.303635 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:45:35.308124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc4f4b7d-120d-4328-b0ce-97c7451cb474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73334d550>]}
[0m23:45:35.312574 [info ] [MainThread]: 
[0m23:45:35.315410 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:45:35.318781 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m23:45:35.333147 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m23:45:35.335494 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m23:45:35.338562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:35.347713 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m23:45:35.366276 [debug] [ThreadPool]: On list_*****: Close
[0m23:45:35.377035 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m23:45:35.398126 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:45:35.401957 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m23:45:35.405546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:35.431553 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m23:45:35.463892 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:45:35.466862 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:45:35.480499 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.01 seconds
[0m23:45:35.499120 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m23:45:35.502631 [debug] [ThreadPool]: On list_*****_public: Close
[0m23:45:35.520506 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:35.523157 [debug] [MainThread]: On master: BEGIN
[0m23:45:35.525302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:35.533156 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:45:35.535890 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:35.539567 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:35.559156 [debug] [MainThread]: SQL status: SELECT 2 in 0.02 seconds
[0m23:45:35.564631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc4f4b7d-120d-4328-b0ce-97c7451cb474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7328b2c70>]}
[0m23:45:35.567932 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:35.571040 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:35.574059 [debug] [MainThread]: On master: BEGIN
[0m23:45:35.577659 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:45:35.579899 [debug] [MainThread]: On master: COMMIT
[0m23:45:35.582012 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:35.584736 [debug] [MainThread]: On master: COMMIT
[0m23:45:35.588016 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:45:35.590749 [debug] [MainThread]: On master: Close
[0m23:45:35.593953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:35.596363 [info ] [MainThread]: 
[0m23:45:35.648373 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m23:45:35.652666 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m23:45:35.659423 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m23:45:35.662673 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m23:45:35.664543 [debug] [Thread-1  ]: finished collecting timing info
[0m23:45:35.666698 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m23:45:35.890859 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m23:45:35.898403 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m23:45:35.906461 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:35.920806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:45:35.926809 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m23:45:35.931719 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */

    create table "*****"."public"."subscription_periods" (subscription_id integer,customer_id integer,start_date date,end_date date,monthly_amount integer)
  
[0m23:45:35.940077 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m23:45:36.478281 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m23:45:36.480523 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m23:45:36.487389 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.01 seconds
[0m23:45:36.504413 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m23:45:36.585803 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m23:45:36.596006 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m23:45:36.599297 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m23:45:36.611620 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:45:36.618884 [debug] [Thread-1  ]: finished collecting timing info
[0m23:45:36.625642 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m23:45:36.629243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc4f4b7d-120d-4328-b0ce-97c7451cb474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73270b820>]}
[0m23:45:36.631972 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.97s]
[0m23:45:36.634044 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m23:45:36.639652 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:45:36.644578 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:36.646831 [debug] [MainThread]: On master: BEGIN
[0m23:45:36.648952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:36.656847 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:45:36.659490 [debug] [MainThread]: On master: COMMIT
[0m23:45:36.661748 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:36.663525 [debug] [MainThread]: On master: COMMIT
[0m23:45:36.665218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:45:36.666440 [debug] [MainThread]: On master: Close
[0m23:45:36.668534 [info ] [MainThread]: 
[0m23:45:36.673494 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m23:45:36.676057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:36.678212 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m23:45:36.732378 [info ] [MainThread]: 
[0m23:45:36.734891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:36.738088 [info ] [MainThread]: 
[0m23:45:36.740875 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:45:36.743660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73323b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7328a5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732841490>]}
[0m23:45:36.745849 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:45:44.353844 | f72130ab-2678-4a11-aa4b-f8a30c7cfb27 ==============================
[0m23:45:44.353904 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:45:44.356257 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:45:44.358290 [debug] [MainThread]: Tracking: tracking
[0m23:45:44.370348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80367e1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80367e1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80367e1b20>]}
[0m23:45:44.553093 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:45:44.557349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f72130ab-2678-4a11-aa4b-f8a30c7cfb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8037f9dca0>]}
[0m23:45:44.778848 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m23:45:44.782997 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:45:44.828462 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:45:44.834422 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:45:44.837794 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:45:44.841824 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:45:44.845481 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:45:44.849207 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:45:44.852010 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:45:44.854636 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:45:44.857904 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:45:44.870686 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:45:44.874563 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:45:44.879383 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:45:44.884836 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:45:44.888367 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:45:44.891668 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:45:44.894049 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:45:44.897567 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:45:44.900947 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:45:44.903385 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:45:44.916429 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:45:44.927425 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:45:44.947454 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:45:44.951300 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:45:44.955018 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:45:44.961803 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:45:44.966637 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:45:44.970449 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:45:44.974529 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:45:44.980420 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:45:44.984137 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:45:44.989987 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:45:45.005771 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:45:45.010049 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:45:45.013779 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:45:45.017284 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:45:45.021274 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:45:45.025388 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:45:45.029035 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:45:45.032876 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:45:45.036797 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:45:45.042403 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:45:45.046612 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:45:45.053206 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:45:45.065930 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:45:45.076303 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:45:45.081656 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:45:45.107995 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:45:45.152189 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:45:45.165200 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:45:45.173935 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:45:45.210892 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:45:45.219253 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:45:45.240493 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:45:45.259003 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:45:45.273817 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:45:45.284845 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:45:45.297699 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:45:45.307932 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:45:45.325679 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:45:45.353849 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:45:45.373558 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:45:45.423384 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:45:45.429642 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:45:45.477091 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:45:45.511381 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:45:45.516880 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:45:45.525977 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:45:45.536012 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:45:45.552895 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:45:45.592229 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:45:45.632447 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:45:45.664325 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:45:45.670658 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:45:45.676056 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:45:45.685258 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:45:45.716747 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:45:45.765848 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:45:45.781733 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:45:45.789974 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m23:45:45.804021 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m23:45:45.807936 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m23:45:45.815990 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m23:45:45.830311 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m23:45:45.851308 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m23:45:45.877009 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m23:45:45.881441 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m23:45:45.889700 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m23:45:45.914564 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m23:45:45.917890 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m23:45:45.922531 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m23:45:45.929266 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m23:45:45.933638 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m23:45:45.945658 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m23:45:45.950286 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m23:45:45.955267 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m23:45:45.976194 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m23:45:46.000400 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m23:45:46.013974 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m23:45:46.036579 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m23:45:46.066405 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m23:45:46.132955 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m23:45:46.143769 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m23:45:46.155797 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m23:45:46.161200 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m23:45:46.167368 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m23:45:46.285184 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m23:45:46.295614 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m23:45:46.300754 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m23:45:46.311292 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m23:45:46.318146 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m23:45:46.334817 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m23:45:46.342014 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m23:45:46.349261 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m23:45:46.380667 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m23:45:46.389800 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m23:45:46.394151 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m23:45:46.403813 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m23:45:46.412748 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m23:45:46.422674 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m23:45:46.431818 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m23:45:46.439000 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m23:45:46.446145 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m23:45:46.460948 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m23:45:46.476419 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m23:45:46.490825 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m23:45:46.510802 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m23:45:46.528567 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m23:45:46.566684 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m23:45:46.584685 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m23:45:46.620972 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m23:45:46.637529 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m23:45:46.643673 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m23:45:46.686766 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m23:45:46.702317 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m23:45:46.718590 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m23:45:46.739664 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m23:45:46.752521 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m23:45:46.777340 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m23:45:46.795616 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m23:45:46.822788 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m23:45:46.849553 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m23:45:46.858355 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m23:45:46.869455 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m23:45:48.833451 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m23:45:48.893920 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m23:45:48.911563 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m23:45:48.951483 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m23:45:48.983945 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m23:45:48.990889 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m23:45:49.083009 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m23:45:49.687917 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m23:45:49.951020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f72130ab-2678-4a11-aa4b-f8a30c7cfb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8035b040d0>]}
[0m23:45:49.961063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f72130ab-2678-4a11-aa4b-f8a30c7cfb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80367e1b20>]}
[0m23:45:49.965256 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:45:49.972222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f72130ab-2678-4a11-aa4b-f8a30c7cfb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8036692f70>]}
[0m23:45:49.982793 [info ] [MainThread]: 
[0m23:45:49.986543 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:45:49.990707 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m23:45:50.014899 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m23:45:50.017577 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m23:45:50.019931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:50.035896 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m23:45:50.044683 [debug] [ThreadPool]: On list_*****: Close
[0m23:45:50.060630 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m23:45:50.083815 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:45:50.088964 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m23:45:50.091539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:50.103851 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:45:50.106615 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:45:50.109290 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:45:50.117776 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.01 seconds
[0m23:45:50.126879 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m23:45:50.130009 [debug] [ThreadPool]: On list_*****_public: Close
[0m23:45:50.154171 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:50.156301 [debug] [MainThread]: On master: BEGIN
[0m23:45:50.158216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:50.167215 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:45:50.168920 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:50.170556 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:50.190608 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
[0m23:45:50.195937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f72130ab-2678-4a11-aa4b-f8a30c7cfb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8035b15a30>]}
[0m23:45:50.199178 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:50.201341 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:50.204327 [debug] [MainThread]: On master: BEGIN
[0m23:45:50.206906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:45:50.208630 [debug] [MainThread]: On master: COMMIT
[0m23:45:50.210626 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:50.212393 [debug] [MainThread]: On master: COMMIT
[0m23:45:50.215676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:45:50.217558 [debug] [MainThread]: On master: Close
[0m23:45:50.221103 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:50.223602 [info ] [MainThread]: 
[0m23:45:50.273784 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m23:45:50.276648 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m23:45:50.284714 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m23:45:50.287665 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m23:45:50.289594 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m23:45:50.324412 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m23:45:50.326587 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m23:45:50.328575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:50.337039 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:45:50.338735 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m23:45:50.340136 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m23:45:50.343001 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m23:45:50.350031 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m23:45:50.386534 [debug] [Thread-1  ]: finished collecting timing info
[0m23:45:50.388261 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m23:45:50.466122 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m23:45:50.486751 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m23:45:50.488512 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m23:45:50.494912 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:45:50.512085 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m23:45:50.514459 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m23:45:50.517424 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:45:50.552859 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m23:45:50.554468 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m23:45:50.556240 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m23:45:50.559535 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:45:50.572525 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m23:45:50.574043 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m23:45:50.576239 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:45:50.580756 [debug] [Thread-1  ]: finished collecting timing info
[0m23:45:50.592062 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m23:45:50.596402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f72130ab-2678-4a11-aa4b-f8a30c7cfb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8034a11d30>]}
[0m23:45:50.598976 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m23:45:50.600955 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m23:45:50.607472 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:45:50.612629 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:50.614424 [debug] [MainThread]: On master: BEGIN
[0m23:45:50.616145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:50.622683 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:45:50.623973 [debug] [MainThread]: On master: COMMIT
[0m23:45:50.625213 [debug] [MainThread]: Using ***** connection "master"
[0m23:45:50.626408 [debug] [MainThread]: On master: COMMIT
[0m23:45:50.627740 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:45:50.628816 [debug] [MainThread]: On master: Close
[0m23:45:50.632646 [info ] [MainThread]: 
[0m23:45:50.634356 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m23:45:50.635703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:50.637207 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m23:45:50.639002 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m23:45:50.640622 [info ] [MainThread]: 
[0m23:45:50.642565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:50.644515 [info ] [MainThread]: 
[0m23:45:50.646349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:45:50.648542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8037fb7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8034a09550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8034a09a00>]}
[0m23:45:50.650384 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:45:58.864626 | e98d7bfb-5221-4360-a80e-0cc65399a668 ==============================
[0m23:45:58.864674 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:45:58.867192 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m23:45:58.869038 [debug] [MainThread]: Tracking: tracking
[0m23:45:58.877445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc8ecb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc8ec430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc8ecac0>]}
[0m23:45:59.109090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:59.110289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:59.120330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e98d7bfb-5221-4360-a80e-0cc65399a668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc6560d0>]}
[0m23:45:59.125163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e98d7bfb-5221-4360-a80e-0cc65399a668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc76e610>]}
[0m23:45:59.126437 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:45:59.127850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e98d7bfb-5221-4360-a80e-0cc65399a668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc76e850>]}
[0m23:45:59.130953 [info ] [MainThread]: 
[0m23:45:59.132725 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m23:45:59.134663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc76e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc76e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bcc76e490>]}
[0m23:45:59.136210 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:46:04.625605 | f0718f6f-ca41-44ed-9f09-f5c213fde8c3 ==============================
[0m23:46:04.625746 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:46:04.628147 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:46:04.630485 [debug] [MainThread]: Tracking: tracking
[0m23:46:04.643771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7c02610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7c02ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7c02b20>]}
[0m23:46:05.261385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:05.266990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:05.302847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0718f6f-ca41-44ed-9f09-f5c213fde8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed796cfd0>]}
[0m23:46:05.315593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0718f6f-ca41-44ed-9f09-f5c213fde8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7a845e0>]}
[0m23:46:05.321023 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:46:05.325129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0718f6f-ca41-44ed-9f09-f5c213fde8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7a84820>]}
[0m23:46:05.330695 [info ] [MainThread]: 
[0m23:46:05.335213 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:05.342519 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m23:46:05.385086 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m23:46:05.387344 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m23:46:05.389462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:05.398360 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m23:46:05.402876 [debug] [ThreadPool]: On list_*****: Close
[0m23:46:05.411173 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m23:46:05.428866 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:05.430733 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m23:46:05.432181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:05.441596 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:46:05.444195 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:05.446631 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:46:05.452923 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.0 seconds
[0m23:46:05.459533 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m23:46:05.461808 [debug] [ThreadPool]: On list_*****_public: Close
[0m23:46:05.478900 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:05.481848 [debug] [MainThread]: On master: BEGIN
[0m23:46:05.484068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:05.493605 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:05.496859 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:05.503026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:05.517670 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m23:46:05.525222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0718f6f-ca41-44ed-9f09-f5c213fde8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7bce490>]}
[0m23:46:05.529187 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:05.532270 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:05.534581 [debug] [MainThread]: On master: BEGIN
[0m23:46:05.538494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:46:05.542418 [debug] [MainThread]: On master: COMMIT
[0m23:46:05.544466 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:05.546963 [debug] [MainThread]: On master: COMMIT
[0m23:46:05.549326 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:05.551534 [debug] [MainThread]: On master: Close
[0m23:46:05.554119 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:05.557477 [info ] [MainThread]: 
[0m23:46:05.591231 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m23:46:05.593797 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m23:46:05.596480 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m23:46:05.597933 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m23:46:05.599849 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m23:46:05.608790 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m23:46:05.621213 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:05.623515 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m23:46:05.717920 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m23:46:05.730848 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m23:46:05.733286 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m23:46:05.735405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:05.747495 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:05.750048 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m23:46:05.757022 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m23:46:05.765321 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:46:05.779765 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m23:46:05.782295 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m23:46:05.784922 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:46:05.818507 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m23:46:05.820332 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m23:46:05.822815 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m23:46:05.826184 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:46:05.835383 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m23:46:05.839315 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m23:46:05.841647 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:46:05.844500 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:05.846740 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m23:46:05.850145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0718f6f-ca41-44ed-9f09-f5c213fde8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed712ec40>]}
[0m23:46:05.852549 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.25s]
[0m23:46:05.855534 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m23:46:05.859461 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:05.861296 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:05.862947 [debug] [MainThread]: On master: BEGIN
[0m23:46:05.864806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:05.873219 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:05.875504 [debug] [MainThread]: On master: COMMIT
[0m23:46:05.876987 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:05.878443 [debug] [MainThread]: On master: COMMIT
[0m23:46:05.880188 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:05.881619 [debug] [MainThread]: On master: Close
[0m23:46:05.883602 [info ] [MainThread]: 
[0m23:46:05.886153 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m23:46:05.889555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:05.892353 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m23:46:05.894992 [info ] [MainThread]: 
[0m23:46:05.897168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:05.899349 [info ] [MainThread]: 
[0m23:46:05.902213 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:46:05.906202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7136be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7136d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed7136940>]}
[0m23:46:05.909331 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:46:23.093946 | 054d9704-15b0-4e2b-974f-3138759d57d8 ==============================
[0m23:46:23.093984 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:46:23.095972 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m23:46:23.103721 [debug] [MainThread]: Tracking: tracking
[0m23:46:23.149110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dc6fbb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dc6fb430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dc6fbac0>]}
[0m23:46:23.614694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:23.617431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:23.668448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '054d9704-15b0-4e2b-974f-3138759d57d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dc4650d0>]}
[0m23:46:23.672702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '054d9704-15b0-4e2b-974f-3138759d57d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dc57d610>]}
[0m23:46:23.676209 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:46:23.678282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '054d9704-15b0-4e2b-974f-3138759d57d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dc57d850>]}
[0m23:46:23.682034 [info ] [MainThread]: 
[0m23:46:23.685017 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:23.691275 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m23:46:23.721805 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:23.724612 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m23:46:23.726613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:23.736813 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:46:23.738874 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:23.740818 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:46:23.746643 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.0 seconds
[0m23:46:23.753071 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m23:46:23.755385 [debug] [ThreadPool]: On list_*****_public: Close
[0m23:46:23.768883 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:23.770944 [debug] [MainThread]: On master: BEGIN
[0m23:46:23.772354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:23.779384 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:23.781970 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:23.784790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:23.837904 [debug] [MainThread]: SQL status: SELECT 7 in 0.05 seconds
[0m23:46:23.853690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '054d9704-15b0-4e2b-974f-3138759d57d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dc57d220>]}
[0m23:46:23.860811 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:23.865974 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:23.870728 [debug] [MainThread]: On master: BEGIN
[0m23:46:23.875330 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:46:23.879706 [debug] [MainThread]: On master: COMMIT
[0m23:46:23.895927 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:23.901448 [debug] [MainThread]: On master: COMMIT
[0m23:46:23.904092 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:23.906296 [debug] [MainThread]: On master: Close
[0m23:46:23.909024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:23.912826 [info ] [MainThread]: 
[0m23:46:23.945995 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m23:46:23.949588 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m23:46:23.955833 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m23:46:23.958843 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m23:46:23.965369 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m23:46:24.060006 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m23:46:24.092031 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:24.120535 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m23:46:24.251975 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m23:46:24.338230 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m23:46:24.341000 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m23:46:24.342722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:24.352181 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:24.354236 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m23:46:24.356228 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m23:46:24.383981 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m23:46:24.400326 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:24.403698 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m23:46:24.407518 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m23:46:24.413851 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.46s]
[0m23:46:24.418518 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m23:46:24.424601 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:24.430198 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:24.431994 [debug] [MainThread]: On master: BEGIN
[0m23:46:24.433916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:24.442528 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:24.444981 [debug] [MainThread]: On master: COMMIT
[0m23:46:24.448006 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:24.450245 [debug] [MainThread]: On master: COMMIT
[0m23:46:24.453044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:24.455510 [debug] [MainThread]: On master: Close
[0m23:46:24.459171 [info ] [MainThread]: 
[0m23:46:24.461622 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m23:46:24.509231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:24.512818 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m23:46:24.515257 [info ] [MainThread]: 
[0m23:46:24.517388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:24.519890 [info ] [MainThread]: 
[0m23:46:24.521980 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:46:24.524173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dbbefeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dbbefd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dbbeff10>]}
[0m23:46:24.526000 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:46:32.776623 | bc0d4611-91d1-4017-a7f1-62e97c3cce6b ==============================
[0m23:46:32.776656 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:46:32.778043 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:46:32.780019 [debug] [MainThread]: Tracking: tracking
[0m23:46:32.788423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81889cbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81889c9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81889c95b0>]}
[0m23:46:33.060232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:33.061475 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:33.073421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc0d4611-91d1-4017-a7f1-62e97c3cce6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818873a9a0>]}
[0m23:46:33.076854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc0d4611-91d1-4017-a7f1-62e97c3cce6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818884e550>]}
[0m23:46:33.078491 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:46:33.080150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0d4611-91d1-4017-a7f1-62e97c3cce6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818884e790>]}
[0m23:46:33.083641 [info ] [MainThread]: 
[0m23:46:33.086152 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:33.089333 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m23:46:33.108816 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m23:46:33.110842 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m23:46:33.112417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:33.122528 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m23:46:33.125928 [debug] [ThreadPool]: On list_*****: Close
[0m23:46:33.129570 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m23:46:33.141940 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:33.143838 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m23:46:33.145621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:33.153024 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:46:33.155347 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:33.156859 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:46:33.161959 [debug] [ThreadPool]: SQL status: SELECT 57 in 0.0 seconds
[0m23:46:33.166449 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m23:46:33.168257 [debug] [ThreadPool]: On list_*****_public: Close
[0m23:46:33.179883 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:33.181724 [debug] [MainThread]: On master: BEGIN
[0m23:46:33.184302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:33.191999 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:33.193745 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:33.195026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:33.209740 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m23:46:33.213009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc0d4611-91d1-4017-a7f1-62e97c3cce6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818884e4c0>]}
[0m23:46:33.214843 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:33.216718 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:33.218727 [debug] [MainThread]: On master: BEGIN
[0m23:46:33.222432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:46:33.226106 [debug] [MainThread]: On master: COMMIT
[0m23:46:33.227996 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:33.229758 [debug] [MainThread]: On master: COMMIT
[0m23:46:33.232304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:33.236851 [debug] [MainThread]: On master: Close
[0m23:46:33.240701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:33.243758 [info ] [MainThread]: 
[0m23:46:33.267930 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m23:46:33.270545 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m23:46:33.274383 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m23:46:33.276303 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m23:46:33.277715 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m23:46:33.293181 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m23:46:33.302113 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:33.303981 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m23:46:33.406107 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m23:46:33.425985 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m23:46:33.427817 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m23:46:33.429441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:33.436320 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:33.438411 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m23:46:33.440758 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m23:46:33.447787 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:46:33.460135 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m23:46:33.461766 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m23:46:33.464144 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:46:33.493446 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m23:46:33.495677 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m23:46:33.497160 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m23:46:33.499370 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:46:33.522993 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m23:46:33.526290 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m23:46:33.529589 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:46:33.532965 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:33.534965 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m23:46:33.537647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc0d4611-91d1-4017-a7f1-62e97c3cce6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8187ed0700>]}
[0m23:46:33.540044 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.26s]
[0m23:46:33.542097 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m23:46:33.547579 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:33.549336 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:33.551052 [debug] [MainThread]: On master: BEGIN
[0m23:46:33.553609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:33.565948 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:33.569521 [debug] [MainThread]: On master: COMMIT
[0m23:46:33.571884 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:33.573793 [debug] [MainThread]: On master: COMMIT
[0m23:46:33.577305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:33.579022 [debug] [MainThread]: On master: Close
[0m23:46:33.581279 [info ] [MainThread]: 
[0m23:46:33.584044 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m23:46:33.587204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:33.589050 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m23:46:33.590542 [info ] [MainThread]: 
[0m23:46:33.592027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:33.593543 [info ] [MainThread]: 
[0m23:46:33.594926 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:46:33.596338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8187f06be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8187f06d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8187f06940>]}
[0m23:46:33.597532 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:46:39.424595 | 888da315-e354-4df8-a7bb-c30d4a631e10 ==============================
[0m23:46:39.424629 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:46:39.426073 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m23:46:39.428100 [debug] [MainThread]: Tracking: tracking
[0m23:46:39.435174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefa720c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefa720070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefa720b20>]}
[0m23:46:39.690403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:39.692386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:39.704945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '888da315-e354-4df8-a7bb-c30d4a631e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefa48a0d0>]}
[0m23:46:39.709047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '888da315-e354-4df8-a7bb-c30d4a631e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefa5a3670>]}
[0m23:46:39.711354 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:46:39.713431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888da315-e354-4df8-a7bb-c30d4a631e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefa5a38b0>]}
[0m23:46:39.717277 [info ] [MainThread]: 
[0m23:46:39.719582 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:39.722733 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m23:46:39.744187 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:39.746409 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m23:46:39.748512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:39.755500 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:46:39.757083 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:39.758634 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:46:39.763254 [debug] [ThreadPool]: SQL status: SELECT 58 in 0.0 seconds
[0m23:46:39.768095 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m23:46:39.769944 [debug] [ThreadPool]: On list_*****_public: Close
[0m23:46:39.782073 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:39.783848 [debug] [MainThread]: On master: BEGIN
[0m23:46:39.785557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:39.791866 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:39.793930 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:39.795554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:39.805121 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m23:46:39.809088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888da315-e354-4df8-a7bb-c30d4a631e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcefa5a34c0>]}
[0m23:46:39.812529 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:39.814503 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:39.815918 [debug] [MainThread]: On master: BEGIN
[0m23:46:39.817789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:46:39.819123 [debug] [MainThread]: On master: COMMIT
[0m23:46:39.820299 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:39.821755 [debug] [MainThread]: On master: COMMIT
[0m23:46:39.823362 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:39.824774 [debug] [MainThread]: On master: Close
[0m23:46:39.827028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:39.829233 [info ] [MainThread]: 
[0m23:46:39.850182 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m23:46:39.851986 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m23:46:39.853695 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m23:46:39.855427 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m23:46:39.856886 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m23:46:39.880368 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m23:46:39.886390 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:39.888003 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m23:46:39.914123 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m23:46:39.925654 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m23:46:39.927891 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m23:46:39.929578 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:39.935696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:39.937574 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m23:46:39.939085 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m23:46:39.950563 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m23:46:39.955107 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:39.956720 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m23:46:39.958804 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m23:46:39.961442 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.11s]
[0m23:46:39.963839 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m23:46:39.965536 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m23:46:39.967177 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m23:46:39.969388 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m23:46:39.970964 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m23:46:39.972360 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m23:46:39.988729 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m23:46:39.995070 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:39.996756 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m23:46:40.001671 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m23:46:40.007678 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m23:46:40.019212 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m23:46:40.022046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:40.033839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:40.036427 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m23:46:40.038855 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:40.055904 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m23:46:40.062610 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:40.068278 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m23:46:40.070521 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m23:46:40.082336 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.11s]
[0m23:46:40.087038 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m23:46:40.091273 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:40.093669 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:40.095744 [debug] [MainThread]: On master: BEGIN
[0m23:46:40.097529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:40.104765 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:40.107049 [debug] [MainThread]: On master: COMMIT
[0m23:46:40.108865 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:40.111580 [debug] [MainThread]: On master: COMMIT
[0m23:46:40.114346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:40.116341 [debug] [MainThread]: On master: Close
[0m23:46:40.119299 [info ] [MainThread]: 
[0m23:46:40.121754 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m23:46:40.123782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:40.125228 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m23:46:40.126658 [info ] [MainThread]: 
[0m23:46:40.128964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:40.130556 [info ] [MainThread]: 
[0m23:46:40.132414 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:46:40.134201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef9c0c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef9c0ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef9c0c4f0>]}
[0m23:46:40.136101 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:46:45.791275 | 0c631232-ee96-4533-ae98-d701a31e0ca8 ==============================
[0m23:46:45.791309 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:46:45.792919 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:46:45.794390 [debug] [MainThread]: Tracking: tracking
[0m23:46:45.803183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f65c4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f65c4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f65c4b50>]}
[0m23:46:46.132536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:46.137055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:46.158545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c631232-ee96-4533-ae98-d701a31e0ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f63300d0>]}
[0m23:46:46.165738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c631232-ee96-4533-ae98-d701a31e0ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f6448640>]}
[0m23:46:46.169562 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:46:46.172961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c631232-ee96-4533-ae98-d701a31e0ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f6448880>]}
[0m23:46:46.181737 [info ] [MainThread]: 
[0m23:46:46.186711 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:46.191998 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m23:46:46.221540 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m23:46:46.223945 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m23:46:46.225627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:46.236703 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m23:46:46.244118 [debug] [ThreadPool]: On list_*****: Close
[0m23:46:46.249138 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m23:46:46.261266 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:46.263175 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m23:46:46.264739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:46.272058 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:46:46.273765 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:46.275083 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:46:46.280967 [debug] [ThreadPool]: SQL status: SELECT 58 in 0.0 seconds
[0m23:46:46.287019 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m23:46:46.289555 [debug] [ThreadPool]: On list_*****_public: Close
[0m23:46:46.301942 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:46.303451 [debug] [MainThread]: On master: BEGIN
[0m23:46:46.305123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:46.315561 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:46.318678 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:46.321591 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:46.337009 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m23:46:46.340737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c631232-ee96-4533-ae98-d701a31e0ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f65bd040>]}
[0m23:46:46.342975 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:46.346275 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:46.348401 [debug] [MainThread]: On master: BEGIN
[0m23:46:46.350727 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:46:46.352349 [debug] [MainThread]: On master: COMMIT
[0m23:46:46.354772 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:46.355910 [debug] [MainThread]: On master: COMMIT
[0m23:46:46.357316 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:46.359512 [debug] [MainThread]: On master: Close
[0m23:46:46.361399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:46.363998 [info ] [MainThread]: 
[0m23:46:46.387809 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m23:46:46.389922 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m23:46:46.392307 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m23:46:46.394151 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m23:46:46.396449 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m23:46:46.418472 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m23:46:46.433112 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m23:46:46.438967 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:46.440520 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m23:46:46.529318 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m23:46:46.538689 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m23:46:46.541644 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m23:46:46.543547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:46.551787 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:46.554023 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m23:46:46.555960 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m23:46:46.563878 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m23:46:46.585818 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m23:46:46.587836 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m23:46:46.590814 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:46:46.645164 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m23:46:46.649981 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m23:46:46.654003 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m23:46:46.656959 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:46:46.674569 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m23:46:46.677223 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m23:46:46.679536 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:46:46.684697 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:46.686699 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m23:46:46.691088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c631232-ee96-4533-ae98-d701a31e0ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f5aa2dc0>]}
[0m23:46:46.694792 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.30s]
[0m23:46:46.701689 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m23:46:46.708740 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:46.710873 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:46.712856 [debug] [MainThread]: On master: BEGIN
[0m23:46:46.716257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:46.723535 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:46.726381 [debug] [MainThread]: On master: COMMIT
[0m23:46:46.729581 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:46.731273 [debug] [MainThread]: On master: COMMIT
[0m23:46:46.733592 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:46.735678 [debug] [MainThread]: On master: Close
[0m23:46:46.737779 [info ] [MainThread]: 
[0m23:46:46.740355 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m23:46:46.742152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:46.743413 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m23:46:46.745344 [info ] [MainThread]: 
[0m23:46:46.748067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:46.750698 [info ] [MainThread]: 
[0m23:46:46.752579 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:46:46.754598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f633d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f633df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f633d580>]}
[0m23:46:46.756245 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 23:46:53.303753 | f92fceb5-4ef0-44a0-9b79-f1162fbe97d5 ==============================
[0m23:46:53.303798 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:46:53.305040 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m23:46:53.307981 [debug] [MainThread]: Tracking: tracking
[0m23:46:53.321145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa487961b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa487961af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa487961b50>]}
[0m23:46:53.581150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:53.582330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:53.594165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f92fceb5-4ef0-44a0-9b79-f1162fbe97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4876cb0d0>]}
[0m23:46:53.598459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f92fceb5-4ef0-44a0-9b79-f1162fbe97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4877e46a0>]}
[0m23:46:53.600208 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:46:53.601885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92fceb5-4ef0-44a0-9b79-f1162fbe97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4877e48e0>]}
[0m23:46:53.606207 [info ] [MainThread]: 
[0m23:46:53.608532 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:53.611753 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m23:46:53.635700 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:53.637721 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m23:46:53.639364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:53.648371 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m23:46:53.650153 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m23:46:53.655715 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:46:53.665908 [debug] [ThreadPool]: SQL status: SELECT 59 in 0.01 seconds
[0m23:46:53.672354 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m23:46:53.674784 [debug] [ThreadPool]: On list_*****_public: Close
[0m23:46:53.692328 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:53.694752 [debug] [MainThread]: On master: BEGIN
[0m23:46:53.696247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:53.718595 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m23:46:53.720545 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:53.721893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:53.734014 [debug] [MainThread]: SQL status: SELECT 10 in 0.01 seconds
[0m23:46:53.738038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92fceb5-4ef0-44a0-9b79-f1162fbe97d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4877e44f0>]}
[0m23:46:53.739923 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:53.741670 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:53.743586 [debug] [MainThread]: On master: BEGIN
[0m23:46:53.745713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:46:53.746918 [debug] [MainThread]: On master: COMMIT
[0m23:46:53.759170 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:53.761215 [debug] [MainThread]: On master: COMMIT
[0m23:46:53.763210 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:53.765160 [debug] [MainThread]: On master: Close
[0m23:46:53.768391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:53.771070 [info ] [MainThread]: 
[0m23:46:53.800600 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m23:46:53.804128 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m23:46:53.809135 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m23:46:53.811729 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m23:46:53.814490 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m23:46:53.858054 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m23:46:53.885779 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:53.888301 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m23:46:53.935335 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m23:46:53.946690 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m23:46:53.948874 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m23:46:53.950587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:53.961225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:53.963245 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m23:46:53.964885 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m23:46:53.983823 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:53.989858 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:53.991668 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m23:46:53.993773 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m23:46:53.996117 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.19s]
[0m23:46:53.998121 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m23:46:53.999959 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m23:46:54.001692 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m23:46:54.004988 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m23:46:54.007073 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m23:46:54.008883 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m23:46:54.028994 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m23:46:54.036029 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.038895 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m23:46:54.044465 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m23:46:54.050558 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m23:46:54.052430 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m23:46:54.054301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.061560 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.063217 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m23:46:54.064728 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m23:46:54.082818 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:54.086969 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.091031 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m23:46:54.093550 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m23:46:54.096121 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.09s]
[0m23:46:54.098421 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m23:46:54.100601 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m23:46:54.102438 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m23:46:54.105855 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m23:46:54.107618 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m23:46:54.108929 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m23:46:54.123410 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m23:46:54.134799 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.136651 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m23:46:54.143501 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m23:46:54.148977 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m23:46:54.150598 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m23:46:54.152182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.158742 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.160791 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m23:46:54.162346 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m23:46:54.176219 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m23:46:54.180048 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.181631 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m23:46:54.183247 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m23:46:54.185665 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.08s]
[0m23:46:54.188122 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m23:46:54.189949 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m23:46:54.191588 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m23:46:54.193720 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m23:46:54.195088 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m23:46:54.196573 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m23:46:54.207344 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m23:46:54.237001 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.239411 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m23:46:54.245960 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m23:46:54.252348 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m23:46:54.254243 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m23:46:54.256193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.262534 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.264028 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m23:46:54.265349 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m23:46:54.281690 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m23:46:54.285617 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.287670 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m23:46:54.289813 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m23:46:54.292064 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.10s]
[0m23:46:54.294013 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m23:46:54.295563 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m23:46:54.297084 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m23:46:54.299078 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m23:46:54.300363 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m23:46:54.302015 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m23:46:54.310608 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m23:46:54.316019 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.317776 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m23:46:54.322948 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m23:46:54.335233 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m23:46:54.337795 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m23:46:54.339724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.346190 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.348118 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m23:46:54.349518 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m23:46:54.365169 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m23:46:54.369023 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.370861 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m23:46:54.373148 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m23:46:54.376020 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.08s]
[0m23:46:54.378229 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m23:46:54.379995 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m23:46:54.381380 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m23:46:54.383809 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m23:46:54.385672 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m23:46:54.387091 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m23:46:54.396223 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m23:46:54.401586 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.403252 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m23:46:54.409735 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m23:46:54.417078 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m23:46:54.419623 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m23:46:54.421667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.428798 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.430741 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m23:46:54.432196 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m23:46:54.448243 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m23:46:54.452058 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.454994 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m23:46:54.456993 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m23:46:54.459055 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.08s]
[0m23:46:54.462571 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m23:46:54.463915 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m23:46:54.465543 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m23:46:54.469000 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m23:46:54.470978 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m23:46:54.473321 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m23:46:54.485035 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m23:46:54.493068 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.495201 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m23:46:54.501433 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m23:46:54.511880 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m23:46:54.514215 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m23:46:54.515906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.526888 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.529712 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m23:46:54.533080 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m23:46:54.557193 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:54.562935 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.566067 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m23:46:54.568861 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m23:46:54.574751 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.11s]
[0m23:46:54.578415 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m23:46:54.579999 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m23:46:54.581516 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m23:46:54.583688 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m23:46:54.585090 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m23:46:54.586734 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m23:46:54.599965 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m23:46:54.607720 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.609143 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m23:46:54.615018 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m23:46:54.637117 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m23:46:54.639259 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m23:46:54.641120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.647874 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.649651 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m23:46:54.651114 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m23:46:54.671271 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:54.677851 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.680008 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m23:46:54.682050 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m23:46:54.685117 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.10s]
[0m23:46:54.688714 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m23:46:54.692401 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m23:46:54.696400 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m23:46:54.700244 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m23:46:54.704344 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m23:46:54.706815 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m23:46:54.716782 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m23:46:54.736176 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.739705 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m23:46:54.748866 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m23:46:54.757363 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m23:46:54.759960 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m23:46:54.762759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.772355 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.774618 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m23:46:54.776263 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m23:46:54.793277 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:54.797219 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.799707 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m23:46:54.802401 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m23:46:54.805571 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.11s]
[0m23:46:54.808115 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m23:46:54.810155 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m23:46:54.812166 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m23:46:54.814876 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m23:46:54.816483 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m23:46:54.818224 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m23:46:54.828206 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m23:46:54.835366 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.837061 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m23:46:54.842817 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m23:46:54.848804 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m23:46:54.850350 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m23:46:54.851858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.858788 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.860772 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m23:46:54.862692 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m23:46:54.880638 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:54.884118 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.885900 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m23:46:54.888097 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m23:46:54.890522 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.08s]
[0m23:46:54.892527 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m23:46:54.894521 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m23:46:54.896309 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m23:46:54.898923 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m23:46:54.900782 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m23:46:54.902887 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m23:46:54.915593 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m23:46:54.937002 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:54.939731 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m23:46:54.948395 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m23:46:54.959948 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m23:46:54.962983 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m23:46:54.966535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:54.974689 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:54.976789 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m23:46:54.978941 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m23:46:55.006275 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m23:46:55.024988 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.031876 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m23:46:55.038394 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m23:46:55.048345 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.15s]
[0m23:46:55.053690 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m23:46:55.057226 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m23:46:55.061137 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m23:46:55.066012 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m23:46:55.070207 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m23:46:55.072102 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m23:46:55.080498 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m23:46:55.097958 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.104145 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m23:46:55.115102 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m23:46:55.137597 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m23:46:55.143353 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m23:46:55.146269 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:55.153887 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:55.155802 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m23:46:55.157381 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m23:46:55.183103 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:55.186871 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.188913 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m23:46:55.190921 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m23:46:55.193306 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.13s]
[0m23:46:55.197456 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m23:46:55.200809 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m23:46:55.203891 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m23:46:55.206983 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m23:46:55.208992 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m23:46:55.210751 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m23:46:55.219106 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m23:46:55.236376 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.239696 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m23:46:55.250574 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m23:46:55.258533 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m23:46:55.260559 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m23:46:55.262353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:55.268711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:55.270535 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m23:46:55.272137 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m23:46:55.288795 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:55.292509 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.294543 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m23:46:55.296086 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m23:46:55.297989 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.09s]
[0m23:46:55.300798 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m23:46:55.302173 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m23:46:55.303544 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m23:46:55.305853 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m23:46:55.313273 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m23:46:55.315820 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m23:46:55.332187 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m23:46:55.342198 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.345278 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m23:46:55.356885 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m23:46:55.364651 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m23:46:55.366532 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m23:46:55.368207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:55.374787 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:55.376310 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m23:46:55.377484 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m23:46:55.393675 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m23:46:55.397118 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.398744 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m23:46:55.400217 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m23:46:55.402091 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.10s]
[0m23:46:55.403882 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m23:46:55.405534 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m23:46:55.407561 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m23:46:55.409890 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m23:46:55.411434 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m23:46:55.413085 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m23:46:55.425434 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m23:46:55.435336 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.436881 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m23:46:55.441797 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m23:46:55.447700 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m23:46:55.449259 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m23:46:55.450768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:46:55.460147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m23:46:55.462443 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m23:46:55.464621 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:55.484380 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m23:46:55.488004 [debug] [Thread-1  ]: finished collecting timing info
[0m23:46:55.489900 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m23:46:55.491928 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m23:46:55.493983 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.08s]
[0m23:46:55.497895 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m23:46:55.501966 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m23:46:55.504118 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:55.507420 [debug] [MainThread]: On master: BEGIN
[0m23:46:55.509794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:55.517389 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m23:46:55.519729 [debug] [MainThread]: On master: COMMIT
[0m23:46:55.522010 [debug] [MainThread]: Using ***** connection "master"
[0m23:46:55.523800 [debug] [MainThread]: On master: COMMIT
[0m23:46:55.525691 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:46:55.527290 [debug] [MainThread]: On master: Close
[0m23:46:55.529719 [info ] [MainThread]: 
[0m23:46:55.531540 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m23:46:55.533388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:55.535116 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m23:46:55.537081 [info ] [MainThread]: 
[0m23:46:55.539560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:55.541672 [info ] [MainThread]: 
[0m23:46:55.543337 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m23:46:55.545320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa486e48fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa486e48ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa486e48d00>]}
[0m23:46:55.546968 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 18:39:43.670877 | 36ef4a1d-b804-4152-84fb-713435dc41d3 ==============================
[0m18:39:43.670896 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:39:43.672811 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m18:39:43.675400 [debug] [MainThread]: Tracking: tracking
[0m18:39:43.677551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3e453940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3e4538e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3e453880>]}
[0m18:39:43.715302 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m18:39:43.717162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36ef4a1d-b804-4152-84fb-713435dc41d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3e456190>]}
[0m18:39:44.086251 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m18:39:44.089787 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m18:39:44.092720 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:39:44.097022 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:39:44.164204 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:39:44.176230 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:39:44.179209 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:39:44.188597 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m18:39:44.193002 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:39:44.196897 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m18:39:44.203512 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:39:44.219230 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:39:44.221807 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:39:44.223926 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:39:44.226162 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:39:44.228467 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:39:44.230433 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m18:39:44.234232 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:39:44.243778 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:39:44.248579 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:39:44.255021 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:39:44.266158 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:39:44.296378 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:39:44.301392 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:39:44.307640 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:39:44.310916 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:39:44.320079 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:39:44.329375 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:39:44.335745 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:39:44.346154 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:39:44.359228 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:39:44.387315 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:39:44.413662 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:39:44.430404 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:39:44.434200 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:39:44.438384 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:39:44.442309 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:39:44.450559 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:39:44.474117 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:39:44.493147 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:39:44.497799 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:39:44.520774 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:39:44.540805 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:39:44.545611 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:39:44.550602 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:39:44.562277 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:39:44.568281 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:39:44.572558 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:39:44.595680 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:39:44.603599 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:39:44.618303 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:39:44.632329 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:39:44.640733 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:39:44.643884 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:39:44.646599 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:39:44.649052 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:39:44.651888 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:39:44.654311 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:39:44.657138 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:39:44.660050 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:39:44.662744 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:39:44.672623 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:39:44.675550 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:39:44.678896 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:39:44.682147 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:39:44.685745 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:39:44.690380 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:39:44.693525 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:39:44.696160 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:39:44.699482 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:39:44.701968 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:39:44.704674 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:39:44.708399 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:39:44.711487 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:39:44.714765 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:39:44.718951 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:39:44.721675 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:39:44.724281 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:39:44.726807 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:39:44.729462 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:39:44.732656 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:39:44.735993 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:39:44.740470 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:39:44.744061 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:39:44.749627 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m18:39:44.753959 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m18:39:44.756876 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m18:39:44.760951 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m18:39:44.763578 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m18:39:44.769343 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m18:39:44.778729 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m18:39:44.782603 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m18:39:44.787893 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m18:39:44.804582 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m18:39:44.808825 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m18:39:44.812684 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m18:39:44.816233 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m18:39:44.818939 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m18:39:44.824886 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m18:39:44.828589 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m18:39:44.831596 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m18:39:44.835451 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m18:39:44.839029 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m18:39:44.844074 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m18:39:44.848815 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m18:39:44.853168 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m18:39:44.863197 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:39:44.866609 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:39:44.869528 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:39:44.872510 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:39:44.875958 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m18:39:44.914738 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m18:39:44.920160 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m18:39:44.923533 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m18:39:44.927850 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m18:39:44.931403 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m18:39:44.937460 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m18:39:44.941213 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m18:39:44.945071 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m18:39:44.960923 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m18:39:44.965885 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m18:39:44.969142 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m18:39:44.973587 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m18:39:44.977389 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m18:39:44.981821 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m18:39:44.986738 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m18:39:44.989967 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m18:39:44.993550 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m18:39:44.999109 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:39:45.007248 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:39:45.015859 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:39:45.025305 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:39:45.031273 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:39:45.038015 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:39:45.044244 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:39:45.055445 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:39:45.059607 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:39:45.063261 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:39:45.073034 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:39:45.076653 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:39:45.080135 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:39:45.087473 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:39:45.091365 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:39:45.098501 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:39:45.104657 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:39:45.117706 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:39:45.131186 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:39:45.136339 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:39:45.141164 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:39:45.732382 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m18:39:45.750924 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m18:39:45.757782 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m18:39:45.775985 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m18:39:45.790878 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m18:39:45.795243 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m18:39:45.833369 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m18:39:46.056621 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m18:39:46.179668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36ef4a1d-b804-4152-84fb-713435dc41d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3d460fa0>]}
[0m18:39:46.209705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36ef4a1d-b804-4152-84fb-713435dc41d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3d44b520>]}
[0m18:39:46.211936 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:39:46.213929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36ef4a1d-b804-4152-84fb-713435dc41d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3dba0a60>]}
[0m18:39:46.218461 [info ] [MainThread]: 
[0m18:39:46.220980 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:39:46.224184 [debug] [ThreadPool]: Acquiring new snowflake connection "list_CS_DEV_demo"
[0m18:39:46.238226 [debug] [ThreadPool]: Using snowflake connection "list_CS_DEV_demo"
[0m18:39:46.240886 [debug] [ThreadPool]: On list_CS_DEV_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_CS_DEV_demo"} */
show terse objects in CS_DEV.demo
[0m18:39:46.243508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:46.977575 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.73 seconds
[0m18:39:46.983812 [debug] [ThreadPool]: On list_CS_DEV_demo: Close
[0m18:39:47.156235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36ef4a1d-b804-4152-84fb-713435dc41d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3d460fd0>]}
[0m18:39:47.160108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:47.162729 [info ] [MainThread]: 
[0m18:39:47.182499 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m18:39:47.185516 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m18:39:47.187708 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m18:39:47.189680 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m18:39:47.202074 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m18:39:47.204254 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m18:39:47.206294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:48.104121 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.9 seconds
[0m18:39:48.108801 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m18:39:48.129123 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.130842 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m18:39:48.132508 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.134044 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m18:39:48.314001 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m18:39:48.317126 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m18:39:48.319778 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.acme.subscription_periods"
[0m18:39:48.321956 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m18:39:48.324281 [debug] [Thread-1  ]: Compiling seed.acme.subscription_periods
[0m18:39:48.329186 [debug] [Thread-1  ]: Writing injected SQL for node "seed.acme.subscription_periods"
[0m18:39:48.331196 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.333117 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m18:39:48.335097 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.337621 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m18:39:48.341141 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m18:39:48.343690 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_revenue_by_month"
[0m18:39:48.345578 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m18:39:48.347346 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m18:39:48.354127 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m18:39:48.360704 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.362505 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m18:39:48.364149 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.366130 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m18:39:48.367757 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m18:39:48.369793 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670"
[0m18:39:48.371306 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m18:39:48.372983 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m18:39:48.381100 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670"
[0m18:39:48.390716 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.392748 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m18:39:48.394456 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.396664 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m18:39:48.398495 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m18:39:48.400492 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd"
[0m18:39:48.401885 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m18:39:48.403316 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m18:39:48.410644 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd"
[0m18:39:48.416259 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.418162 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m18:39:48.419755 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.421881 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m18:39:48.423494 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m18:39:48.425903 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa"
[0m18:39:48.427833 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m18:39:48.429626 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m18:39:48.439461 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa"
[0m18:39:48.446392 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.448057 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m18:39:48.449657 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.452056 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m18:39:48.453854 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m18:39:48.456229 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_churn_month"
[0m18:39:48.458164 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m18:39:48.460220 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m18:39:48.467832 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m18:39:48.477185 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.480782 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m18:39:48.482759 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.485871 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m18:39:48.487854 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:39:48.489980 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m18:39:48.491873 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:39:48.493831 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:39:48.502115 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m18:39:48.511679 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.514080 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:39:48.516306 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.519364 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m18:39:48.521289 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m18:39:48.523538 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m18:39:48.525650 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m18:39:48.527652 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m18:39:48.535937 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m18:39:48.539051 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m18:39:48.545257 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.547233 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m18:39:48.548875 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.550987 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m18:39:48.552725 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:39:48.554820 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m18:39:48.556469 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:39:48.558189 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:39:48.570283 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m18:39:48.577489 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.579447 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:39:48.581064 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.583117 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m18:39:48.584943 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:39:48.587166 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m18:39:48.589011 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:39:48.591510 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:39:48.601790 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m18:39:48.609350 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.611807 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:39:48.614335 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.617707 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m18:39:48.619544 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:39:48.621638 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m18:39:48.623233 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:39:48.624920 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:39:48.633623 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m18:39:48.647530 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.649988 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:39:48.652377 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.654978 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m18:39:48.656858 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:39:48.659546 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m18:39:48.661248 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:39:48.662916 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:39:48.673375 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m18:39:48.682642 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.684847 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:39:48.686965 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.689556 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m18:39:48.691537 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:39:48.694124 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m18:39:48.696163 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:39:48.698310 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:39:48.707015 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m18:39:48.714462 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.716659 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:39:48.718639 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.721199 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m18:39:48.723373 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:39:48.726890 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m18:39:48.728780 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:39:48.730862 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:39:48.737480 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m18:39:48.743108 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.744802 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:39:48.746313 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.748355 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m18:39:48.749880 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:39:48.751672 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m18:39:48.753117 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:39:48.754801 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:39:48.761195 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m18:39:48.766993 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.768607 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:39:48.770265 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.772804 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m18:39:48.774847 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m18:39:48.778020 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_id.45914052fb"
[0m18:39:48.796988 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m18:39:48.799664 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m18:39:48.807995 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m18:39:48.814992 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.817649 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m18:39:48.819772 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.822471 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m18:39:48.824733 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:39:48.827521 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m18:39:48.829882 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:39:48.832630 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:39:48.845009 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m18:39:48.852526 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.854935 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:39:48.856957 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.860275 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m18:39:48.862792 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:39:48.865320 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m18:39:48.867540 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:39:48.869443 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:39:48.878495 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m18:39:48.885783 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.888281 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:39:48.890999 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.894902 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m18:39:48.896970 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:39:48.899579 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m18:39:48.902211 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:39:48.904121 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:39:48.912208 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m18:39:48.919471 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.921535 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:39:48.923552 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.926437 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m18:39:48.928605 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:39:48.931006 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m18:39:48.932823 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:39:48.934741 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:39:48.942055 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m18:39:48.948689 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.950717 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:39:48.952512 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.954794 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m18:39:48.956296 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m18:39:48.958391 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m18:39:48.960296 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m18:39:48.962132 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m18:39:48.968511 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m18:39:48.976635 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.979199 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m18:39:48.981195 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:48.983776 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m18:39:48.985768 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:39:48.987907 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m18:39:48.989751 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:39:48.991869 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:39:48.999729 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m18:39:49.006909 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:49.009237 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:39:49.011513 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:49.015629 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m18:39:49.018541 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:39:49.021135 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m18:39:49.023133 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:39:49.025353 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:39:49.035555 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m18:39:49.066571 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:49.071272 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:39:49.075534 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:49.079763 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m18:39:49.082678 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:39:49.085568 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m18:39:49.088028 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:39:49.090371 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:39:49.098521 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m18:39:49.107331 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:49.110113 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:39:49.112663 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:49.116060 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m18:39:49.118933 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m18:39:49.122146 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m18:39:49.124519 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m18:39:49.127662 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m18:39:49.137039 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m18:39:49.147523 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:49.149942 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m18:39:49.152060 [debug] [Thread-1  ]: finished collecting timing info
[0m18:39:49.155121 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m18:39:49.159923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:49.162511 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m18:39:49.195819 [info ] [MainThread]: Done.
[0m18:39:49.239306 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m18:39:49.243169 [info ] [MainThread]: Building catalog
[0m18:39:49.247144 [debug] [ThreadPool]: Acquiring new snowflake connection "CS_DEV.information_schema"
[0m18:39:49.264325 [debug] [ThreadPool]: Using snowflake connection "CS_DEV.information_schema"
[0m18:39:49.273139 [debug] [ThreadPool]: On CS_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "CS_DEV.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from CS_DEV.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from CS_DEV.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('demo'))
      order by "column_index"
[0m18:39:49.277056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:51.699798 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.42 seconds
[0m18:39:51.723202 [debug] [ThreadPool]: On CS_DEV.information_schema: Close
[0m18:39:51.932385 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/mrr-playbook/target/catalog.json
[0m18:39:51.934872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3e453940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1e7032b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1e703ac0>]}
[0m18:39:51.936925 [debug] [MainThread]: Flushing usage events
[0m18:39:52.014557 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:39:52.018034 [debug] [MainThread]: Connection 'CS_DEV.information_schema' was properly closed.


============================== 2022-12-13 00:33:58.787378 | de510ab0-39f2-42c6-98a4-b32c30a98e8d ==============================
[0m00:33:58.787409 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:33:58.790018 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m00:33:58.791650 [debug] [MainThread]: Tracking: tracking
[0m00:33:58.794038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c65479a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c6547940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c65478e0>]}
[0m00:33:58.964195 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m00:33:58.967951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de510ab0-39f2-42c6-98a4-b32c30a98e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c6540760>]}
[0m00:33:59.330885 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m00:33:59.337706 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m00:33:59.342900 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:33:59.351486 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:33:59.470015 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m00:33:59.488313 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m00:33:59.492079 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m00:33:59.510528 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m00:33:59.522936 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m00:33:59.538164 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m00:33:59.548795 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m00:33:59.576831 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:33:59.580107 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:33:59.583122 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:33:59.585983 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:33:59.589196 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:33:59.592689 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m00:33:59.597807 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:33:59.611782 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:33:59.621778 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:33:59.631823 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:33:59.643517 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:33:59.673868 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:33:59.678959 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:33:59.685759 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:33:59.690539 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:33:59.701367 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:33:59.711602 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:33:59.718353 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:33:59.729410 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:33:59.742964 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:33:59.772935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:33:59.799095 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:33:59.818691 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:33:59.823279 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:33:59.827580 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:33:59.831508 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:33:59.838995 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:33:59.864437 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:33:59.888604 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:33:59.893592 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:33:59.917719 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:33:59.942491 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:33:59.949589 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:33:59.955570 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:33:59.982570 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:33:59.990341 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:33:59.995022 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:34:00.041752 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:34:00.049938 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:34:00.067552 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:34:00.084526 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:34:00.097152 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:34:00.100111 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:34:00.102434 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:34:00.104660 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:34:00.107285 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:34:00.109400 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:34:00.111862 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:34:00.114199 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:34:00.116465 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:34:00.126734 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:34:00.140079 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:34:00.150776 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:34:00.154454 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:34:00.160564 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:34:00.173771 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:34:00.180235 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:34:00.183821 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:34:00.187675 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:34:00.191059 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:34:00.195066 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:34:00.201310 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:34:00.205174 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:34:00.209741 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:34:00.220273 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:34:00.225318 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:34:00.229726 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:34:00.233688 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:34:00.237614 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:34:00.242461 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:34:00.247779 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:34:00.253843 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:34:00.258758 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:34:00.266476 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m00:34:00.272121 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m00:34:00.276304 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m00:34:00.281172 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m00:34:00.285104 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m00:34:00.292651 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m00:34:00.301996 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m00:34:00.306319 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m00:34:00.313150 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m00:34:00.330731 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m00:34:00.334088 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m00:34:00.337890 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m00:34:00.342015 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m00:34:00.345928 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m00:34:00.353812 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m00:34:00.358193 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m00:34:00.361974 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m00:34:00.366753 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m00:34:00.370350 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m00:34:00.375406 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m00:34:00.379574 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m00:34:00.383346 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m00:34:00.392443 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m00:34:00.395703 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m00:34:00.398524 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m00:34:00.401390 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m00:34:00.404341 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m00:34:00.450392 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m00:34:00.457161 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m00:34:00.461346 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m00:34:00.466900 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m00:34:00.471722 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m00:34:00.479671 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m00:34:00.484770 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m00:34:00.489414 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m00:34:00.508448 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m00:34:00.514671 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m00:34:00.519100 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m00:34:00.524669 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m00:34:00.529518 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m00:34:00.535364 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m00:34:00.541686 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m00:34:00.545779 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m00:34:00.549853 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m00:34:00.556539 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m00:34:00.565953 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m00:34:00.575119 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m00:34:00.584710 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m00:34:00.589403 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m00:34:00.595611 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m00:34:00.601792 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m00:34:00.613213 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m00:34:00.619881 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m00:34:00.625101 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m00:34:00.649810 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m00:34:00.658559 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m00:34:00.673793 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m00:34:00.688466 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m00:34:00.695917 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m00:34:00.711341 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m00:34:00.721614 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m00:34:00.744617 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m00:34:00.762201 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m00:34:00.767787 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m00:34:00.771642 [debug] [MainThread]: Parsing macros/web/get_url_path.sql


============================== 2022-12-13 00:34:00.848619 | 34fb8792-6d99-4dbf-9432-bd2859b786dc ==============================
[0m00:34:00.848693 [info ] [MainThread]: Running with dbt=1.3.0
[0m00:34:00.850631 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m00:34:00.853210 [debug] [MainThread]: Tracking: tracking
[0m00:34:00.855357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098a1e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098a1e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098a1e850>]}
[0m00:34:02.216019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:02.232729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:02.303266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34fb8792-6d99-4dbf-9432-bd2859b786dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09803f0d0>]}
[0m00:34:02.463297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34fb8792-6d99-4dbf-9432-bd2859b786dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098135c40>]}
[0m00:34:02.476708 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m00:34:02.489897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34fb8792-6d99-4dbf-9432-bd2859b786dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc098135a30>]}
[0m00:34:02.512471 [info ] [MainThread]: 
[0m00:34:02.527219 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m00:34:02.548382 [debug] [ThreadPool]: Acquiring new snowflake connection "list_CS_DEV_demo"
[0m00:34:02.661656 [debug] [ThreadPool]: Using snowflake connection "list_CS_DEV_demo"
[0m00:34:02.674069 [debug] [ThreadPool]: On list_CS_DEV_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_CS_DEV_demo"} */
show terse objects in CS_DEV.demo
[0m00:34:02.685780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:04.618526 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.93 seconds
[0m00:34:04.641222 [debug] [ThreadPool]: On list_CS_DEV_demo: Close
[0m00:34:04.861215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34fb8792-6d99-4dbf-9432-bd2859b786dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09800dc70>]}
[0m00:34:04.880478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:34:04.894402 [info ] [MainThread]: 
[0m00:34:04.997425 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m00:34:05.013323 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m00:34:05.025020 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m00:34:05.036227 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m00:34:05.164121 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m00:34:05.175019 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m00:34:05.185304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed


============================== 2023-01-12 16:00:30.008903 | 063c1b1b-cd6a-40fb-883d-7c3a4a3d1967 ==============================
[0m16:00:30.008925 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:00:30.012685 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:00:30.016496 [debug] [MainThread]: Tracking: tracking
[0m16:00:30.025380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1029b1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1029b12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1029b1b50>]}
[0m16:00:30.031521 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2b5kmwbr'
[0m16:00:30.034809 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:00:30.170285 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:00:30.173738 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:00:30.282919 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:00:30.437708 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:00:35.814700 [info ] [MainThread]:   Installed from version 0.8.0
[0m16:00:35.816658 [info ] [MainThread]:   Updated version available: 1.0.0
[0m16:00:35.818760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '063c1b1b-cd6a-40fb-883d-7c3a4a3d1967', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1029b1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1029cfd30>]}
[0m16:00:35.820485 [info ] [MainThread]: 
[0m16:00:35.822210 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:00:35.824225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc102a0f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1029b1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1029cff10>]}
[0m16:00:35.825872 [debug] [MainThread]: Flushing usage events


============================== 2023-01-12 16:12:25.563322 | 139352d3-535d-40e1-b7c1-87c5acf81121 ==============================
[0m16:12:25.563351 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:12:25.567468 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:12:25.570259 [debug] [MainThread]: Tracking: tracking
[0m16:12:25.579508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493361e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493361e1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493361e4f0>]}
[0m16:12:25.584783 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o8k9kd29'
[0m16:12:25.588193 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:12:25.723530 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:12:25.726586 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:12:25.836513 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:12:25.917285 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:12:30.186509 [info ] [MainThread]:   Installed from version 0.8.0
[0m16:12:30.188353 [info ] [MainThread]:   Updated version available: 1.0.0
[0m16:12:30.190286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '139352d3-535d-40e1-b7c1-87c5acf81121', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493358d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4936ef11c0>]}
[0m16:12:30.192057 [info ] [MainThread]: 
[0m16:12:30.193993 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:12:30.195925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493361d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49335a5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49335dc250>]}
[0m16:12:30.197668 [debug] [MainThread]: Flushing usage events


============================== 2023-01-12 16:21:05.354187 | 88b18a91-b65c-4ed2-b53a-2dc3c142c187 ==============================
[0m16:21:05.354208 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:21:05.363352 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:21:05.379468 [debug] [MainThread]: Tracking: tracking
[0m16:21:05.389589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf768cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf768ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf768cd30>]}
[0m16:21:05.399877 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5jbzdbrp'
[0m16:21:05.428684 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:21:05.558947 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:21:05.586664 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:21:05.697406 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:21:05.813936 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:21:12.394369 [info ] [MainThread]:   Installed from version 0.8.0
[0m16:21:12.398211 [info ] [MainThread]:   Updated version available: 1.0.0
[0m16:21:12.401166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '88b18a91-b65c-4ed2-b53a-2dc3c142c187', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf768cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf768cc40>]}
[0m16:21:12.404012 [info ] [MainThread]: 
[0m16:21:12.412801 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:21:12.416737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf76d5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf7697d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf768cd30>]}
[0m16:21:12.419669 [debug] [MainThread]: Flushing usage events


============================== 2023-01-12 16:21:19.186981 | d159398d-528e-4905-b742-9c150601969a ==============================
[0m16:21:19.187014 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:21:19.206178 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m16:21:19.223829 [debug] [MainThread]: Tracking: tracking
[0m16:21:19.243225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39a38f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39a38ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39a38e20>]}
[0m16:21:19.357515 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m16:21:19.361143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd159398d-528e-4905-b742-9c150601969a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39ae1490>]}
[0m16:21:19.976908 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m16:21:19.982154 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m16:21:19.986834 [debug] [MainThread]: Parsing macros/catalog.sql
[0m16:21:19.993276 [debug] [MainThread]: Parsing macros/adapters.sql
[0m16:21:20.084059 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m16:21:20.098336 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m16:21:20.103184 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m16:21:20.116157 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m16:21:20.120510 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m16:21:20.125865 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m16:21:20.138257 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m16:21:20.157436 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:21:20.162162 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:21:20.166051 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:21:20.170083 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:21:20.173436 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:21:20.180071 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m16:21:20.185868 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m16:21:20.222599 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m16:21:20.230896 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m16:21:20.240866 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m16:21:20.255754 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m16:21:20.298743 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m16:21:20.305376 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m16:21:20.315166 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m16:21:20.320376 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m16:21:20.335178 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m16:21:20.349361 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m16:21:20.358362 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m16:21:20.372186 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m16:21:20.388967 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m16:21:20.430030 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m16:21:20.463074 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m16:21:20.487809 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m16:21:20.493883 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m16:21:20.500497 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m16:21:20.505946 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m16:21:20.516604 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m16:21:20.553203 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m16:21:20.576929 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m16:21:20.583246 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m16:21:20.609894 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m16:21:20.637832 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m16:21:20.643967 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m16:21:20.652095 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m16:21:20.667839 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m16:21:20.676216 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m16:21:20.681913 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m16:21:20.710106 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m16:21:20.722052 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m16:21:20.743391 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m16:21:20.763836 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m16:21:20.779230 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m16:21:20.784361 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m16:21:20.789216 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m16:21:20.821673 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m16:21:20.830534 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m16:21:20.835416 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m16:21:20.841032 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m16:21:20.849810 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m16:21:20.855842 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m16:21:20.875633 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m16:21:20.900638 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m16:21:20.908320 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m16:21:20.914503 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m16:21:20.919372 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m16:21:20.931459 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m16:21:20.937302 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m16:21:20.941694 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m16:21:20.948212 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m16:21:20.952656 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m16:21:20.957184 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m16:21:20.963451 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m16:21:20.967867 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m16:21:20.973618 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m16:21:20.980452 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m16:21:20.984797 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m16:21:20.988671 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m16:21:20.992122 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m16:21:20.996080 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m16:21:21.001051 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m16:21:21.005977 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m16:21:21.012958 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m16:21:21.018360 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m16:21:21.025850 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m16:21:21.031610 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m16:21:21.035789 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m16:21:21.040720 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m16:21:21.045236 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m16:21:21.054357 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m16:21:21.068045 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m16:21:21.073257 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m16:21:21.081865 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m16:21:21.103393 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m16:21:21.108756 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m16:21:21.115380 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m16:21:21.121782 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m16:21:21.126185 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m16:21:21.137010 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m16:21:21.142170 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m16:21:21.147121 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m16:21:21.152149 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m16:21:21.157120 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m16:21:21.163991 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m16:21:21.170066 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m16:21:21.175566 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m16:21:21.188442 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m16:21:21.193164 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m16:21:21.198889 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m16:21:21.203581 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m16:21:21.207887 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m16:21:21.255945 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m16:21:21.266080 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m16:21:21.272662 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m16:21:21.280261 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m16:21:21.286259 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m16:21:21.296285 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m16:21:21.302398 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m16:21:21.309038 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m16:21:21.329493 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m16:21:21.336503 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m16:21:21.341259 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m16:21:21.348767 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m16:21:21.355027 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m16:21:21.361827 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m16:21:21.369941 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m16:21:21.375243 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m16:21:21.381192 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m16:21:21.388331 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m16:21:21.399484 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m16:21:21.411338 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m16:21:21.423564 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m16:21:21.432063 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m16:21:21.440484 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m16:21:21.450035 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m16:21:21.466683 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m16:21:21.473346 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m16:21:21.478954 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m16:21:21.494366 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m16:21:21.501179 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m16:21:21.506402 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m16:21:21.516520 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m16:21:21.522813 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m16:21:21.533384 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m16:21:21.541869 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m16:21:21.567866 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m16:21:21.587782 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m16:21:21.595757 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m16:21:21.601565 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m16:21:22.275230 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m16:21:22.299567 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m16:21:22.307385 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m16:21:22.330176 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m16:21:22.358575 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m16:21:22.365442 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m16:21:22.413901 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m16:21:22.592273 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m16:21:22.726208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd159398d-528e-4905-b742-9c150601969a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3c843dc0>]}
[0m16:21:22.757862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd159398d-528e-4905-b742-9c150601969a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39a36c10>]}
[0m16:21:22.760108 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m16:21:22.762411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd159398d-528e-4905-b742-9c150601969a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39adfa00>]}
[0m16:21:22.765356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39adf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c39a36df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5b4c5e80>]}
[0m16:21:22.767458 [debug] [MainThread]: Flushing usage events


============================== 2023-01-12 16:24:26.305803 | 42d8006b-6fd0-4035-bedc-4fbdb3a8f4cc ==============================
[0m16:24:26.305829 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:24:26.307599 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m16:24:26.309276 [debug] [MainThread]: Tracking: tracking
[0m16:24:26.311640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06a37fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06a37f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06a37eb0>]}
[0m16:24:26.638222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:26.640238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:26.650343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42d8006b-6fd0-4035-bedc-4fbdb3a8f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f05fcaf10>]}
[0m16:24:26.694804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42d8006b-6fd0-4035-bedc-4fbdb3a8f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06010f70>]}
[0m16:24:26.697884 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m16:24:26.702335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d8006b-6fd0-4035-bedc-4fbdb3a8f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06a9a8b0>]}
[0m16:24:26.707734 [info ] [MainThread]: 
[0m16:24:26.711328 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m16:24:26.718457 [debug] [ThreadPool]: Acquiring new snowflake connection "list_CS_DEV_demo"
[0m16:24:26.752076 [debug] [ThreadPool]: Using snowflake connection "list_CS_DEV_demo"
[0m16:24:26.756465 [debug] [ThreadPool]: On list_CS_DEV_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_CS_DEV_demo"} */
show terse objects in CS_DEV.demo
[0m16:24:26.759722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:27.504440 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.74 seconds
[0m16:24:27.512692 [debug] [ThreadPool]: On list_CS_DEV_demo: Close
[0m16:24:27.683616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d8006b-6fd0-4035-bedc-4fbdb3a8f4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06010d90>]}
[0m16:24:27.687523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:27.690896 [info ] [MainThread]: 
[0m16:24:27.712481 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m16:24:27.715583 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m16:24:27.717951 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m16:24:27.720523 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m16:24:27.746655 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m16:24:27.748953 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m16:24:27.750951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:24:28.438864 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m16:24:28.463024 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m16:24:28.493723 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.496722 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m16:24:28.499265 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.502079 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m16:24:28.741680 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m16:24:28.743539 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m16:24:28.745799 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.acme.subscription_periods"
[0m16:24:28.747584 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m16:24:28.749390 [debug] [Thread-1  ]: Compiling seed.acme.subscription_periods
[0m16:24:28.753962 [debug] [Thread-1  ]: Writing injected SQL for node "seed.acme.subscription_periods"
[0m16:24:28.755973 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.757705 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m16:24:28.759589 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.762542 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m16:24:28.767028 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m16:24:28.769507 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_revenue_by_month"
[0m16:24:28.771436 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m16:24:28.773962 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m16:24:28.779968 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m16:24:28.791311 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.794553 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m16:24:28.796571 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.799234 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m16:24:28.801178 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m16:24:28.803288 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670"
[0m16:24:28.804957 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m16:24:28.806815 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m16:24:28.825005 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670"
[0m16:24:28.842519 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.844981 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m16:24:28.847005 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.850066 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m16:24:28.852377 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m16:24:28.854435 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd"
[0m16:24:28.856116 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m16:24:28.857682 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m16:24:28.865271 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd"
[0m16:24:28.873901 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.876963 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m16:24:28.878691 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.880815 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m16:24:28.882638 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m16:24:28.885122 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa"
[0m16:24:28.886766 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m16:24:28.888281 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m16:24:28.910245 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa"
[0m16:24:28.919788 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.922008 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m16:24:28.923957 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.926266 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m16:24:28.928000 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m16:24:28.930112 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_churn_month"
[0m16:24:28.931621 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m16:24:28.933554 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m16:24:28.938500 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m16:24:28.944610 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.946251 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m16:24:28.947953 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.950478 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m16:24:28.952489 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m16:24:28.954564 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m16:24:28.956246 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m16:24:28.958026 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m16:24:28.975141 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m16:24:28.992623 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.994948 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m16:24:28.997340 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:28.999896 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m16:24:29.002028 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m16:24:29.004193 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m16:24:29.005870 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m16:24:29.007679 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m16:24:29.026109 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m16:24:29.103574 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m16:24:29.113505 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.115985 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m16:24:29.118601 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.122010 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m16:24:29.124499 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m16:24:29.127249 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m16:24:29.129514 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m16:24:29.132745 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m16:24:29.148294 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m16:24:29.156962 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.159119 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m16:24:29.161178 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.164173 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m16:24:29.166851 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m16:24:29.169978 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m16:24:29.172358 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m16:24:29.174822 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m16:24:29.185974 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m16:24:29.192963 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.194958 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m16:24:29.196960 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.199468 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m16:24:29.201928 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m16:24:29.204329 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m16:24:29.206085 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m16:24:29.207849 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m16:24:29.217002 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m16:24:29.241775 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.243869 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m16:24:29.245567 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.248112 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m16:24:29.250233 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m16:24:29.252859 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m16:24:29.254813 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m16:24:29.256758 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m16:24:29.265855 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m16:24:29.274034 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.275863 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m16:24:29.277889 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.281487 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m16:24:29.283601 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m16:24:29.285923 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m16:24:29.287851 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m16:24:29.289916 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m16:24:29.296357 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m16:24:29.302100 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.304074 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m16:24:29.305852 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.307970 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m16:24:29.309665 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m16:24:29.311793 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m16:24:29.313729 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m16:24:29.315567 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m16:24:29.324383 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m16:24:29.342046 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.344256 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m16:24:29.346508 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.348941 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m16:24:29.351149 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m16:24:29.353445 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m16:24:29.355263 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m16:24:29.357138 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m16:24:29.364812 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m16:24:29.371976 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.373846 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m16:24:29.375691 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.378072 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m16:24:29.379998 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m16:24:29.382211 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_id.45914052fb"
[0m16:24:29.384154 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m16:24:29.386003 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m16:24:29.392569 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m16:24:29.399056 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.401414 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m16:24:29.403698 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.406477 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m16:24:29.408579 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m16:24:29.410828 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m16:24:29.413610 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m16:24:29.415505 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m16:24:29.423212 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m16:24:29.441940 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.444174 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m16:24:29.446191 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.449045 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m16:24:29.451360 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m16:24:29.454051 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m16:24:29.455980 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m16:24:29.457743 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m16:24:29.465607 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m16:24:29.473483 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.475282 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m16:24:29.477223 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.479502 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m16:24:29.481576 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m16:24:29.484109 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m16:24:29.486505 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m16:24:29.488396 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m16:24:29.496105 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m16:24:29.504555 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.506928 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m16:24:29.508858 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.511616 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m16:24:29.513980 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m16:24:29.516476 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m16:24:29.518790 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m16:24:29.521047 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m16:24:29.530221 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m16:24:29.541529 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.543647 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m16:24:29.545657 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.548250 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m16:24:29.550478 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m16:24:29.552534 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m16:24:29.554156 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m16:24:29.555676 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m16:24:29.561902 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m16:24:29.567854 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.569917 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m16:24:29.571424 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.573617 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m16:24:29.575197 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m16:24:29.577152 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m16:24:29.578681 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m16:24:29.580349 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m16:24:29.586767 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m16:24:29.592246 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.594152 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m16:24:29.596073 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.598402 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m16:24:29.600020 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m16:24:29.601973 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m16:24:29.603528 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m16:24:29.605146 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m16:24:29.611282 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m16:24:29.617815 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.619653 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m16:24:29.621457 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.623700 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m16:24:29.625269 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m16:24:29.627247 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m16:24:29.628823 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m16:24:29.630480 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m16:24:29.637026 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m16:24:29.642809 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.644700 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m16:24:29.646357 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.648995 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m16:24:29.650680 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m16:24:29.652757 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m16:24:29.654243 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m16:24:29.655797 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m16:24:29.661890 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m16:24:29.668971 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.671615 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m16:24:29.673297 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:29.675207 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m16:24:29.678052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:29.679921 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m16:24:29.705648 [info ] [MainThread]: Done.
[0m16:24:29.740244 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m16:24:29.741748 [info ] [MainThread]: Building catalog
[0m16:24:29.744827 [debug] [ThreadPool]: Acquiring new snowflake connection "CS_DEV.information_schema"
[0m16:24:29.755422 [debug] [ThreadPool]: Using snowflake connection "CS_DEV.information_schema"
[0m16:24:29.758035 [debug] [ThreadPool]: On CS_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "CS_DEV.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from CS_DEV.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from CS_DEV.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('demo'))
      order by "column_index"
[0m16:24:29.760227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:31.923327 [debug] [ThreadPool]: SQL status: SUCCESS 157 in 2.16 seconds
[0m16:24:31.976996 [debug] [ThreadPool]: On CS_DEV.information_schema: Close
[0m16:24:32.265023 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/mrr-playbook/target/catalog.json
[0m16:24:32.268704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06a37fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f26a42e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f04fdbf10>]}
[0m16:24:32.273659 [debug] [MainThread]: Flushing usage events
[0m16:24:32.348427 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:24:32.351657 [debug] [MainThread]: Connection 'CS_DEV.information_schema' was properly closed.


============================== 2023-01-12 16:24:38.791673 | ef3bd45b-df0e-403f-bb89-1d7b5144fdce ==============================
[0m16:24:38.791708 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:24:38.794350 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:24:38.797568 [debug] [MainThread]: Tracking: tracking
[0m16:24:38.820670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a1ec5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a1ec640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a1ec6a0>]}
[0m16:24:39.059815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:39.061760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:39.071669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef3bd45b-df0e-403f-bb89-1d7b5144fdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7289fa50d0>]}
[0m16:24:39.105185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef3bd45b-df0e-403f-bb89-1d7b5144fdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a0d6c70>]}
[0m16:24:39.107003 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m16:24:39.109142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef3bd45b-df0e-403f-bb89-1d7b5144fdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a0d6a60>]}
[0m16:24:39.112757 [info ] [MainThread]: 
[0m16:24:39.115199 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m16:24:39.117812 [debug] [ThreadPool]: Acquiring new snowflake connection "list_CS_DEV"
[0m16:24:39.136276 [debug] [ThreadPool]: Using snowflake connection "list_CS_DEV"
[0m16:24:39.138772 [debug] [ThreadPool]: On list_CS_DEV: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_CS_DEV"} */
show terse schemas in database CS_DEV
    limit 10000
[0m16:24:39.140827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:39.836106 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.7 seconds
[0m16:24:39.841343 [debug] [ThreadPool]: On list_CS_DEV: Close
[0m16:24:39.987801 [debug] [ThreadPool]: Acquiring new snowflake connection "list_CS_DEV_demo"
[0m16:24:39.998331 [debug] [ThreadPool]: Using snowflake connection "list_CS_DEV_demo"
[0m16:24:40.000147 [debug] [ThreadPool]: On list_CS_DEV_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_CS_DEV_demo"} */
show terse objects in CS_DEV.demo
[0m16:24:40.001989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:40.723094 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.72 seconds
[0m16:24:40.729634 [debug] [ThreadPool]: On list_CS_DEV_demo: Close
[0m16:24:40.886975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef3bd45b-df0e-403f-bb89-1d7b5144fdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a1ee970>]}
[0m16:24:40.890707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:40.893490 [info ] [MainThread]: 
[0m16:24:40.913879 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m16:24:40.919020 [info ] [Thread-1  ]: 1 of 4 START sql view model demo.util_months ................................... [RUN]
[0m16:24:40.922564 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m16:24:40.924998 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m16:24:40.926977 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m16:24:40.955927 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m16:24:40.958671 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m16:24:40.962214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:24:41.500926 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.54 seconds
[0m16:24:41.528462 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m16:24:41.540981 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:41.543551 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m16:24:41.590785 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m16:24:41.625965 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m16:24:41.628392 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view CS_DEV.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 60
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m16:24:41.827685 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m16:24:41.858674 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:41.861252 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m16:24:42.030837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3bd45b-df0e-403f-bb89-1d7b5144fdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7288fb1bb0>]}
[0m16:24:42.034323 [info ] [Thread-1  ]: 1 of 4 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.11s]
[0m16:24:42.038018 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m16:24:42.042326 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m16:24:42.045591 [info ] [Thread-1  ]: 2 of 4 START sql view model demo.customer_revenue_by_month ..................... [RUN]
[0m16:24:42.049799 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_revenue_by_month"
[0m16:24:42.054581 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m16:24:42.057980 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m16:24:42.068456 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m16:24:42.089220 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:42.091991 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m16:24:42.101006 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m16:24:42.113780 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_revenue_by_month"
[0m16:24:42.116151 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
create or replace  view CS_DEV.demo.customer_revenue_by_month
  
   as (
    with subscription_periods as (

    select * from CS_DEV.demo.subscription_periods

),

months as (

    select * from CS_DEV.demo.util_months

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m16:24:42.118528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:24:42.933211 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
[0m16:24:42.938634 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:42.941173 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m16:24:43.086726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3bd45b-df0e-403f-bb89-1d7b5144fdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7288fda0a0>]}
[0m16:24:43.090476 [info ] [Thread-1  ]: 2 of 4 OK created sql view model demo.customer_revenue_by_month ................ [[32mSUCCESS 1[0m in 1.04s]
[0m16:24:43.092877 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m16:24:43.095963 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m16:24:43.098237 [info ] [Thread-1  ]: 3 of 4 START sql view model demo.customer_churn_month .......................... [RUN]
[0m16:24:43.100866 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_churn_month"
[0m16:24:43.102794 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m16:24:43.104787 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m16:24:43.110992 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m16:24:43.117872 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:43.119864 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m16:24:43.125611 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m16:24:43.135331 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_churn_month"
[0m16:24:43.138133 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
create or replace  view CS_DEV.demo.customer_churn_month
  
   as (
    with mrr as (

    select * from CS_DEV.demo.customer_revenue_by_month

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m16:24:43.141197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:24:44.045200 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.9 seconds
[0m16:24:44.050757 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:44.054123 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m16:24:44.203389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3bd45b-df0e-403f-bb89-1d7b5144fdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7289e56880>]}
[0m16:24:44.207053 [info ] [Thread-1  ]: 3 of 4 OK created sql view model demo.customer_churn_month ..................... [[32mSUCCESS 1[0m in 1.10s]
[0m16:24:44.209989 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m16:24:44.213469 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m16:24:44.215856 [info ] [Thread-1  ]: 4 of 4 START sql view model demo.mrr ........................................... [RUN]
[0m16:24:44.218607 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m16:24:44.220727 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m16:24:44.222744 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m16:24:44.241454 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m16:24:44.253546 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m16:24:44.260199 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:44.262552 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m16:24:44.270551 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m16:24:44.283584 [debug] [Thread-1  ]: Using snowflake connection "model.acme.mrr"
[0m16:24:44.285459 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
create or replace  view CS_DEV.demo.mrr
  
   as (
    with unioned as (

    select * from CS_DEV.demo.customer_revenue_by_month

    union all

    select * from CS_DEV.demo.customer_churn_month

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m16:24:44.288598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:24:45.864824 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.58 seconds
[0m16:24:45.871171 [debug] [Thread-1  ]: finished collecting timing info
[0m16:24:45.873944 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m16:24:46.076049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3bd45b-df0e-403f-bb89-1d7b5144fdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72886f0190>]}
[0m16:24:46.080389 [info ] [Thread-1  ]: 4 of 4 OK created sql view model demo.mrr ...................................... [[32mSUCCESS 1[0m in 1.86s]
[0m16:24:46.083647 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m16:24:46.088811 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m16:24:46.091489 [info ] [MainThread]: 
[0m16:24:46.093787 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.98 seconds (6.98s).
[0m16:24:46.095967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:46.098013 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m16:24:46.131899 [info ] [MainThread]: 
[0m16:24:46.134078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:46.136360 [info ] [MainThread]: 
[0m16:24:46.138471 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:24:46.140562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72890d2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72890d22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72890d23a0>]}
[0m16:24:46.142276 [debug] [MainThread]: Flushing usage events


============================== 2023-01-13 15:44:20.088056 | 767233a9-d97d-4dde-8a3d-6599c06650d2 ==============================
[0m15:44:20.088081 [info ] [MainThread]: Running with dbt=1.3.2
[0m15:44:20.089583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:44:20.092496 [debug] [MainThread]: Tracking: tracking
[0m15:44:20.094432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de5919850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de59197f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de5919760>]}
[0m15:44:20.202982 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.3.0. Current version: 1.3.2.
[0m15:44:20.204868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '767233a9-d97d-4dde-8a3d-6599c06650d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de59a8970>]}
[0m15:44:20.699483 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m15:44:20.702972 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m15:44:20.705808 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:44:20.710198 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:44:20.780779 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m15:44:20.790786 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m15:44:20.793508 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m15:44:20.803282 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m15:44:20.806276 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m15:44:20.809610 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m15:44:20.816619 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m15:44:20.832987 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:44:20.835398 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:44:20.838247 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:44:20.840643 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:44:20.843090 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:44:20.845260 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m15:44:20.849234 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m15:44:20.859009 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:44:20.864191 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:44:20.871607 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:44:20.883763 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:44:20.915506 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:44:20.920725 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:44:20.926867 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:44:20.930035 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:44:20.939590 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:44:20.949369 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:44:20.956278 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m15:44:20.967278 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:44:20.981986 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:44:21.014144 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:44:21.039726 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:44:21.056338 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:44:21.061285 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:44:21.065505 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:44:21.069404 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:44:21.077175 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:44:21.102060 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:44:21.122959 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:44:21.128139 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:44:21.151962 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:44:21.174072 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:44:21.179552 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:44:21.185339 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:44:21.199050 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m15:44:21.206465 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:44:21.211561 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:44:21.235954 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:44:21.244827 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:44:21.265099 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:44:21.286030 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:44:21.298725 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m15:44:21.303724 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:44:21.308450 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:44:21.313166 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:44:21.317434 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:44:21.321774 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:44:21.326293 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:44:21.330691 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:44:21.335203 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:44:21.348941 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:44:21.353640 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:44:21.357516 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:44:21.362099 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:44:21.366993 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:44:21.373222 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:44:21.377732 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:44:21.381966 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:44:21.386985 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m15:44:21.390665 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:44:21.394032 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:44:21.398298 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:44:21.400950 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:44:21.404541 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:44:21.409453 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:44:21.412280 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:44:21.415228 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:44:21.417963 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:44:21.420598 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:44:21.424156 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:44:21.428357 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:44:21.433636 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:44:21.438140 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:44:21.445096 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m15:44:21.449895 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m15:44:21.452996 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m15:44:21.456437 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m15:44:21.459832 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m15:44:21.467680 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m15:44:21.477701 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m15:44:21.482009 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m15:44:21.487785 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m15:44:21.504877 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m15:44:21.508574 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m15:44:21.512502 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m15:44:21.516138 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m15:44:21.518867 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m15:44:21.525547 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m15:44:21.529187 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m15:44:21.532184 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m15:44:21.536186 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m15:44:21.539448 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m15:44:21.544083 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m15:44:21.548198 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m15:44:21.553800 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m15:44:21.563421 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:44:21.566647 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:44:21.570138 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:44:21.573790 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:44:21.577369 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m15:44:21.622851 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m15:44:21.629700 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m15:44:21.633685 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m15:44:21.638092 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m15:44:21.641641 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m15:44:21.647968 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m15:44:21.652208 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m15:44:21.656323 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m15:44:21.672685 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m15:44:21.677540 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m15:44:21.681350 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m15:44:21.686376 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m15:44:21.690368 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m15:44:21.695374 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m15:44:21.700629 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m15:44:21.703873 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m15:44:21.707123 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m15:44:21.712680 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:44:21.721381 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:44:21.730298 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:44:21.739310 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:44:21.744658 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:44:21.751675 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:44:21.758574 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:44:21.770244 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:44:21.774415 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:44:21.777824 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:44:21.788146 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:44:21.791944 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:44:21.795661 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:44:21.803155 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:44:21.806963 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:44:21.814764 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:44:21.821313 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:44:21.834960 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:44:21.849130 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:44:21.854200 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:44:21.858210 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:44:22.455126 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m15:44:22.475169 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m15:44:22.481916 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m15:44:22.499706 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m15:44:22.515442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m15:44:22.521014 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m15:44:22.565336 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m15:44:22.737130 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m15:44:22.879295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '767233a9-d97d-4dde-8a3d-6599c06650d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de486b0d0>]}
[0m15:44:22.925316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '767233a9-d97d-4dde-8a3d-6599c06650d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e07d146a0>]}
[0m15:44:22.927394 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m15:44:22.929196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '767233a9-d97d-4dde-8a3d-6599c06650d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de58f2340>]}
[0m15:44:22.933087 [info ] [MainThread]: 
[0m15:44:22.935704 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:44:22.938422 [debug] [ThreadPool]: Acquiring new snowflake connection "list_CS_DEV_demo"
[0m15:44:22.950219 [debug] [ThreadPool]: Using snowflake connection "list_CS_DEV_demo"
[0m15:44:22.952235 [debug] [ThreadPool]: On list_CS_DEV_demo: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_CS_DEV_demo"} */
show terse objects in CS_DEV.demo
[0m15:44:22.954513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:24.140214 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.19 seconds
[0m15:44:24.144901 [debug] [ThreadPool]: On list_CS_DEV_demo: Close
[0m15:44:24.332735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '767233a9-d97d-4dde-8a3d-6599c06650d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de48b8610>]}
[0m15:44:24.336373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:24.338690 [info ] [MainThread]: 
[0m15:44:24.354934 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m15:44:24.358130 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m15:44:24.360114 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m15:44:24.362134 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m15:44:24.372293 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:44:24.374629 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m15:44:24.376859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:25.019399 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m15:44:25.025807 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m15:44:25.035292 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.037589 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m15:44:25.039368 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.040845 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m15:44:25.217312 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m15:44:25.220922 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m15:44:25.223437 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.acme.subscription_periods"
[0m15:44:25.225146 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m15:44:25.226988 [debug] [Thread-1  ]: Compiling seed.acme.subscription_periods
[0m15:44:25.230998 [debug] [Thread-1  ]: Writing injected SQL for node "seed.acme.subscription_periods"
[0m15:44:25.233355 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.235385 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m15:44:25.237321 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.239707 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m15:44:25.242787 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m15:44:25.245707 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_revenue_by_month"
[0m15:44:25.247552 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m15:44:25.249206 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m15:44:25.255822 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m15:44:25.263143 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.264961 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m15:44:25.266459 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.268675 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m15:44:25.270510 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m15:44:25.273123 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670"
[0m15:44:25.276086 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m15:44:25.277971 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m15:44:25.286093 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670"
[0m15:44:25.296113 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.298529 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m15:44:25.300076 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.302282 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_end_date_end_date.5f773b4670
[0m15:44:25.304026 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m15:44:25.306025 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd"
[0m15:44:25.307746 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m15:44:25.309450 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m15:44:25.316446 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd"
[0m15:44:25.322968 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.325304 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m15:44:25.327324 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.329787 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_subscription_periods_date_trunc_month_start_date_start_date.abd2cf4dfd
[0m15:44:25.331557 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m15:44:25.334588 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa"
[0m15:44:25.336302 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m15:44:25.338134 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m15:44:25.346824 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa"
[0m15:44:25.364299 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.366173 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m15:44:25.367967 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.370111 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_mutually_exclusive_ranges_subscription_periods_start_date__customer_id__end_date.a4c8bc64fa
[0m15:44:25.371746 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m15:44:25.373961 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_churn_month"
[0m15:44:25.375525 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m15:44:25.377780 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m15:44:25.383371 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m15:44:25.391161 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.393223 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m15:44:25.395155 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.397392 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m15:44:25.399114 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m15:44:25.401090 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m15:44:25.402727 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m15:44:25.404359 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m15:44:25.412238 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m15:44:25.417970 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.419741 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m15:44:25.421440 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.423737 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m15:44:25.425232 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m15:44:25.427193 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m15:44:25.429034 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m15:44:25.430867 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m15:44:25.438806 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m15:44:25.442128 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m15:44:25.463955 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.465960 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m15:44:25.467939 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.470164 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m15:44:25.471823 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m15:44:25.473904 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m15:44:25.475661 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m15:44:25.477283 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m15:44:25.489528 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m15:44:25.495905 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.497765 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m15:44:25.499494 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.501518 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m15:44:25.503225 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m15:44:25.505470 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m15:44:25.508127 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m15:44:25.509580 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m15:44:25.518415 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m15:44:25.525341 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.527183 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m15:44:25.528797 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.530844 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m15:44:25.532588 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m15:44:25.534563 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m15:44:25.536051 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m15:44:25.537578 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m15:44:25.545773 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m15:44:25.565053 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.567671 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m15:44:25.570302 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.573047 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m15:44:25.574943 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m15:44:25.577416 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m15:44:25.580273 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m15:44:25.582851 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m15:44:25.592237 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m15:44:25.615194 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.617944 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m15:44:25.620818 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.624046 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m15:44:25.626535 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m15:44:25.629455 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m15:44:25.632014 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m15:44:25.634493 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m15:44:25.643298 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m15:44:25.665425 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.668666 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m15:44:25.673837 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.677003 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m15:44:25.680216 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m15:44:25.683747 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m15:44:25.686839 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m15:44:25.690159 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m15:44:25.700714 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m15:44:25.714827 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.717509 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m15:44:25.720563 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.723863 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m15:44:25.726746 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m15:44:25.729912 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m15:44:25.733040 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m15:44:25.737054 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m15:44:25.748332 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m15:44:25.765405 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.768501 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m15:44:25.771266 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.774563 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m15:44:25.777087 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m15:44:25.780785 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_id.45914052fb"
[0m15:44:25.784639 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m15:44:25.788180 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m15:44:25.798983 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m15:44:25.815777 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.819496 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m15:44:25.822563 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.826248 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m15:44:25.828861 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m15:44:25.832263 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m15:44:25.835553 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m15:44:25.838673 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m15:44:25.849517 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m15:44:25.866381 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.870800 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m15:44:25.874207 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.877828 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m15:44:25.881175 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m15:44:25.886888 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m15:44:25.893721 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m15:44:25.897674 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m15:44:25.909446 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m15:44:25.921995 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.925015 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m15:44:25.927869 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.932628 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m15:44:25.937308 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m15:44:25.941575 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m15:44:25.944948 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m15:44:25.948448 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m15:44:25.959176 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m15:44:25.971126 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.975272 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m15:44:25.979283 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:25.985575 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m15:44:25.989696 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m15:44:25.994758 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m15:44:25.998757 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m15:44:26.002149 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m15:44:26.017427 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m15:44:26.030234 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.033981 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m15:44:26.039306 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.044176 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m15:44:26.048237 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m15:44:26.052334 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m15:44:26.055513 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m15:44:26.058217 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m15:44:26.068017 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m15:44:26.076170 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.078518 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m15:44:26.081116 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.085325 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m15:44:26.088460 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m15:44:26.094176 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m15:44:26.096810 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m15:44:26.099382 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m15:44:26.108531 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m15:44:26.117031 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.120761 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m15:44:26.123466 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.127153 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m15:44:26.130053 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m15:44:26.133719 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m15:44:26.136697 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m15:44:26.139565 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m15:44:26.149493 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m15:44:26.164313 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.166511 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m15:44:26.169003 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.171880 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m15:44:26.174305 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m15:44:26.177096 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m15:44:26.179125 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m15:44:26.181251 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m15:44:26.190676 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m15:44:26.215770 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.218906 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m15:44:26.221372 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.224368 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m15:44:26.226695 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m15:44:26.229507 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m15:44:26.231743 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m15:44:26.234258 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m15:44:26.244882 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m15:44:26.265235 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.267519 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m15:44:26.270030 [debug] [Thread-1  ]: finished collecting timing info
[0m15:44:26.273136 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m15:44:26.277072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:26.279138 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m15:44:26.327868 [info ] [MainThread]: Done.
[0m15:44:26.369656 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m15:44:26.371300 [info ] [MainThread]: Building catalog
[0m15:44:26.374291 [debug] [ThreadPool]: Acquiring new snowflake connection "CS_DEV.information_schema"
[0m15:44:26.384870 [debug] [ThreadPool]: Using snowflake connection "CS_DEV.information_schema"
[0m15:44:26.387096 [debug] [ThreadPool]: On CS_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "CS_DEV.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from CS_DEV.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from CS_DEV.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('demo'))
      order by "column_index"
[0m15:44:26.389650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:28.751309 [debug] [ThreadPool]: SQL status: SUCCESS 157 in 2.36 seconds
[0m15:44:28.799354 [debug] [ThreadPool]: On CS_DEV.information_schema: Close
[0m15:44:29.171750 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/mrr-playbook/target/catalog.json
[0m15:44:29.174956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de5919850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de416bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de416baf0>]}
[0m15:44:29.177703 [debug] [MainThread]: Flushing usage events
[0m15:44:29.337447 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:44:29.339986 [debug] [MainThread]: Connection 'CS_DEV.information_schema' was properly closed.


============================== 2023-02-01 20:47:52.500474 | 1aecd93b-78ef-4cfe-aebf-db899e79b521 ==============================
[0m20:47:52.500503 [info ] [MainThread]: Running with dbt=1.3.0
[0m20:47:52.502824 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:47:52.505745 [debug] [MainThread]: Tracking: tracking
[0m20:47:52.508967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f4506550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f45065b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f4506610>]}
[0m20:47:52.718138 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.3.2. Current version: 1.3.0.
[0m20:47:52.723021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1aecd93b-78ef-4cfe-aebf-db899e79b521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f4520490>]}
[0m20:47:53.372056 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m20:47:53.376825 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m20:47:53.380820 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:47:53.386903 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:47:53.461378 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m20:47:53.473919 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m20:47:53.478099 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m20:47:53.506075 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m20:47:53.517370 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m20:47:53.537389 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m20:47:53.561901 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m20:47:53.580082 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:47:53.583046 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:47:53.586055 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:47:53.589099 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:47:53.592531 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m20:47:53.595321 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m20:47:53.600826 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m20:47:53.612332 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:47:53.619151 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:47:53.629735 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:47:53.643377 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:47:53.683874 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:47:53.690853 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:47:53.699939 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:47:53.705129 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:47:53.718660 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:47:53.731601 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:47:53.739287 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m20:47:53.759182 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:47:53.773948 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:47:53.813395 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:47:53.841760 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:47:53.859977 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:47:53.864449 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:47:53.869307 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:47:53.874171 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:47:53.883353 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:47:53.910770 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:47:53.935625 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:47:53.941696 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:47:53.966522 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:47:53.990382 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:47:53.996756 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:47:54.002710 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:47:54.016622 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m20:47:54.024416 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:47:54.030035 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:47:54.056209 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:47:54.065286 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:47:54.084043 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:47:54.100480 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:47:54.110644 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m20:47:54.114497 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:47:54.117852 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:47:54.121420 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:47:54.125918 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:47:54.129757 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:47:54.133650 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:47:54.138048 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:47:54.142556 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:47:54.155578 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:47:54.159727 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:47:54.163668 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:47:54.167900 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:47:54.172567 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:47:54.179028 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:47:54.183411 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:47:54.188227 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m20:47:54.193866 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m20:47:54.199457 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:47:54.204567 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:47:54.212250 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:47:54.217597 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:47:54.222982 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:47:54.231805 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:47:54.237106 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:47:54.241911 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:47:54.246129 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:47:54.251115 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:47:54.258669 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:47:54.269040 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:47:54.287088 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:47:54.294225 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:47:54.312321 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m20:47:54.321744 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m20:47:54.328157 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m20:47:54.335317 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m20:47:54.340928 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m20:47:54.354893 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m20:47:54.385472 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m20:47:54.393862 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m20:47:54.402550 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m20:47:54.430628 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m20:47:54.436026 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m20:47:54.441865 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m20:47:54.450765 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m20:47:54.456671 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m20:47:54.471511 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m20:47:54.479549 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m20:47:54.486060 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m20:47:54.494368 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m20:47:54.500732 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m20:47:54.510764 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m20:47:54.517581 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m20:47:54.526737 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m20:47:54.544547 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m20:47:54.553361 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m20:47:54.560230 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m20:47:54.568126 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m20:47:54.576956 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m20:47:54.649862 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m20:47:54.659471 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m20:47:54.673692 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m20:47:54.684360 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m20:47:54.692365 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m20:47:54.707590 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m20:47:54.714864 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m20:47:54.723806 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m20:47:54.762076 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m20:47:54.771342 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m20:47:54.780184 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m20:47:54.790400 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m20:47:54.797507 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m20:47:54.807843 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m20:47:54.924072 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m20:47:54.987084 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m20:47:54.998453 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m20:47:55.021365 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m20:47:55.053076 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m20:47:55.106509 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m20:47:55.128386 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m20:47:55.135854 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m20:47:55.145560 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m20:47:55.156990 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m20:47:55.194041 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m20:47:55.203939 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m20:47:55.213317 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m20:47:55.232940 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m20:47:55.238685 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m20:47:55.245230 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m20:47:55.255456 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m20:47:55.261374 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m20:47:55.271514 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m20:47:55.281383 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m20:47:55.301340 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m20:47:55.320307 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m20:47:55.327081 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m20:47:55.332227 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m20:47:55.960710 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m20:47:55.979933 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m20:47:55.985146 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m20:47:56.000142 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m20:47:56.012181 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m20:47:56.015756 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m20:47:56.057215 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m20:47:56.238751 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m20:47:56.405104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aecd93b-78ef-4cfe-aebf-db899e79b521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f25660d0>]}
[0m20:47:56.453381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aecd93b-78ef-4cfe-aebf-db899e79b521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f44def10>]}
[0m20:47:56.455741 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m20:47:56.458194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aecd93b-78ef-4cfe-aebf-db899e79b521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f2660fa0>]}
[0m20:47:56.461520 [info ] [MainThread]: 
[0m20:47:56.463956 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:47:56.466960 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m20:47:56.480522 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m20:47:56.482813 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m20:47:56.484689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:56.961911 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.48 seconds
[0m20:47:56.967145 [debug] [ThreadPool]: On list_cs_dev: Close
[0m20:47:57.063058 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m20:47:57.078435 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m20:47:57.082512 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m20:47:57.085060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:57.493933 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.41 seconds
[0m20:47:57.499786 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m20:47:57.588014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aecd93b-78ef-4cfe-aebf-db899e79b521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f25669d0>]}
[0m20:47:57.590977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:57.593263 [info ] [MainThread]: 
[0m20:47:57.679215 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m20:47:57.683689 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m20:47:57.689478 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m20:47:57.693553 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m20:47:57.696839 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m20:47:57.710952 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m20:47:57.713087 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m20:47:57.715588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:58.311228 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m20:47:58.318408 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m20:47:58.333854 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:58.336496 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m20:47:58.397484 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m20:47:58.438541 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m20:47:58.441849 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m20:47:58.608074 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m20:47:58.643519 [debug] [Thread-1  ]: finished collecting timing info
[0m20:47:58.654725 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m20:47:58.746182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aecd93b-78ef-4cfe-aebf-db899e79b521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f44283a0>]}
[0m20:47:58.749797 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.06s]
[0m20:47:58.753959 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m20:47:58.758742 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:47:58.761768 [info ] [MainThread]: 
[0m20:47:58.764322 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:47:58.766912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:58.769134 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m20:47:58.817062 [info ] [MainThread]: 
[0m20:47:58.823122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:47:58.826682 [info ] [MainThread]: 
[0m20:47:58.830064 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:47:58.835188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f26260d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70fc1a2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f4479a60>]}
[0m20:47:58.842152 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 21:05:27.740581 | 3658b38b-b5ac-4477-8941-7c584035f724 ==============================
[0m21:05:27.740607 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:05:27.742808 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:05:27.744729 [debug] [MainThread]: Tracking: tracking
[0m21:05:27.746613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5eed5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5eed55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5eed5640>]}
[0m21:05:28.149395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:28.151157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:28.160815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3658b38b-b5ac-4477-8941-7c584035f724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5dc730d0>]}
[0m21:05:28.190675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3658b38b-b5ac-4477-8941-7c584035f724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5dd59910>]}
[0m21:05:28.192725 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:05:28.194547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3658b38b-b5ac-4477-8941-7c584035f724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5dd59760>]}
[0m21:05:28.197734 [info ] [MainThread]: 
[0m21:05:28.200078 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:05:28.203238 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m21:05:28.223118 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m21:05:28.226018 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m21:05:28.227852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:29.086177 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.86 seconds
[0m21:05:29.092632 [debug] [ThreadPool]: On list_cs_dev: Close
[0m21:05:29.210886 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m21:05:29.225177 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m21:05:29.227611 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m21:05:29.229911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:29.974095 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.74 seconds
[0m21:05:29.979634 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m21:05:30.086790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3658b38b-b5ac-4477-8941-7c584035f724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5eed2550>]}
[0m21:05:30.090810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:30.093185 [info ] [MainThread]: 
[0m21:05:30.118097 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m21:05:30.121953 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m21:05:30.126655 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m21:05:30.129956 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m21:05:30.134246 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m21:05:30.163996 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m21:05:30.167197 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m21:05:30.170495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:30.623787 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m21:05:30.648292 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m21:05:30.659149 [debug] [Thread-1  ]: finished collecting timing info
[0m21:05:30.661446 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m21:05:30.702993 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m21:05:30.713452 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m21:05:30.715195 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m21:05:31.009790 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m21:05:31.042805 [debug] [Thread-1  ]: finished collecting timing info
[0m21:05:31.045556 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m21:05:31.139341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3658b38b-b5ac-4477-8941-7c584035f724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5d0b2e50>]}
[0m21:05:31.142758 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.01s]
[0m21:05:31.145752 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m21:05:31.150315 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:05:31.153358 [info ] [MainThread]: 
[0m21:05:31.156226 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m21:05:31.158866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:31.161206 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m21:05:31.192202 [info ] [MainThread]: 
[0m21:05:31.194442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:31.196763 [info ] [MainThread]: 
[0m21:05:31.198941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:05:31.201343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5d195f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5d20e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5d20e760>]}
[0m21:05:31.203440 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 21:05:35.990842 | e0aab313-a429-4dc4-9bdb-bfa38db1a7cf ==============================
[0m21:05:35.990867 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:05:35.992958 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m21:05:35.994869 [debug] [MainThread]: Tracking: tracking
[0m21:05:35.996977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9fedee580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9fedee5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9fedee640>]}
[0m21:05:36.185757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:36.187732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:36.197272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0aab313-a429-4dc4-9bdb-bfa38db1a7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9febad0d0>]}
[0m21:05:36.229221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0aab313-a429-4dc4-9bdb-bfa38db1a7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9fec988e0>]}
[0m21:05:36.231924 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:05:36.234685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0aab313-a429-4dc4-9bdb-bfa38db1a7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9fec98730>]}
[0m21:05:36.239237 [info ] [MainThread]: 
[0m21:05:36.242995 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m21:05:36.277189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ffe1e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba0666ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9fec98820>]}
[0m21:05:36.279850 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 21:05:41.027699 | ee0544b1-7c9b-4c36-8797-d0b60910e30e ==============================
[0m21:05:41.027739 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:05:41.029774 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:05:41.031727 [debug] [MainThread]: Tracking: tracking
[0m21:05:41.033759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672e0d1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672e0d15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672e0d1640>]}
[0m21:05:41.228585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:41.230345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:41.239921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee0544b1-7c9b-4c36-8797-d0b60910e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672ce730d0>]}
[0m21:05:41.267606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee0544b1-7c9b-4c36-8797-d0b60910e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672cf5c8e0>]}
[0m21:05:41.270154 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:05:41.272176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee0544b1-7c9b-4c36-8797-d0b60910e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672cf5c730>]}
[0m21:05:41.275529 [info ] [MainThread]: 
[0m21:05:41.277880 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:05:41.280348 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m21:05:41.299482 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m21:05:41.303742 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m21:05:41.306684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:42.164823 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.86 seconds
[0m21:05:42.171296 [debug] [ThreadPool]: On list_cs_dev: Close
[0m21:05:42.288911 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m21:05:42.306226 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m21:05:42.309368 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m21:05:42.312655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:42.840096 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.53 seconds
[0m21:05:42.845056 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m21:05:42.968248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee0544b1-7c9b-4c36-8797-d0b60910e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672e0cf580>]}
[0m21:05:42.972361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:42.974857 [info ] [MainThread]: 
[0m21:05:42.995502 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m21:05:42.998335 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_revenue_by_month ..................... [RUN]
[0m21:05:43.001489 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_revenue_by_month"
[0m21:05:43.004024 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m21:05:43.006890 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m21:05:43.015651 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m21:05:43.023750 [debug] [Thread-1  ]: finished collecting timing info
[0m21:05:43.025805 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m21:05:43.066608 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m21:05:43.081459 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_revenue_by_month"
[0m21:05:43.083089 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
create or replace  view cs_dev.demo.customer_revenue_by_month
  
   as (
    with subscription_periods as (

    select * from cs_dev.demo.subscription_periods

),

months as (

    select * from cs_dev.demo.util_months

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m21:05:43.085348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:43.850991 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.77 seconds
[0m21:05:43.881683 [debug] [Thread-1  ]: finished collecting timing info
[0m21:05:43.884626 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m21:05:43.986831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee0544b1-7c9b-4c36-8797-d0b60910e30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672c298c70>]}
[0m21:05:43.990282 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_revenue_by_month ................ [[32mSUCCESS 1[0m in 0.99s]
[0m21:05:43.993371 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m21:05:43.998223 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:05:44.001032 [info ] [MainThread]: 
[0m21:05:44.003692 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m21:05:44.006181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:44.008295 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m21:05:44.039754 [info ] [MainThread]: 
[0m21:05:44.042160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:44.044450 [info ] [MainThread]: 
[0m21:05:44.046580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:05:44.048815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672c2b8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672c2b81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672c2b82e0>]}
[0m21:05:44.050776 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 21:05:48.881103 | 50da1bd3-1be7-43fd-96c7-9de2ab7fbbf0 ==============================
[0m21:05:48.881146 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:05:48.883358 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m21:05:48.886457 [debug] [MainThread]: Tracking: tracking
[0m21:05:48.889007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff629732550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6297325b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff629732610>]}
[0m21:05:49.090294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:49.091999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:49.101424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50da1bd3-1be7-43fd-96c7-9de2ab7fbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6284b20d0>]}
[0m21:05:49.129552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50da1bd3-1be7-43fd-96c7-9de2ab7fbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6285988b0>]}
[0m21:05:49.131488 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:05:49.133247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50da1bd3-1be7-43fd-96c7-9de2ab7fbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff628598700>]}
[0m21:05:49.136624 [info ] [MainThread]: 
[0m21:05:49.139167 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:05:49.141904 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m21:05:49.161389 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m21:05:49.164309 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m21:05:49.166085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:49.757051 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.59 seconds
[0m21:05:49.762825 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m21:05:49.875537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50da1bd3-1be7-43fd-96c7-9de2ab7fbbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6285981c0>]}
[0m21:05:49.879164 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:49.881708 [info ] [MainThread]: 
[0m21:05:49.902324 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m21:05:49.905095 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m21:05:49.909456 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m21:05:49.911763 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m21:05:49.913769 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m21:05:49.936103 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m21:05:49.946533 [debug] [Thread-1  ]: finished collecting timing info
[0m21:05:49.948344 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m21:05:49.978205 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m21:05:49.990800 [debug] [Thread-1  ]: Using snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m21:05:49.992517 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from cs_dev.demo.customer_revenue_by_month
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:05:49.994023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:51.592264 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.6 seconds
[0m21:05:51.606269 [debug] [Thread-1  ]: finished collecting timing info
[0m21:05:51.608666 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m21:05:51.716239 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 1.81s]
[0m21:05:51.720271 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m21:05:51.725879 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:05:51.729660 [info ] [MainThread]: 
[0m21:05:51.732207 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m21:05:51.734875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:51.737591 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m21:05:51.771266 [info ] [MainThread]: 
[0m21:05:51.774736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:51.778029 [info ] [MainThread]: 
[0m21:05:51.780771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:05:51.783053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff628598640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62970b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62975dc40>]}
[0m21:05:51.785518 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 21:05:57.136459 | 221b2919-7bca-4fce-8235-fca1505fc261 ==============================
[0m21:05:57.136489 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:05:57.139607 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:05:57.142346 [debug] [MainThread]: Tracking: tracking
[0m21:05:57.146541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a95ad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a95ad5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a95ad610>]}
[0m21:05:57.366234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:57.367833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:57.377550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '221b2919-7bca-4fce-8235-fca1505fc261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a93730d0>]}
[0m21:05:57.406038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '221b2919-7bca-4fce-8235-fca1505fc261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a945d8b0>]}
[0m21:05:57.408078 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:05:57.409879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '221b2919-7bca-4fce-8235-fca1505fc261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a945d700>]}
[0m21:05:57.412973 [info ] [MainThread]: 
[0m21:05:57.415093 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:05:57.417627 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m21:05:57.440614 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m21:05:57.443827 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m21:05:57.446260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:58.437470 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.99 seconds
[0m21:05:58.443504 [debug] [ThreadPool]: On list_cs_dev: Close
[0m21:05:58.544847 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m21:05:58.559445 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m21:05:58.562153 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m21:05:58.564627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:59.254056 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.69 seconds
[0m21:05:59.259102 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m21:05:59.380315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '221b2919-7bca-4fce-8235-fca1505fc261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a95aa100>]}
[0m21:05:59.384216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:59.387364 [info ] [MainThread]: 
[0m21:05:59.408951 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m21:05:59.412108 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_churn_month .......................... [RUN]
[0m21:05:59.415240 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_churn_month"
[0m21:05:59.417564 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m21:05:59.419947 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m21:05:59.427374 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m21:05:59.434176 [debug] [Thread-1  ]: finished collecting timing info
[0m21:05:59.436495 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m21:05:59.475288 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m21:05:59.484029 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_churn_month"
[0m21:05:59.485801 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
create or replace  view cs_dev.demo.customer_churn_month
  
   as (
    with mrr as (

    select * from cs_dev.demo.customer_revenue_by_month

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m21:05:59.488235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:06:00.296741 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
[0m21:06:00.328656 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:00.331529 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m21:06:00.461589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '221b2919-7bca-4fce-8235-fca1505fc261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a8894400>]}
[0m21:06:00.464914 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_churn_month ..................... [[32mSUCCESS 1[0m in 1.05s]
[0m21:06:00.468275 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m21:06:00.473614 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:06:00.476399 [info ] [MainThread]: 
[0m21:06:00.478722 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m21:06:00.481152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:00.483223 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m21:06:00.513793 [info ] [MainThread]: 
[0m21:06:00.516528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:00.519060 [info ] [MainThread]: 
[0m21:06:00.521557 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:06:00.524114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a945d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a91ee100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a91eee20>]}
[0m21:06:00.526240 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 21:06:10.216987 | 855fd478-03d0-46c0-9b53-5247584c8d43 ==============================
[0m21:06:10.217025 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:06:10.220184 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:06:10.224499 [debug] [MainThread]: Tracking: tracking
[0m21:06:10.228061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde97e98550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde97e985b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde97e98610>]}
[0m21:06:10.430173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:10.431763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:10.441343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '855fd478-03d0-46c0-9b53-5247584c8d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde96c330d0>]}
[0m21:06:10.477860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '855fd478-03d0-46c0-9b53-5247584c8d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde96d188b0>]}
[0m21:06:10.479669 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:06:10.481654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '855fd478-03d0-46c0-9b53-5247584c8d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde96d18700>]}
[0m21:06:10.484786 [info ] [MainThread]: 
[0m21:06:10.487151 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:06:10.489932 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m21:06:10.509152 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m21:06:10.512491 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m21:06:10.514651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:11.334071 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.82 seconds
[0m21:06:11.339413 [debug] [ThreadPool]: On list_cs_dev: Close
[0m21:06:11.491410 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m21:06:11.506162 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m21:06:11.508729 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m21:06:11.511292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:11.987020 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.48 seconds
[0m21:06:11.993312 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m21:06:12.114154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '855fd478-03d0-46c0-9b53-5247584c8d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde97e950d0>]}
[0m21:06:12.117601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:06:12.119933 [info ] [MainThread]: 
[0m21:06:12.139973 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m21:06:12.142991 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.mrr ........................................... [RUN]
[0m21:06:12.145931 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m21:06:12.148109 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m21:06:12.150115 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m21:06:12.169928 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m21:06:12.182868 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m21:06:12.190838 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:12.193220 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m21:06:12.231111 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m21:06:12.242268 [debug] [Thread-1  ]: Using snowflake connection "model.acme.mrr"
[0m21:06:12.243904 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.mrr"} */
create or replace  view cs_dev.demo.mrr
  
   as (
    with unioned as (

    select * from cs_dev.demo.customer_revenue_by_month

    union all

    select * from cs_dev.demo.customer_churn_month

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m21:06:12.246355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:06:13.810039 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.56 seconds
[0m21:06:13.842034 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:13.845808 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m21:06:13.962798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855fd478-03d0-46c0-9b53-5247584c8d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde96076e20>]}
[0m21:06:13.966140 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.mrr ...................................... [[32mSUCCESS 1[0m in 1.82s]
[0m21:06:13.969125 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m21:06:13.974979 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:06:13.978205 [info ] [MainThread]: 
[0m21:06:13.980654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m21:06:13.983149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:13.985300 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m21:06:14.015405 [info ] [MainThread]: 
[0m21:06:14.017972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:14.020417 [info ] [MainThread]: 
[0m21:06:14.022903 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:06:14.025383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9606faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9606ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9606f3a0>]}
[0m21:06:14.027627 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 21:06:43.439993 | b67822c8-bbf3-45fb-9991-bd9247ddeb0e ==============================
[0m21:06:43.440058 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:06:43.442873 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:06:43.445730 [debug] [MainThread]: Tracking: tracking
[0m21:06:43.449196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da9ed520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da9ed580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da9ed5e0>]}
[0m21:06:43.657257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:43.659014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:43.668971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b67822c8-bbf3-45fb-9991-bd9247ddeb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da7b40d0>]}
[0m21:06:43.695623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b67822c8-bbf3-45fb-9991-bd9247ddeb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da897880>]}
[0m21:06:43.697556 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:06:43.699393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67822c8-bbf3-45fb-9991-bd9247ddeb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da8976d0>]}
[0m21:06:43.702443 [info ] [MainThread]: 
[0m21:06:43.704795 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:06:43.707557 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m21:06:43.726633 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m21:06:43.729020 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m21:06:43.730813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:44.541443 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.81 seconds
[0m21:06:44.547638 [debug] [ThreadPool]: On list_cs_dev: Close
[0m21:06:44.654615 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m21:06:44.667864 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m21:06:44.670028 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m21:06:44.672131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:45.297623 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.63 seconds
[0m21:06:45.302373 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m21:06:45.431047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67822c8-bbf3-45fb-9991-bd9247ddeb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da9ea100>]}
[0m21:06:45.434821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:06:45.437197 [info ] [MainThread]: 
[0m21:06:45.458616 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m21:06:45.461450 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.mrr ........................................... [RUN]
[0m21:06:45.464513 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m21:06:45.466585 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m21:06:45.468759 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m21:06:45.487435 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m21:06:45.501600 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m21:06:45.507913 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:45.510048 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m21:06:45.545462 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m21:06:45.553066 [debug] [Thread-1  ]: Using snowflake connection "model.acme.mrr"
[0m21:06:45.554930 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.mrr"} */
create or replace  view cs_dev.demo.mrr
  
   as (
    with unioned as (

    select * from cs_dev.demo.customer_revenue_by_month

    union all

    select * from cs_dev.demo.customer_churn_month

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m21:06:45.556629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:06:46.785082 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.23 seconds
[0m21:06:46.818945 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:46.822203 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m21:06:46.935029 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67822c8-bbf3-45fb-9991-bd9247ddeb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d9bf4df0>]}
[0m21:06:46.938712 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.mrr ...................................... [[32mSUCCESS 1[0m in 1.47s]
[0m21:06:46.942080 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m21:06:46.947523 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:06:46.950470 [info ] [MainThread]: 
[0m21:06:46.952787 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m21:06:46.955070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:46.957244 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m21:06:46.986107 [info ] [MainThread]: 
[0m21:06:46.988369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:46.990816 [info ] [MainThread]: 
[0m21:06:46.993079 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:06:46.995144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d9c2dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d9c2d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d9c2d070>]}
[0m21:06:46.997184 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 21:06:51.347466 | 8ff73e9e-b934-4bb9-8e35-43a98f276f55 ==============================
[0m21:06:51.347492 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:06:51.350852 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m21:06:51.354431 [debug] [MainThread]: Tracking: tracking
[0m21:06:51.357927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b76de550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b76de5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b76de610>]}
[0m21:06:51.562575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:51.564330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:51.573892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff73e9e-b934-4bb9-8e35-43a98f276f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b64730d0>]}
[0m21:06:51.656687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff73e9e-b934-4bb9-8e35-43a98f276f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b655c8b0>]}
[0m21:06:51.661984 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:06:51.664999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff73e9e-b934-4bb9-8e35-43a98f276f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b655c700>]}
[0m21:06:51.669513 [info ] [MainThread]: 
[0m21:06:51.672521 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:06:51.676246 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m21:06:51.695098 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m21:06:51.698619 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m21:06:51.700838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:52.267365 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.57 seconds
[0m21:06:52.273244 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m21:06:52.383826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff73e9e-b934-4bb9-8e35-43a98f276f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b655c1c0>]}
[0m21:06:52.387216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:06:52.390452 [info ] [MainThread]: 
[0m21:06:52.413058 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m21:06:52.415352 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m21:06:52.417935 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m21:06:52.420068 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m21:06:52.422999 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m21:06:52.442412 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m21:06:52.450953 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:52.453117 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m21:06:52.482124 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m21:06:52.492505 [debug] [Thread-1  ]: Using snowflake connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m21:06:52.494294 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from cs_dev.demo.mrr where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m21:06:52.495870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:06:55.567768 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.07 seconds
[0m21:06:55.580587 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:55.583285 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m21:06:55.680888 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 3.26s]
[0m21:06:55.684289 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m21:06:55.686875 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m21:06:55.691001 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m21:06:55.694707 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m21:06:55.697088 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m21:06:55.699509 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m21:06:55.717830 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m21:06:55.727773 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:55.730510 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m21:06:55.736239 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m21:06:55.744807 [debug] [Thread-1  ]: Using snowflake connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m21:06:55.747196 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from cs_dev.demo.mrr
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m21:06:55.750030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:06:59.122929 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.37 seconds
[0m21:06:59.128505 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:59.131061 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m21:06:59.245115 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 3.55s]
[0m21:06:59.248413 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m21:06:59.250903 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m21:06:59.254033 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m21:06:59.257029 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m21:06:59.259676 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m21:06:59.262107 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m21:06:59.274669 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m21:06:59.283754 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:59.286358 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m21:06:59.292955 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m21:06:59.300788 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m21:06:59.302741 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from cs_dev.demo.mrr
where customer_id is null



      
    ) dbt_internal_test
[0m21:06:59.304703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:01.328622 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.02 seconds
[0m21:07:01.333588 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:01.336176 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m21:07:01.496121 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 2.24s]
[0m21:07:01.499856 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m21:07:01.502547 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m21:07:01.505178 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m21:07:01.508808 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m21:07:01.511235 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m21:07:01.513405 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m21:07:01.521320 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m21:07:01.528927 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:01.531237 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m21:07:01.538146 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m21:07:01.546065 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m21:07:01.548268 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from cs_dev.demo.mrr
where date_month is null



      
    ) dbt_internal_test
[0m21:07:01.550166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:04.317580 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.77 seconds
[0m21:07:04.326374 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:04.329621 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m21:07:04.429545 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 2.92s]
[0m21:07:04.469468 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m21:07:04.473669 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m21:07:04.478007 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m21:07:04.482768 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m21:07:04.485977 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m21:07:04.488758 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m21:07:04.501397 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m21:07:04.513254 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:04.517174 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m21:07:04.537682 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m21:07:04.552004 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m21:07:04.554571 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from cs_dev.demo.mrr
where first_active_month is null



      
    ) dbt_internal_test
[0m21:07:04.558092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:07.267106 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.71 seconds
[0m21:07:07.273992 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:07.276804 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m21:07:07.390228 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 2.91s]
[0m21:07:07.394221 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m21:07:07.397068 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m21:07:07.399587 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m21:07:07.402676 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_id.45914052fb"
[0m21:07:07.404979 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m21:07:07.407392 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m21:07:07.416628 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m21:07:07.424018 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:07.425995 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m21:07:07.431880 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m21:07:07.440181 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_id.45914052fb"
[0m21:07:07.442442 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from cs_dev.demo.mrr
where id is null



      
    ) dbt_internal_test
[0m21:07:07.444486 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:10.441565 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:07:10.448050 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:10.450536 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m21:07:10.546270 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 3.14s]
[0m21:07:10.550080 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m21:07:10.552842 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m21:07:10.555414 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m21:07:10.558935 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m21:07:10.561037 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m21:07:10.563115 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m21:07:10.571329 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m21:07:10.579429 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:10.581872 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m21:07:10.587568 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m21:07:10.595257 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m21:07:10.597467 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from cs_dev.demo.mrr
where is_active is null



      
    ) dbt_internal_test
[0m21:07:10.599758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:13.689465 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.09 seconds
[0m21:07:13.697222 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:13.699861 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m21:07:13.828300 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 3.27s]
[0m21:07:13.831494 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m21:07:13.833548 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m21:07:13.835817 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m21:07:13.838904 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m21:07:13.841875 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m21:07:13.844276 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m21:07:13.852416 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m21:07:13.860399 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:13.862703 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m21:07:13.868528 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m21:07:13.877068 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m21:07:13.879018 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from cs_dev.demo.mrr
where is_first_month is null



      
    ) dbt_internal_test
[0m21:07:13.881085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:15.653475 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.77 seconds
[0m21:07:15.660296 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:15.673352 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m21:07:15.793159 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 1.95s]
[0m21:07:15.797223 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m21:07:15.799845 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m21:07:15.803358 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m21:07:15.806682 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m21:07:15.809368 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m21:07:15.811715 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m21:07:15.820609 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m21:07:15.832966 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:15.837296 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m21:07:15.845236 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m21:07:15.856088 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m21:07:15.859090 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from cs_dev.demo.mrr
where is_last_month is null



      
    ) dbt_internal_test
[0m21:07:15.861821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:18.078354 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.22 seconds
[0m21:07:18.082594 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:18.084802 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m21:07:18.181867 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 2.38s]
[0m21:07:18.184767 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m21:07:18.187160 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m21:07:18.189294 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m21:07:18.192515 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m21:07:18.194412 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m21:07:18.196034 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m21:07:18.202679 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m21:07:18.209251 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:18.211372 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m21:07:18.216060 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m21:07:18.223183 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m21:07:18.225481 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from cs_dev.demo.mrr
where last_active_month is null



      
    ) dbt_internal_test
[0m21:07:18.227206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:20.280272 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.05 seconds
[0m21:07:20.285664 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:20.288330 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m21:07:20.392898 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 2.20s]
[0m21:07:20.396095 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m21:07:20.398675 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m21:07:20.400877 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m21:07:20.403790 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m21:07:20.405762 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m21:07:20.407857 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m21:07:20.416178 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m21:07:20.422755 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:20.424925 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m21:07:20.430573 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m21:07:20.439257 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m21:07:20.441659 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from cs_dev.demo.mrr
where mrr is null



      
    ) dbt_internal_test
[0m21:07:20.443875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:22.217613 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.77 seconds
[0m21:07:22.223914 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:22.228014 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m21:07:22.340500 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 1.94s]
[0m21:07:22.344180 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m21:07:22.346601 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m21:07:22.348627 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m21:07:22.351890 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m21:07:22.353957 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m21:07:22.355942 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m21:07:22.364307 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m21:07:22.371478 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:22.374283 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m21:07:22.380377 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m21:07:22.390309 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m21:07:22.393076 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from cs_dev.demo.mrr
where mrr_change is null



      
    ) dbt_internal_test
[0m21:07:22.395367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:24.576862 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.18 seconds
[0m21:07:24.582808 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:24.585878 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m21:07:24.675220 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 2.32s]
[0m21:07:24.678857 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m21:07:24.681080 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m21:07:24.683490 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m21:07:24.687050 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m21:07:24.689348 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m21:07:24.691741 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m21:07:24.699990 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m21:07:24.708652 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:24.711402 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m21:07:24.717018 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m21:07:24.724314 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m21:07:24.726403 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from cs_dev.demo.mrr
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m21:07:24.729381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:26.516678 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.79 seconds
[0m21:07:26.521275 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:26.523681 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m21:07:26.619190 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 1.93s]
[0m21:07:26.621774 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m21:07:26.624099 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m21:07:26.626019 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m21:07:26.628791 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m21:07:26.630560 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m21:07:26.632293 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m21:07:26.638819 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m21:07:26.647542 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:26.651333 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m21:07:26.660826 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m21:07:26.670218 [debug] [Thread-1  ]: Using snowflake connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m21:07:26.673490 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from cs_dev.demo.mrr
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m21:07:26.676345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:28.684949 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.01 seconds
[0m21:07:28.688829 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:28.690807 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m21:07:28.788835 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 2.16s]
[0m21:07:28.791996 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m21:07:28.794632 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m21:07:28.797085 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m21:07:28.800507 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m21:07:28.803752 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m21:07:28.806446 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m21:07:28.820205 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m21:07:28.829310 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:28.831776 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m21:07:28.838086 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m21:07:28.849822 [debug] [Thread-1  ]: Using snowflake connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m21:07:28.852527 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from cs_dev.demo.mrr
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:07:28.854679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:31.120403 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.27 seconds
[0m21:07:31.127920 [debug] [Thread-1  ]: finished collecting timing info
[0m21:07:31.131581 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m21:07:31.239486 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 2.44s]
[0m21:07:31.244594 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m21:07:31.250115 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:07:31.253389 [info ] [MainThread]: 
[0m21:07:31.256121 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 39.58 seconds (39.58s).
[0m21:07:31.259504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:31.261756 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m21:07:31.306387 [info ] [MainThread]: 
[0m21:07:31.309527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:07:31.313569 [info ] [MainThread]: 
[0m21:07:31.316191 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m21:07:31.319933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5a1da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b655c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b7709640>]}
[0m21:07:31.322070 [debug] [MainThread]: Flushing usage events


============================== 2023-02-02 15:49:11.972131 | 02f7dbbc-c818-4993-829e-1507598e03de ==============================
[0m15:49:11.972181 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:49:11.975689 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:49:11.980553 [debug] [MainThread]: Tracking: tracking
[0m15:49:11.984995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41f3c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41f3c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41f3c610>]}
[0m15:49:12.930405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:12.932176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:12.942625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02f7dbbc-c818-4993-829e-1507598e03de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf40cf30d0>]}
[0m15:49:12.973096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02f7dbbc-c818-4993-829e-1507598e03de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf40ddc8b0>]}
[0m15:49:12.975767 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:49:12.978061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f7dbbc-c818-4993-829e-1507598e03de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf40ddc700>]}
[0m15:49:12.981470 [info ] [MainThread]: 
[0m15:49:12.984581 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:49:12.987482 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:49:13.011594 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:49:13.014431 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:49:13.017419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:13.883895 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.87 seconds
[0m15:49:13.890696 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:49:14.157906 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:49:14.171023 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:49:14.173736 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:49:14.175953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:14.692474 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.52 seconds
[0m15:49:14.697435 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:49:14.838139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f7dbbc-c818-4993-829e-1507598e03de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41f3a190>]}
[0m15:49:14.842296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:14.845168 [info ] [MainThread]: 
[0m15:49:14.866484 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m15:49:14.869633 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m15:49:14.873205 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m15:49:14.875503 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m15:49:14.877568 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m15:49:14.902173 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:49:14.904944 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m15:49:14.906803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:49:15.690471 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m15:49:15.709921 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m15:49:15.719961 [debug] [Thread-1  ]: finished collecting timing info
[0m15:49:15.721837 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m15:49:15.756980 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m15:49:15.768847 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:49:15.770542 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m15:49:16.011572 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m15:49:16.050352 [debug] [Thread-1  ]: finished collecting timing info
[0m15:49:16.054350 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m15:49:16.189755 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f7dbbc-c818-4993-829e-1507598e03de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4014aee0>]}
[0m15:49:16.192826 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.32s]
[0m15:49:16.195618 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m15:49:16.199808 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:49:16.203812 [info ] [MainThread]: 
[0m15:49:16.207602 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m15:49:16.209912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:16.211922 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m15:49:16.260689 [info ] [MainThread]: 
[0m15:49:16.263868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:16.269252 [info ] [MainThread]: 
[0m15:49:16.275973 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:49:16.278937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf40ddc640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf40b570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4026f0d0>]}
[0m15:49:16.281982 [debug] [MainThread]: Flushing usage events


============================== 2023-02-06 17:24:53.247707 | fd9a89f9-9f59-4fd7-b510-4916642fe0bd ==============================
[0m17:24:53.247807 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:24:53.252049 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:24:53.255621 [debug] [MainThread]: Tracking: tracking
[0m17:24:53.258882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0883062fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0883062970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08830628b0>]}
[0m17:24:54.302445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:54.306279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:54.324216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd9a89f9-9f59-4fd7-b510-4916642fe0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0881df90d0>]}
[0m17:24:54.378930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd9a89f9-9f59-4fd7-b510-4916642fe0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0881ed2970>]}
[0m17:24:54.382823 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:24:54.386792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9a89f9-9f59-4fd7-b510-4916642fe0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088303dc70>]}
[0m17:24:54.394336 [info ] [MainThread]: 
[0m17:24:54.399308 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:24:54.406249 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m17:24:54.440469 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m17:24:54.444089 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m17:24:54.448563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:56.886239 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 2.44 seconds
[0m17:24:56.897925 [debug] [ThreadPool]: On list_cs_dev: Close
[0m17:24:57.220710 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m17:24:57.238546 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m17:24:57.247884 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m17:24:57.260611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:58.394373 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.13 seconds
[0m17:24:58.401860 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m17:24:58.531721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9a89f9-9f59-4fd7-b510-4916642fe0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0881dbff40>]}
[0m17:24:58.539936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:58.546299 [info ] [MainThread]: 
[0m17:24:58.572429 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m17:24:58.576249 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m17:24:58.581675 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m17:24:58.585316 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m17:24:58.588207 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m17:24:58.618737 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m17:24:58.622799 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m17:24:58.626836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:59.470521 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.84 seconds
[0m17:24:59.494177 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m17:24:59.510810 [debug] [Thread-1  ]: finished collecting timing info
[0m17:24:59.514210 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m17:24:59.564313 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m17:24:59.583845 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m17:24:59.586474 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m17:24:59.873012 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m17:24:59.910595 [debug] [Thread-1  ]: finished collecting timing info
[0m17:24:59.913605 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m17:25:00.031381 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9a89f9-9f59-4fd7-b510-4916642fe0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0881272ac0>]}
[0m17:25:00.035380 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.45s]
[0m17:25:00.040431 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m17:25:00.045364 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:00.049913 [info ] [MainThread]: 
[0m17:25:00.053428 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m17:25:00.056774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:00.060164 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m17:25:00.115358 [info ] [MainThread]: 
[0m17:25:00.119095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:00.123386 [info ] [MainThread]: 
[0m17:25:00.129583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:00.138208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088123cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088137a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088137a190>]}
[0m17:25:00.142420 [debug] [MainThread]: Flushing usage events


============================== 2023-02-06 17:26:26.747473 | e2ec657e-0c9f-4918-aebb-df864048708e ==============================
[0m17:26:26.747501 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:26:26.750289 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:26:26.752401 [debug] [MainThread]: Tracking: tracking
[0m17:26:26.754204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e8718580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e87185e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e8718640>]}
[0m17:26:26.984436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:26.986412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:26.996658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2ec657e-0c9f-4918-aebb-df864048708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e74b30d0>]}
[0m17:26:27.025666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2ec657e-0c9f-4918-aebb-df864048708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e759d910>]}
[0m17:26:27.027665 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:26:27.030583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ec657e-0c9f-4918-aebb-df864048708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e759d760>]}
[0m17:26:27.036310 [info ] [MainThread]: 
[0m17:26:27.041596 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:26:27.046405 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m17:26:27.067624 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m17:26:27.070169 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m17:26:27.072121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:27.843694 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.77 seconds
[0m17:26:27.848343 [debug] [ThreadPool]: On list_cs_dev: Close
[0m17:26:27.958978 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m17:26:27.974174 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m17:26:27.976219 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m17:26:27.978378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:28.278780 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.3 seconds
[0m17:26:28.283952 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m17:26:28.383486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ec657e-0c9f-4918-aebb-df864048708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e8716580>]}
[0m17:26:28.386826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:28.389407 [info ] [MainThread]: 
[0m17:26:28.411935 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m17:26:28.415605 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m17:26:28.418984 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m17:26:28.421519 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m17:26:28.423975 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m17:26:28.456214 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m17:26:28.459433 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m17:26:28.461679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:26:28.954824 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m17:26:28.972105 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m17:26:28.977968 [debug] [Thread-1  ]: finished collecting timing info
[0m17:26:28.979794 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m17:26:29.017159 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m17:26:29.024927 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m17:26:29.026983 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m17:26:29.237604 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m17:26:29.270711 [debug] [Thread-1  ]: finished collecting timing info
[0m17:26:29.274601 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m17:26:29.388855 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ec657e-0c9f-4918-aebb-df864048708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e6876910>]}
[0m17:26:29.391755 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 0.97s]
[0m17:26:29.393974 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m17:26:29.397733 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:26:29.399888 [info ] [MainThread]: 
[0m17:26:29.402064 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m17:26:29.404612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:29.406681 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m17:26:29.433967 [info ] [MainThread]: 
[0m17:26:29.436487 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:29.438376 [info ] [MainThread]: 
[0m17:26:29.440461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:26:29.442641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e6a17040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e6936d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e6936040>]}
[0m17:26:29.444441 [debug] [MainThread]: Flushing usage events


============================== 2023-02-06 21:06:43.281824 | e4b1cd67-8909-4b43-b57b-f28a3bb10230 ==============================
[0m21:06:43.281868 [info ] [MainThread]: Running with dbt=1.3.0
[0m21:06:43.285628 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:06:43.289479 [debug] [MainThread]: Tracking: tracking
[0m21:06:43.295430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d340765b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d34076610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d34076670>]}
[0m21:06:44.361829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:44.365837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:44.381139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4b1cd67-8909-4b43-b57b-f28a3bb10230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d32e320d0>]}
[0m21:06:44.428137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4b1cd67-8909-4b43-b57b-f28a3bb10230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d32f19940>]}
[0m21:06:44.431289 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m21:06:44.435170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4b1cd67-8909-4b43-b57b-f28a3bb10230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d32f19790>]}
[0m21:06:44.439760 [info ] [MainThread]: 
[0m21:06:44.444040 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:06:44.448194 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m21:06:44.475527 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m21:06:44.478552 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m21:06:44.481141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:45.227053 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.75 seconds
[0m21:06:45.235451 [debug] [ThreadPool]: On list_cs_dev: Close
[0m21:06:45.342625 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m21:06:45.360313 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m21:06:45.363381 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m21:06:45.367552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:45.954702 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.59 seconds
[0m21:06:45.959859 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m21:06:46.075630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4b1cd67-8909-4b43-b57b-f28a3bb10230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d34079700>]}
[0m21:06:46.079860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:06:46.082428 [info ] [MainThread]: 
[0m21:06:46.106313 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m21:06:46.109670 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m21:06:46.113145 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m21:06:46.115552 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m21:06:46.118160 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m21:06:46.149888 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m21:06:46.152983 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m21:06:46.157082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:06:46.793529 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m21:06:46.826676 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m21:06:46.860231 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:46.864235 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m21:06:46.927273 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m21:06:46.964160 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m21:06:46.967944 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m21:06:47.172833 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m21:06:47.247884 [debug] [Thread-1  ]: finished collecting timing info
[0m21:06:47.251277 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m21:06:47.381303 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b1cd67-8909-4b43-b57b-f28a3bb10230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d321ced00>]}
[0m21:06:47.388922 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.27s]
[0m21:06:47.394472 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m21:06:47.401038 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:06:47.406810 [info ] [MainThread]: 
[0m21:06:47.415855 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m21:06:47.420184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:47.423255 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m21:06:47.477693 [info ] [MainThread]: 
[0m21:06:47.481426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:47.488256 [info ] [MainThread]: 
[0m21:06:47.503148 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:06:47.508215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d323365e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d32336460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d34076a60>]}
[0m21:06:47.511788 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:01:40.152237 | 357c4191-0299-4e69-b6cf-48da130e60dc ==============================
[0m15:01:40.152259 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:01:40.154761 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:01:40.157013 [debug] [MainThread]: Tracking: tracking
[0m15:01:40.158919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228afae550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228afae5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228afae610>]}
[0m15:01:40.240249 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:01:40.242919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '357c4191-0299-4e69-b6cf-48da130e60dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228afae6a0>]}
[0m15:01:40.577019 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m15:01:40.580631 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m15:01:40.583372 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:01:40.587565 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:01:40.657085 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m15:01:40.668628 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m15:01:40.673201 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m15:01:40.683435 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m15:01:40.686688 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m15:01:40.690015 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m15:01:40.697010 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m15:01:40.713603 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:01:40.716345 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:01:40.719609 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:01:40.722115 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:01:40.724332 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:01:40.726380 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m15:01:40.730396 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m15:01:40.740484 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:01:40.745405 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:01:40.752267 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:01:40.763379 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:01:40.793391 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:01:40.798710 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:01:40.804915 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:01:40.808986 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:01:40.819321 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:01:40.829485 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:01:40.836083 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m15:01:40.847191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:01:40.860604 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:01:40.889464 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:01:40.915369 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:01:40.932220 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:01:40.936710 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:01:40.941099 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:01:40.944893 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:01:40.952650 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:01:40.976772 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:01:40.995856 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:01:41.000095 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:01:41.021774 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:01:41.041827 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:01:41.046554 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:01:41.051592 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:01:41.063787 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m15:01:41.069982 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:01:41.074352 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:01:41.097571 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:01:41.105752 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:01:41.120794 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:01:41.135238 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:01:41.144325 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m15:01:41.147379 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:01:41.150357 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:01:41.152950 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:01:41.156030 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:01:41.158615 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:01:41.161657 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:01:41.165170 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:01:41.167901 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:01:41.178118 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:01:41.181552 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:01:41.184716 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:01:41.187857 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:01:41.191231 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:01:41.196008 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:01:41.199570 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:01:41.202483 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:01:41.206320 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m15:01:41.209157 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:01:41.212179 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:01:41.216209 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:01:41.219330 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:01:41.224676 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:01:41.231091 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:01:41.235754 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:01:41.241002 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:01:41.245297 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:01:41.250265 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:01:41.259117 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:01:41.266023 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:01:41.273514 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:01:41.278024 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:01:41.284956 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m15:01:41.290426 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m15:01:41.294407 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m15:01:41.298776 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m15:01:41.302140 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m15:01:41.309653 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m15:01:41.320667 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m15:01:41.325398 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m15:01:41.332006 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m15:01:41.353053 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m15:01:41.357740 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m15:01:41.362514 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m15:01:41.367625 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m15:01:41.371670 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m15:01:41.380068 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m15:01:41.384646 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m15:01:41.388814 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m15:01:41.393827 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m15:01:41.398742 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m15:01:41.405249 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m15:01:41.411197 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m15:01:41.417011 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m15:01:41.430725 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:01:41.435194 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:01:41.440303 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:01:41.444629 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:01:41.449130 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m15:01:41.501235 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m15:01:41.508858 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m15:01:41.513709 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m15:01:41.519650 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m15:01:41.524983 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m15:01:41.534529 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m15:01:41.540097 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m15:01:41.545692 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m15:01:41.565398 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m15:01:41.571307 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m15:01:41.575153 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m15:01:41.580387 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m15:01:41.584924 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m15:01:41.589780 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m15:01:41.594869 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m15:01:41.598426 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m15:01:41.601570 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m15:01:41.607082 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:01:41.615085 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:01:41.622434 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:01:41.631084 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:01:41.635551 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:01:41.641695 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:01:41.647851 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:01:41.658603 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:01:41.662776 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:01:41.666026 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:01:41.675859 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:01:41.679834 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:01:41.683619 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:01:41.691213 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:01:41.695200 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:01:41.702490 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:01:41.708936 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:01:41.768098 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:01:41.789225 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:01:41.795944 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:01:41.802093 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:01:42.324665 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m15:01:42.342968 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m15:01:42.349070 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m15:01:42.363740 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m15:01:42.376429 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m15:01:42.380652 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m15:01:42.417712 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m15:01:42.551484 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m15:01:42.664707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '357c4191-0299-4e69-b6cf-48da130e60dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228a09d0d0>]}
[0m15:01:42.691972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '357c4191-0299-4e69-b6cf-48da130e60dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228ad56a30>]}
[0m15:01:42.693825 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:01:42.695620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357c4191-0299-4e69-b6cf-48da130e60dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228a108f70>]}
[0m15:01:42.698703 [info ] [MainThread]: 
[0m15:01:42.701000 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:01:42.703644 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:01:42.715994 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:01:42.718013 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:01:42.719808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:43.717402 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.0 seconds
[0m15:01:43.723619 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:01:43.957177 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:01:43.969311 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:01:43.971586 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:01:43.973848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:46.006792 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 2.03 seconds
[0m15:01:46.012041 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:01:46.250933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357c4191-0299-4e69-b6cf-48da130e60dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228a0a1670>]}
[0m15:01:46.255116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:46.258170 [info ] [MainThread]: 
[0m15:01:46.279849 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m15:01:46.282823 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m15:01:46.286704 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m15:01:46.289831 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m15:01:46.292505 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m15:01:46.305273 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:01:46.307906 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m15:01:46.310707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:47.318789 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.01 seconds
[0m15:01:47.324713 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m15:01:47.336640 [debug] [Thread-1  ]: finished collecting timing info
[0m15:01:47.338967 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m15:01:47.383368 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m15:01:47.396021 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:01:47.397716 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m15:01:48.105370 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m15:01:48.136092 [debug] [Thread-1  ]: finished collecting timing info
[0m15:01:48.139073 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m15:01:48.270507 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357c4191-0299-4e69-b6cf-48da130e60dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228ada0430>]}
[0m15:01:48.279079 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.98s]
[0m15:01:48.282814 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m15:01:48.288081 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:01:48.292686 [info ] [MainThread]: 
[0m15:01:48.297305 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m15:01:48.321998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:48.325144 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m15:01:48.358098 [info ] [MainThread]: 
[0m15:01:48.360461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:01:48.363124 [info ] [MainThread]: 
[0m15:01:48.365231 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:01:48.367533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228af62c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228aeedc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f228ed52fd0>]}
[0m15:01:48.370230 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:10:06.122413 | b6a48e49-11de-4aa2-91d5-89a67e7d9bb7 ==============================
[0m15:10:06.122522 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:10:06.125760 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:10:06.129230 [debug] [MainThread]: Tracking: tracking
[0m15:10:06.132122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c7f16fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c7f16970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c7f168b0>]}
[0m15:10:06.405004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:06.407431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:06.418896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a48e49-11de-4aa2-91d5-89a67e7d9bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c6cb10d0>]}
[0m15:10:06.457200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a48e49-11de-4aa2-91d5-89a67e7d9bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c6d9b970>]}
[0m15:10:06.459777 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:10:06.462334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a48e49-11de-4aa2-91d5-89a67e7d9bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c6d9b7c0>]}
[0m15:10:06.466576 [info ] [MainThread]: 
[0m15:10:06.469709 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:10:06.473349 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:10:06.500210 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:10:06.503185 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:10:06.505352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:09.088328 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 2.58 seconds
[0m15:10:09.099608 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:10:09.345741 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:10:09.360086 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:10:09.362719 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:10:09.365317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:10.407515 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.04 seconds
[0m15:10:10.413711 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:10:10.650345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a48e49-11de-4aa2-91d5-89a67e7d9bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c6cf8f70>]}
[0m15:10:10.656458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:10.660416 [info ] [MainThread]: 
[0m15:10:10.692137 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m15:10:10.695357 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m15:10:10.700766 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m15:10:10.703263 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m15:10:10.705363 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m15:10:10.730190 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:10:10.732955 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m15:10:10.736110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:11.585125 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.85 seconds
[0m15:10:11.607288 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m15:10:11.614520 [debug] [Thread-1  ]: finished collecting timing info
[0m15:10:11.616562 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m15:10:11.656537 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m15:10:11.665251 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:10:11.666972 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m15:10:12.046990 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.38 seconds
[0m15:10:12.079128 [debug] [Thread-1  ]: finished collecting timing info
[0m15:10:12.081849 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m15:10:12.355182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a48e49-11de-4aa2-91d5-89a67e7d9bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c60d4e80>]}
[0m15:10:12.358826 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.65s]
[0m15:10:12.361749 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m15:10:12.365953 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:10:12.368391 [info ] [MainThread]: 
[0m15:10:12.370532 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m15:10:12.373754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:12.375659 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m15:10:12.403642 [info ] [MainThread]: 
[0m15:10:12.406081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:12.408857 [info ] [MainThread]: 
[0m15:10:12.411267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:10:12.413682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c7f16fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c6d9b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c60d4df0>]}
[0m15:10:12.415987 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:38:45.896200 | f6d4b2cf-0935-467a-a9f3-5d48207c7896 ==============================
[0m15:38:45.896253 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:38:45.899737 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:38:45.902467 [debug] [MainThread]: Tracking: tracking
[0m15:38:45.904819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187b9a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187b9a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187b9a640>]}
[0m15:38:46.007453 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:38:46.010592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f6d4b2cf-0935-467a-a9f3-5d48207c7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187bb4b80>]}
[0m15:38:46.353322 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m15:38:46.356865 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m15:38:46.359882 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:38:46.364284 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:38:46.436813 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m15:38:46.447398 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m15:38:46.450994 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m15:38:46.460980 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m15:38:46.464255 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m15:38:46.467741 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m15:38:46.474772 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m15:38:46.491155 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:38:46.495246 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:38:46.498471 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:38:46.500671 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:38:46.503145 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:38:46.505224 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m15:38:46.509113 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m15:38:46.519365 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:38:46.524886 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:38:46.531784 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:38:46.543694 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:38:46.573427 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:38:46.578755 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:38:46.585155 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:38:46.588458 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:38:46.597916 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:38:46.607544 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:38:46.614162 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m15:38:46.624990 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:38:46.638239 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:38:46.666966 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:38:46.692148 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:38:46.709080 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:38:46.713295 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:38:46.717597 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:38:46.721479 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:38:46.729071 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:38:46.753182 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:38:46.773451 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:38:46.777964 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:38:46.800341 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:38:46.820989 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:38:46.826102 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:38:46.832043 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:38:46.844764 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m15:38:46.851790 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:38:46.856812 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:38:46.881218 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:38:46.889725 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:38:46.922111 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:38:46.936766 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:38:46.945615 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m15:38:46.948455 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:38:46.950902 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:38:46.953581 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:38:46.956425 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:38:46.958996 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:38:46.961984 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:38:46.964799 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:38:46.967539 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:38:46.977893 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:38:46.980884 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:38:46.983611 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:38:46.986694 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:38:46.989949 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:38:46.994598 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:38:46.998193 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:38:47.000886 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:38:47.004273 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m15:38:47.008609 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:38:47.011666 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:38:47.015472 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:38:47.018538 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:38:47.021941 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:38:47.026156 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:38:47.029156 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:38:47.031762 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:38:47.034046 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:38:47.036731 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:38:47.042475 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:38:47.046359 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:38:47.051296 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:38:47.055625 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:38:47.063635 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m15:38:47.068628 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m15:38:47.072052 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m15:38:47.075907 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m15:38:47.078931 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m15:38:47.084898 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m15:38:47.093977 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m15:38:47.098248 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m15:38:47.104011 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m15:38:47.121196 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m15:38:47.125640 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m15:38:47.129314 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m15:38:47.133140 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m15:38:47.136058 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m15:38:47.142447 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m15:38:47.160207 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m15:38:47.163193 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m15:38:47.166778 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m15:38:47.169932 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m15:38:47.174455 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m15:38:47.178243 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m15:38:47.182093 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m15:38:47.191183 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:38:47.194327 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:38:47.197269 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:38:47.200351 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:38:47.203431 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m15:38:47.251731 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m15:38:47.258691 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m15:38:47.263812 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m15:38:47.269553 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m15:38:47.275687 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m15:38:47.283771 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m15:38:47.289297 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m15:38:47.295473 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m15:38:47.317260 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m15:38:47.323622 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m15:38:47.329554 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m15:38:47.336044 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m15:38:47.341070 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m15:38:47.346761 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m15:38:47.353093 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m15:38:47.357373 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m15:38:47.361744 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m15:38:47.368363 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:38:47.378334 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:38:47.387677 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:38:47.398748 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:38:47.404504 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:38:47.413115 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:38:47.421460 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:38:47.435367 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:38:47.440285 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:38:47.444791 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:38:47.456439 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:38:47.461764 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:38:47.466359 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:38:47.475091 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:38:47.479761 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:38:47.488104 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:38:47.495745 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:38:47.512134 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:38:47.527806 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:38:47.533304 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:38:47.538501 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:38:48.103323 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m15:38:48.119701 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m15:38:48.124726 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m15:38:48.138979 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m15:38:48.150960 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m15:38:48.154184 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m15:38:48.190466 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m15:38:48.326771 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m15:38:48.441599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d4b2cf-0935-467a-a9f3-5d48207c7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9185be80d0>]}
[0m15:38:48.473304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d4b2cf-0935-467a-a9f3-5d48207c7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187a4bf40>]}
[0m15:38:48.475557 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:38:48.477591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d4b2cf-0935-467a-a9f3-5d48207c7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91869d6c10>]}
[0m15:38:48.480853 [info ] [MainThread]: 
[0m15:38:48.483127 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:38:48.485693 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:38:48.497887 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:38:48.499827 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:38:48.501826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:49.685988 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.18 seconds
[0m15:38:49.692698 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:38:49.988157 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:38:50.002598 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:38:50.005415 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:38:50.007928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:51.073399 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.07 seconds
[0m15:38:51.079370 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:38:51.366106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d4b2cf-0935-467a-a9f3-5d48207c7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9185be8700>]}
[0m15:38:51.370349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:51.373535 [info ] [MainThread]: 
[0m15:38:51.454643 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m15:38:51.458379 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m15:38:51.462712 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m15:38:51.465259 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m15:38:51.467788 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m15:38:51.480851 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:38:51.483206 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m15:38:51.485635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:52.346563 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m15:38:52.353263 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m15:38:52.363853 [debug] [Thread-1  ]: finished collecting timing info
[0m15:38:52.366543 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m15:38:52.410419 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m15:38:52.421960 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:38:52.423656 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m15:38:52.680808 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.26 seconds
[0m15:38:52.715173 [debug] [Thread-1  ]: finished collecting timing info
[0m15:38:52.718530 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m15:38:52.992127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d4b2cf-0935-467a-a9f3-5d48207c7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187ac3730>]}
[0m15:38:52.996008 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.53s]
[0m15:38:52.999183 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m15:38:53.003800 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:38:53.006693 [info ] [MainThread]: 
[0m15:38:53.009353 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m15:38:53.011906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:53.014061 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m15:38:53.049124 [info ] [MainThread]: 
[0m15:38:53.051573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:53.054024 [info ] [MainThread]: 
[0m15:38:53.056461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:38:53.059117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918d1c2bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918bcf95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187b57dc0>]}
[0m15:38:53.061425 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:38:59.429864 | c0930312-7b54-4c14-9718-2fbee2c63e5f ==============================
[0m15:38:59.429894 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:38:59.431684 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:38:59.435187 [debug] [MainThread]: Tracking: tracking
[0m15:38:59.437866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd2985ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd2985f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd2985f8b0>]}
[0m15:38:59.662233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:59.664189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:59.675274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0930312-7b54-4c14-9718-2fbee2c63e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd285f30d0>]}
[0m15:38:59.705664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0930312-7b54-4c14-9718-2fbee2c63e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd286dc970>]}
[0m15:38:59.707945 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:38:59.710207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0930312-7b54-4c14-9718-2fbee2c63e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd29839c70>]}
[0m15:38:59.715218 [info ] [MainThread]: 
[0m15:38:59.718320 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:38:59.721759 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:38:59.745059 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:38:59.747849 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:38:59.750239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:00.786465 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.04 seconds
[0m15:39:00.791988 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:39:01.055457 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:39:01.068934 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:39:01.071783 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:39:01.074385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:02.151506 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.08 seconds
[0m15:39:02.157584 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:39:02.391081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0930312-7b54-4c14-9718-2fbee2c63e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd28639f40>]}
[0m15:39:02.394800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:02.397765 [info ] [MainThread]: 
[0m15:39:02.418594 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m15:39:02.421711 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_revenue_by_month ..................... [RUN]
[0m15:39:02.424642 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_revenue_by_month"
[0m15:39:02.426804 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m15:39:02.429496 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m15:39:02.438983 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m15:39:02.448202 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:02.450221 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m15:39:02.492936 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m15:39:02.504522 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_revenue_by_month"
[0m15:39:02.506199 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
create or replace  view cs_dev.demo.customer_revenue_by_month
  
   as (
    with subscription_periods as (

    select * from cs_dev.demo.subscription_periods

),

months as (

    select * from cs_dev.demo.util_months

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m15:39:02.507859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:03.704680 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.2 seconds
[0m15:39:03.738376 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:03.741336 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m15:39:03.971290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0930312-7b54-4c14-9718-2fbee2c63e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd283377f0>]}
[0m15:39:03.974335 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_revenue_by_month ................ [[32mSUCCESS 1[0m in 1.55s]
[0m15:39:03.979274 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m15:39:03.983365 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:39:03.986326 [info ] [MainThread]: 
[0m15:39:03.988974 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m15:39:03.991437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:03.994048 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m15:39:04.022784 [info ] [MainThread]: 
[0m15:39:04.025188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:04.027491 [info ] [MainThread]: 
[0m15:39:04.030133 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:39:04.032449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd2837a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd2837a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd2837a130>]}
[0m15:39:04.034399 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:39:09.411245 | 1eff1894-b203-4d1e-9e64-1723139f73de ==============================
[0m15:39:09.411278 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:39:09.413738 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:39:09.416113 [debug] [MainThread]: Tracking: tracking
[0m15:39:09.419180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596c03a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596c03a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596c03a670>]}
[0m15:39:09.621789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:09.623500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:09.633119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eff1894-b203-4d1e-9e64-1723139f73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596adf20d0>]}
[0m15:39:09.661320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eff1894-b203-4d1e-9e64-1723139f73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596aedf940>]}
[0m15:39:09.663170 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:39:09.665056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eff1894-b203-4d1e-9e64-1723139f73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596aedf790>]}
[0m15:39:09.668312 [info ] [MainThread]: 
[0m15:39:09.670584 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:39:09.673100 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:39:09.692012 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:39:09.695613 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:39:09.698993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:10.662117 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.96 seconds
[0m15:39:10.668332 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:39:10.909695 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:39:10.923988 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:39:10.926572 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:39:10.929373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:11.994589 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.07 seconds
[0m15:39:12.000947 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:39:12.222332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eff1894-b203-4d1e-9e64-1723139f73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596c037910>]}
[0m15:39:12.226550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:12.232838 [info ] [MainThread]: 
[0m15:39:12.266534 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m15:39:12.269859 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_churn_month .......................... [RUN]
[0m15:39:12.273139 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_churn_month"
[0m15:39:12.275979 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m15:39:12.278355 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m15:39:12.286313 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m15:39:12.294618 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:12.297141 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m15:39:12.341078 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m15:39:12.348812 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_churn_month"
[0m15:39:12.350610 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
create or replace  view cs_dev.demo.customer_churn_month
  
   as (
    with mrr as (

    select * from cs_dev.demo.customer_revenue_by_month

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m15:39:12.352328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:13.573639 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.22 seconds
[0m15:39:13.607008 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:13.610139 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m15:39:13.849868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eff1894-b203-4d1e-9e64-1723139f73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596a32e7f0>]}
[0m15:39:13.853554 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_churn_month ..................... [[32mSUCCESS 1[0m in 1.58s]
[0m15:39:13.857308 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m15:39:13.862815 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:39:13.865944 [info ] [MainThread]: 
[0m15:39:13.868614 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m15:39:13.872410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:13.874726 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m15:39:13.905907 [info ] [MainThread]: 
[0m15:39:13.908552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:13.911188 [info ] [MainThread]: 
[0m15:39:13.913383 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:39:13.915594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596aedf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596a373fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596a3737c0>]}
[0m15:39:13.917916 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:39:20.101419 | af223aee-b7fe-4199-a540-2201b4bf6347 ==============================
[0m15:39:20.101457 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:39:20.103903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:39:20.106371 [debug] [MainThread]: Tracking: tracking
[0m15:39:20.108684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e91ad5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e91ad610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e91ad670>]}
[0m15:39:20.338017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:20.341372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:20.355364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af223aee-b7fe-4199-a540-2201b4bf6347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e8f730d0>]}
[0m15:39:20.388353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af223aee-b7fe-4199-a540-2201b4bf6347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e905d940>]}
[0m15:39:20.390768 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:39:20.393416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af223aee-b7fe-4199-a540-2201b4bf6347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e905d790>]}
[0m15:39:20.397523 [info ] [MainThread]: 
[0m15:39:20.400581 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:39:20.404159 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:39:20.428024 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:39:20.430973 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:39:20.433517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:21.757849 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.32 seconds
[0m15:39:21.763304 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:39:22.020340 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:39:22.036650 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:39:22.039170 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:39:22.041465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:22.972803 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.93 seconds
[0m15:39:22.978975 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:39:23.248078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af223aee-b7fe-4199-a540-2201b4bf6347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e91ae700>]}
[0m15:39:23.253133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:23.255887 [info ] [MainThread]: 
[0m15:39:23.277775 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m15:39:23.280945 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.mrr ........................................... [RUN]
[0m15:39:23.284299 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m15:39:23.287301 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m15:39:23.289444 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m15:39:23.309880 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m15:39:23.325223 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m15:39:23.335061 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:23.337345 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m15:39:23.382394 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m15:39:23.394058 [debug] [Thread-1  ]: Using snowflake connection "model.acme.mrr"
[0m15:39:23.396371 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.mrr"} */
create or replace  view cs_dev.demo.mrr
  
   as (
    with unioned as (

    select * from cs_dev.demo.customer_revenue_by_month

    union all

    select * from cs_dev.demo.customer_churn_month

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m15:39:23.398529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:25.274621 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.88 seconds
[0m15:39:25.309072 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:25.312933 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m15:39:25.586377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af223aee-b7fe-4199-a540-2201b4bf6347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e83e5a30>]}
[0m15:39:25.589787 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.mrr ...................................... [[32mSUCCESS 1[0m in 2.30s]
[0m15:39:25.593145 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m15:39:25.597733 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:39:25.600494 [info ] [MainThread]: 
[0m15:39:25.603064 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m15:39:25.605458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:25.607610 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m15:39:25.636789 [info ] [MainThread]: 
[0m15:39:25.639513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:25.641974 [info ] [MainThread]: 
[0m15:39:25.644150 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:39:25.646616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90edd4d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e905d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e84fd370>]}
[0m15:39:25.649074 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:42:15.836123 | a5f8ba11-e893-4f17-b304-bcb23671d4e8 ==============================
[0m15:42:15.836183 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:42:15.838928 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:42:15.841767 [debug] [MainThread]: Tracking: tracking
[0m15:42:15.845231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddc0c85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddc0c8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddc0c8670>]}
[0m15:42:16.234231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:16.237529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:16.253551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5f8ba11-e893-4f17-b304-bcb23671d4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddae720d0>]}
[0m15:42:16.286977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5f8ba11-e893-4f17-b304-bcb23671d4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddaf58940>]}
[0m15:42:16.289318 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:42:16.291751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5f8ba11-e893-4f17-b304-bcb23671d4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddaf58790>]}
[0m15:42:16.295889 [info ] [MainThread]: 
[0m15:42:16.299163 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:42:16.303838 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:42:16.333597 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:42:16.336990 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:42:16.339967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:17.447054 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.11 seconds
[0m15:42:17.454212 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:42:17.698015 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:42:17.713868 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:42:17.738088 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:42:17.741265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:18.565236 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.82 seconds
[0m15:42:18.571005 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:42:18.822703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5f8ba11-e893-4f17-b304-bcb23671d4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddc0c9910>]}
[0m15:42:18.826258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:18.828773 [info ] [MainThread]: 
[0m15:42:18.849095 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m15:42:18.853021 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m15:42:18.857071 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m15:42:18.859588 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m15:42:18.862367 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m15:42:18.887540 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:42:18.890475 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m15:42:18.893067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:42:19.674279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m15:42:19.698177 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m15:42:19.705875 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:19.708464 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m15:42:19.755580 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m15:42:19.767985 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m15:42:19.771127 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m15:42:20.020779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m15:42:20.056462 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:20.058664 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m15:42:20.321585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5f8ba11-e893-4f17-b304-bcb23671d4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dda3b47c0>]}
[0m15:42:20.325012 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.47s]
[0m15:42:20.328879 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m15:42:20.335758 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:42:20.339498 [info ] [MainThread]: 
[0m15:42:20.344157 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m15:42:20.348370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:20.352159 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m15:42:20.390032 [info ] [MainThread]: 
[0m15:42:20.396144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:20.399653 [info ] [MainThread]: 
[0m15:42:20.403129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:20.407422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dda3dc670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dda3dc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dda3dc1c0>]}
[0m15:42:20.410433 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:42:27.312956 | 15fc1939-3936-49bd-9c2f-b620e21f7bce ==============================
[0m15:42:27.313033 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:42:27.318753 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:42:27.323702 [debug] [MainThread]: Tracking: tracking
[0m15:42:27.330393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836067c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836067c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836067c670>]}
[0m15:42:27.588673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:27.590265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:27.599760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15fc1939-3936-49bd-9c2f-b620e21f7bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f4320d0>]}
[0m15:42:27.626590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15fc1939-3936-49bd-9c2f-b620e21f7bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f51d940>]}
[0m15:42:27.628385 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:42:27.630187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15fc1939-3936-49bd-9c2f-b620e21f7bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f51d790>]}
[0m15:42:27.633366 [info ] [MainThread]: 
[0m15:42:27.635508 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:42:27.638089 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:42:27.657507 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:42:27.659779 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:42:27.661633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:28.793546 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.13 seconds
[0m15:42:28.799545 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:42:29.026051 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:42:29.041777 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:42:29.044461 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:42:29.047163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:30.236102 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.19 seconds
[0m15:42:30.240850 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:42:30.501278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15fc1939-3936-49bd-9c2f-b620e21f7bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8360677910>]}
[0m15:42:30.506361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:30.510724 [info ] [MainThread]: 
[0m15:42:30.539690 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m15:42:30.542264 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_revenue_by_month ..................... [RUN]
[0m15:42:30.545156 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_revenue_by_month"
[0m15:42:30.547293 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m15:42:30.549718 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m15:42:30.558271 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m15:42:30.565342 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:30.568072 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m15:42:30.608600 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m15:42:30.620617 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_revenue_by_month"
[0m15:42:30.622731 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
create or replace  view cs_dev.demo.customer_revenue_by_month
  
   as (
    with subscription_periods as (

    select * from cs_dev.demo.subscription_periods

),

months as (

    select * from cs_dev.demo.util_months

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m15:42:30.625544 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:42:31.656368 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.03 seconds
[0m15:42:31.689202 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:31.692171 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m15:42:31.901864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15fc1939-3936-49bd-9c2f-b620e21f7bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835e9c0d30>]}
[0m15:42:31.905393 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_revenue_by_month ................ [[32mSUCCESS 1[0m in 1.36s]
[0m15:42:31.908571 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m15:42:31.912639 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:42:31.915742 [info ] [MainThread]: 
[0m15:42:31.918754 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m15:42:31.922020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:31.924185 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m15:42:31.956464 [info ] [MainThread]: 
[0m15:42:31.960448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:31.963424 [info ] [MainThread]: 
[0m15:42:31.965934 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:31.969071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8366f8ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f4cd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f4cd280>]}
[0m15:42:31.973334 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:42:38.301290 | 51e8afdf-25c3-43c6-988f-0f67ad4d56c3 ==============================
[0m15:42:38.301317 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:42:38.303438 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:42:38.305474 [debug] [MainThread]: Tracking: tracking
[0m15:42:38.307546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72f4e25b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72f4e2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72f4e2670>]}
[0m15:42:38.539765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:38.541969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:38.553991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e8afdf-25c3-43c6-988f-0f67ad4d56c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72e2730d0>]}
[0m15:42:38.590921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e8afdf-25c3-43c6-988f-0f67ad4d56c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72e35d940>]}
[0m15:42:38.593468 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:42:38.595472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e8afdf-25c3-43c6-988f-0f67ad4d56c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72e35d790>]}
[0m15:42:38.599309 [info ] [MainThread]: 
[0m15:42:38.602140 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:42:38.605486 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:42:38.632899 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:42:38.635921 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:42:38.638056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:39.742871 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.1 seconds
[0m15:42:39.749817 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:42:39.988613 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:42:40.000515 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:42:40.002860 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:42:40.004856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:41.040787 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.04 seconds
[0m15:42:41.047810 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:42:41.303349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e8afdf-25c3-43c6-988f-0f67ad4d56c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72f4e4700>]}
[0m15:42:41.308011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:41.311207 [info ] [MainThread]: 
[0m15:42:41.330999 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m15:42:41.333842 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_churn_month .......................... [RUN]
[0m15:42:41.337069 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_churn_month"
[0m15:42:41.339447 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m15:42:41.341547 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m15:42:41.348913 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m15:42:41.355618 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:41.357637 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m15:42:41.397570 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m15:42:41.404458 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_churn_month"
[0m15:42:41.406434 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
create or replace  view cs_dev.demo.customer_churn_month
  
   as (
    with mrr as (

    select * from cs_dev.demo.customer_revenue_by_month

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m15:42:41.408212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:42:42.673490 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.27 seconds
[0m15:42:42.703555 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:42.706149 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m15:42:42.974152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e8afdf-25c3-43c6-988f-0f67ad4d56c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72d7b8820>]}
[0m15:42:42.977534 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_churn_month ..................... [[32mSUCCESS 1[0m in 1.64s]
[0m15:42:42.980929 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m15:42:42.985481 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:42:42.988855 [info ] [MainThread]: 
[0m15:42:42.991391 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m15:42:42.993982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:42.996100 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m15:42:43.028965 [info ] [MainThread]: 
[0m15:42:43.031361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:43.033598 [info ] [MainThread]: 
[0m15:42:43.035955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:43.038533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72e35d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72e0e4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc72e0e4a30>]}
[0m15:42:43.040636 [debug] [MainThread]: Flushing usage events


============================== 2023-02-08 15:42:48.151474 | d49f69a4-90f9-42a1-8677-9de8d8656450 ==============================
[0m15:42:48.151502 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:42:48.154715 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:42:48.157064 [debug] [MainThread]: Tracking: tracking
[0m15:42:48.160021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b9da7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b9da75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b9da7640>]}
[0m15:42:48.363516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:48.365351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:48.375000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd49f69a4-90f9-42a1-8677-9de8d8656450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b8b330d0>]}
[0m15:42:48.401120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd49f69a4-90f9-42a1-8677-9de8d8656450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b9c51910>]}
[0m15:42:48.403001 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:42:48.404865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd49f69a4-90f9-42a1-8677-9de8d8656450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b9c51760>]}
[0m15:42:48.408124 [info ] [MainThread]: 
[0m15:42:48.410411 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:42:48.413049 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m15:42:48.433914 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m15:42:48.436524 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m15:42:48.438424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:49.676316 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.24 seconds
[0m15:42:49.683086 [debug] [ThreadPool]: On list_cs_dev: Close
[0m15:42:49.979827 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m15:42:49.992309 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m15:42:49.994695 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m15:42:49.997015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:50.895783 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.9 seconds
[0m15:42:50.902085 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m15:42:51.203310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd49f69a4-90f9-42a1-8677-9de8d8656450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b9da4580>]}
[0m15:42:51.207349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:51.210171 [info ] [MainThread]: 
[0m15:42:51.232304 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m15:42:51.235149 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.mrr ........................................... [RUN]
[0m15:42:51.238645 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m15:42:51.241501 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m15:42:51.244301 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m15:42:51.263526 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m15:42:51.276201 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m15:42:51.282948 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:51.284991 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m15:42:51.320437 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m15:42:51.329452 [debug] [Thread-1  ]: Using snowflake connection "model.acme.mrr"
[0m15:42:51.331302 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.mrr"} */
create or replace  view cs_dev.demo.mrr
  
   as (
    with unioned as (

    select * from cs_dev.demo.customer_revenue_by_month

    union all

    select * from cs_dev.demo.customer_churn_month

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m15:42:51.333053 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:42:53.427505 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.09 seconds
[0m15:42:53.460676 [debug] [Thread-1  ]: finished collecting timing info
[0m15:42:53.464907 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m15:42:53.712148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49f69a4-90f9-42a1-8677-9de8d8656450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b3f3ad60>]}
[0m15:42:53.715158 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.mrr ...................................... [[32mSUCCESS 1[0m in 2.47s]
[0m15:42:53.718187 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m15:42:53.722830 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:42:53.725793 [info ] [MainThread]: 
[0m15:42:53.728193 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m15:42:53.730380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:53.732392 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m15:42:53.767119 [info ] [MainThread]: 
[0m15:42:53.769362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:53.771442 [info ] [MainThread]: 
[0m15:42:53.773507 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:53.775669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b80535e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b80539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b80531f0>]}
[0m15:42:53.777426 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 17:15:56.793384 | f937d9e6-d2e2-4d6f-aa2d-ac29183ae8d7 ==============================
[0m17:15:56.793450 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:15:56.796159 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:15:56.798054 [debug] [MainThread]: Tracking: tracking
[0m17:15:56.800563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180a562a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180a562970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180a5628b0>]}
[0m17:15:56.933974 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:15:56.936836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f937d9e6-d2e2-4d6f-aa2d-ac29183ae8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180a57d3d0>]}
[0m17:15:57.462153 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m17:15:57.467014 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m17:15:57.471812 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:15:57.477993 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:15:57.554574 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m17:15:57.564196 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m17:15:57.567466 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m17:15:57.577506 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m17:15:57.580559 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m17:15:57.584187 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m17:15:57.591212 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m17:15:57.609685 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:15:57.612352 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:15:57.614604 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:15:57.617211 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:15:57.620062 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:15:57.622513 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m17:15:57.627204 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m17:15:57.638552 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:15:57.644110 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:15:57.652003 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:15:57.665474 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:15:57.697437 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:15:57.703507 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:15:57.710866 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:15:57.714423 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:15:57.724835 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:15:57.736472 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:15:57.743356 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m17:15:57.756960 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:15:57.773600 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:15:57.806053 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:15:57.841079 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:15:57.874866 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:15:57.887383 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:15:57.938601 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:15:57.945223 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:15:57.958761 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:15:57.988792 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:15:58.010224 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:15:58.015261 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:15:58.038839 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:15:58.060017 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:15:58.064923 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:15:58.070363 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:15:58.082553 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m17:15:58.088821 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:15:58.093309 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:15:58.117465 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:15:58.125968 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:15:58.144222 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:15:58.161518 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:15:58.172467 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m17:15:58.175749 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:15:58.179024 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:15:58.182090 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:15:58.185366 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:15:58.188354 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:15:58.192393 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:15:58.196233 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:15:58.200034 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:15:58.213324 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:15:58.217029 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:15:58.220343 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:15:58.223440 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:15:58.226968 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:15:58.231612 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:15:58.234412 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:15:58.237262 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:15:58.240673 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m17:15:58.244688 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:15:58.247529 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:15:58.251573 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:15:58.254295 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:15:58.257714 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:15:58.262684 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:15:58.265422 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:15:58.268608 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:15:58.271269 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:15:58.274205 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:15:58.278002 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:15:58.281812 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:15:58.287356 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:15:58.291811 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:15:58.299081 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m17:15:58.304962 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m17:15:58.309027 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m17:15:58.313937 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m17:15:58.317733 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m17:15:58.325260 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m17:15:58.336593 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m17:15:58.341342 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m17:15:58.348336 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m17:15:58.367358 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m17:15:58.370794 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m17:15:58.374216 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m17:15:58.378233 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m17:15:58.381421 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m17:15:58.387889 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m17:15:58.391570 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m17:15:58.394654 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m17:15:58.398594 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m17:15:58.403228 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m17:15:58.407871 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m17:15:58.413607 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m17:15:58.419057 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m17:15:58.432221 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m17:15:58.437068 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m17:15:58.441375 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m17:15:58.445869 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m17:15:58.450358 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m17:15:58.497622 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m17:15:58.503209 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m17:15:58.506498 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m17:15:58.511049 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m17:15:58.514948 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m17:15:58.521837 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m17:15:58.527539 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m17:15:58.532682 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m17:15:58.552360 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m17:15:58.559010 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m17:15:58.563624 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m17:15:58.568706 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m17:15:58.572756 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m17:15:58.577885 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m17:15:58.583764 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m17:15:58.587470 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m17:15:58.591311 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m17:15:58.597598 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m17:15:58.606346 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m17:15:58.614870 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m17:15:58.625585 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m17:15:58.630671 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m17:15:58.637872 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m17:15:58.646752 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m17:15:58.666393 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m17:15:58.671188 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m17:15:58.674509 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m17:15:58.684801 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m17:15:58.689075 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m17:15:58.694916 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m17:15:58.748225 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m17:15:58.753450 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m17:15:58.762963 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m17:15:58.770806 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m17:15:58.786863 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m17:15:58.800794 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m17:15:58.805608 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m17:15:58.809258 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m17:15:59.343980 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m17:15:59.369644 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m17:15:59.376280 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m17:15:59.398730 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m17:15:59.417036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m17:15:59.421850 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m17:15:59.467577 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m17:15:59.607542 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m17:15:59.723077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f937d9e6-d2e2-4d6f-aa2d-ac29183ae8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18085530d0>]}
[0m17:15:59.759415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f937d9e6-d2e2-4d6f-aa2d-ac29183ae8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180a4e7550>]}
[0m17:15:59.761851 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:15:59.764175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f937d9e6-d2e2-4d6f-aa2d-ac29183ae8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180d3058e0>]}
[0m17:15:59.767651 [info ] [MainThread]: 
[0m17:15:59.770071 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:15:59.772836 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m17:15:59.786141 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m17:15:59.788298 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m17:15:59.790665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:00.441561 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.65 seconds
[0m17:16:00.450489 [debug] [ThreadPool]: On list_cs_dev: Close
[0m17:16:00.574880 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m17:16:00.596793 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m17:16:00.601047 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m17:16:00.604956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:01.232613 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.63 seconds
[0m17:16:01.237219 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m17:16:01.366252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f937d9e6-d2e2-4d6f-aa2d-ac29183ae8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18082e5970>]}
[0m17:16:01.371665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:01.378060 [info ] [MainThread]: 
[0m17:16:01.404467 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m17:16:01.408588 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m17:16:01.412681 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m17:16:01.415937 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m17:16:01.418739 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m17:16:01.432620 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m17:16:01.435556 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m17:16:01.438298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:02.009070 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m17:16:02.019469 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m17:16:02.036783 [debug] [Thread-1  ]: finished collecting timing info
[0m17:16:02.040286 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m17:16:02.087584 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m17:16:02.104794 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m17:16:02.106833 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m17:16:02.349640 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m17:16:02.384683 [debug] [Thread-1  ]: finished collecting timing info
[0m17:16:02.388195 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m17:16:02.521879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f937d9e6-d2e2-4d6f-aa2d-ac29183ae8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18092c9580>]}
[0m17:16:02.526390 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.11s]
[0m17:16:02.530584 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m17:16:02.549729 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:16:02.553637 [info ] [MainThread]: 
[0m17:16:02.556359 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m17:16:02.562643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:02.566346 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m17:16:02.605885 [info ] [MainThread]: 
[0m17:16:02.609612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:02.612866 [info ] [MainThread]: 
[0m17:16:02.615555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:02.618630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180fbc84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18082f8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180865ca30>]}
[0m17:16:02.621070 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 17:25:11.976585 | 5fe7e182-9b17-410d-9784-a1dae759145c ==============================
[0m17:25:11.976646 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:25:11.979213 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:25:11.981887 [debug] [MainThread]: Tracking: tracking
[0m17:25:11.983915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fbd8e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fbd8e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fbd8e670>]}
[0m17:25:12.187949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:12.189711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:12.199359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fe7e182-9b17-410d-9784-a1dae759145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fab350d0>]}
[0m17:25:12.225566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fe7e182-9b17-410d-9784-a1dae759145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fbc35c40>]}
[0m17:25:12.227519 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:25:12.229303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe7e182-9b17-410d-9784-a1dae759145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fbc35a90>]}
[0m17:25:12.232430 [info ] [MainThread]: 
[0m17:25:12.234755 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:12.237250 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m17:25:12.256377 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m17:25:12.260476 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m17:25:12.263764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:13.194251 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.93 seconds
[0m17:25:13.200613 [debug] [ThreadPool]: On list_cs_dev: Close
[0m17:25:13.308203 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m17:25:13.321299 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m17:25:13.323880 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m17:25:13.326656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:14.066654 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.74 seconds
[0m17:25:14.072544 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m17:25:14.187766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe7e182-9b17-410d-9784-a1dae759145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fbd8f670>]}
[0m17:25:14.191900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:14.195218 [info ] [MainThread]: 
[0m17:25:14.216400 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m17:25:14.219374 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m17:25:14.222240 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.util_months"
[0m17:25:14.224829 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m17:25:14.228614 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m17:25:14.254522 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m17:25:14.257238 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m17:25:14.261230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:14.708462 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m17:25:14.733059 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m17:25:14.741711 [debug] [Thread-1  ]: finished collecting timing info
[0m17:25:14.744611 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m17:25:14.784485 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m17:25:14.792468 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m17:25:14.794336 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace  view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m17:25:15.078544 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m17:25:15.112170 [debug] [Thread-1  ]: finished collecting timing info
[0m17:25:15.115250 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m17:25:15.240856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe7e182-9b17-410d-9784-a1dae759145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f9f52d00>]}
[0m17:25:15.245053 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.02s]
[0m17:25:15.248174 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m17:25:15.252710 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:15.255380 [info ] [MainThread]: 
[0m17:25:15.258071 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m17:25:15.260847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:15.263244 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m17:25:15.292823 [info ] [MainThread]: 
[0m17:25:15.295575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:15.297947 [info ] [MainThread]: 
[0m17:25:15.300507 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:15.302900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fbd8e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fbd8bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f9f093d0>]}
[0m17:25:15.305309 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 17:25:19.859530 | a7d5dda8-e256-4cb0-a71a-92d981d845e5 ==============================
[0m17:25:19.859558 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:25:19.862073 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:25:19.864582 [debug] [MainThread]: Tracking: tracking
[0m17:25:19.866621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfcfebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfcfeb970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfcfeb8b0>]}
[0m17:25:20.055962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:20.057838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:20.067492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7d5dda8-e256-4cb0-a71a-92d981d845e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfcdb60d0>]}
[0m17:25:20.096390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7d5dda8-e256-4cb0-a71a-92d981d845e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfce99ca0>]}
[0m17:25:20.098258 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:25:20.100038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7d5dda8-e256-4cb0-a71a-92d981d845e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfce99af0>]}
[0m17:25:20.103077 [info ] [MainThread]: 
[0m17:25:20.105274 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:20.107872 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m17:25:20.128664 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m17:25:20.132823 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m17:25:20.134778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:21.013295 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.88 seconds
[0m17:25:21.020359 [debug] [ThreadPool]: On list_cs_dev: Close
[0m17:25:21.139820 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m17:25:21.154153 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m17:25:21.156663 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m17:25:21.159310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:21.654097 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.49 seconds
[0m17:25:21.658618 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m17:25:21.768124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7d5dda8-e256-4cb0-a71a-92d981d845e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfcfd40a0>]}
[0m17:25:21.772045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:21.776069 [info ] [MainThread]: 
[0m17:25:21.798061 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m17:25:21.801371 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_revenue_by_month ..................... [RUN]
[0m17:25:21.804778 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_revenue_by_month"
[0m17:25:21.807821 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m17:25:21.810892 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m17:25:21.818877 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m17:25:21.826345 [debug] [Thread-1  ]: finished collecting timing info
[0m17:25:21.828671 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m17:25:21.870212 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m17:25:21.881662 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_revenue_by_month"
[0m17:25:21.883477 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
create or replace  view cs_dev.demo.customer_revenue_by_month
  
   as (
    with subscription_periods as (

    select * from cs_dev.demo.subscription_periods

),

months as (

    select * from cs_dev.demo.util_months

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m17:25:21.885019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:22.674522 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.79 seconds
[0m17:25:22.707867 [debug] [Thread-1  ]: finished collecting timing info
[0m17:25:22.711311 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m17:25:22.847593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d5dda8-e256-4cb0-a71a-92d981d845e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfc1927c0>]}
[0m17:25:22.851020 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_revenue_by_month ................ [[32mSUCCESS 1[0m in 1.04s]
[0m17:25:22.854163 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m17:25:22.858636 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:22.861897 [info ] [MainThread]: 
[0m17:25:22.864566 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m17:25:22.866829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:22.868826 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m17:25:22.900759 [info ] [MainThread]: 
[0m17:25:22.903610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:22.905840 [info ] [MainThread]: 
[0m17:25:22.908356 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:22.911062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfcfeb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfce99670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfc1a1070>]}
[0m17:25:22.913212 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 17:25:27.572640 | 7ff9da21-679a-41d3-8e50-4d377560f6ce ==============================
[0m17:25:27.572667 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:25:27.574719 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:25:27.576940 [debug] [MainThread]: Tracking: tracking
[0m17:25:27.579621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2936690fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2936690970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29366908b0>]}
[0m17:25:27.771657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:27.773280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:27.782954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ff9da21-679a-41d3-8e50-4d377560f6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29354340d0>]}
[0m17:25:27.811906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ff9da21-679a-41d3-8e50-4d377560f6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2935519ca0>]}
[0m17:25:27.813994 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:25:27.815963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ff9da21-679a-41d3-8e50-4d377560f6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2935519af0>]}
[0m17:25:27.819799 [info ] [MainThread]: 
[0m17:25:27.822286 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:27.827864 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m17:25:27.848529 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m17:25:27.851190 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m17:25:27.852874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:28.665550 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.81 seconds
[0m17:25:28.671228 [debug] [ThreadPool]: On list_cs_dev: Close
[0m17:25:28.782295 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m17:25:28.796285 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m17:25:28.798867 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m17:25:28.801162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:29.533007 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.73 seconds
[0m17:25:29.539278 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m17:25:29.666409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ff9da21-679a-41d3-8e50-4d377560f6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29366790a0>]}
[0m17:25:29.669968 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:29.672695 [info ] [MainThread]: 
[0m17:25:29.693906 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m17:25:29.696781 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_churn_month .......................... [RUN]
[0m17:25:29.700427 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.customer_churn_month"
[0m17:25:29.702628 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m17:25:29.704761 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m17:25:29.711416 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m17:25:29.718843 [debug] [Thread-1  ]: finished collecting timing info
[0m17:25:29.721165 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m17:25:29.763700 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m17:25:29.773372 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_churn_month"
[0m17:25:29.775623 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
create or replace  view cs_dev.demo.customer_churn_month
  
   as (
    with mrr as (

    select * from cs_dev.demo.customer_revenue_by_month

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m17:25:29.778380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:30.634321 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m17:25:30.666444 [debug] [Thread-1  ]: finished collecting timing info
[0m17:25:30.669359 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m17:25:30.804928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ff9da21-679a-41d3-8e50-4d377560f6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293481f160>]}
[0m17:25:30.810752 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_churn_month ..................... [[32mSUCCESS 1[0m in 1.11s]
[0m17:25:30.813999 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m17:25:30.818739 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:30.822549 [info ] [MainThread]: 
[0m17:25:30.825592 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m17:25:30.828512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:30.830690 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m17:25:30.860123 [info ] [MainThread]: 
[0m17:25:30.863008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:30.865529 [info ] [MainThread]: 
[0m17:25:30.867807 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:30.870189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2934864070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2934864eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2934864430>]}
[0m17:25:30.872527 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 17:25:35.669707 | ac1ccfa8-5a47-4781-b684-8fb9bab4a2b6 ==============================
[0m17:25:35.669730 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:25:35.671324 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:25:35.673229 [debug] [MainThread]: Tracking: tracking
[0m17:25:35.675204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caf675fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caf675970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caf6758b0>]}
[0m17:25:35.908633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:35.911912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:35.923830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac1ccfa8-5a47-4781-b684-8fb9bab4a2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cae4360d0>]}
[0m17:25:35.959319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac1ccfa8-5a47-4781-b684-8fb9bab4a2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cae519c70>]}
[0m17:25:35.962141 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 491 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:25:35.964361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac1ccfa8-5a47-4781-b684-8fb9bab4a2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cae519ac0>]}
[0m17:25:35.968363 [info ] [MainThread]: 
[0m17:25:35.971173 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:35.974319 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev"
[0m17:25:35.996897 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m17:25:35.999598 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m17:25:36.001535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:36.616490 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.61 seconds
[0m17:25:36.624708 [debug] [ThreadPool]: On list_cs_dev: Close
[0m17:25:36.743217 [debug] [ThreadPool]: Acquiring new snowflake connection "list_cs_dev_demo"
[0m17:25:36.754065 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m17:25:36.756190 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m17:25:36.758534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:37.520792 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.76 seconds
[0m17:25:37.527222 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m17:25:37.659623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac1ccfa8-5a47-4781-b684-8fb9bab4a2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caf65ed00>]}
[0m17:25:37.662953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:37.665616 [info ] [MainThread]: 
[0m17:25:37.686738 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m17:25:37.690086 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.mrr ........................................... [RUN]
[0m17:25:37.693902 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.acme.mrr"
[0m17:25:37.696481 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m17:25:37.698711 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m17:25:37.716507 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m17:25:37.729232 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m17:25:37.736153 [debug] [Thread-1  ]: finished collecting timing info
[0m17:25:37.738128 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m17:25:37.773271 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m17:25:37.782849 [debug] [Thread-1  ]: Using snowflake connection "model.acme.mrr"
[0m17:25:37.784543 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.mrr"} */
create or replace  view cs_dev.demo.mrr
  
   as (
    with unioned as (

    select * from cs_dev.demo.customer_revenue_by_month

    union all

    select * from cs_dev.demo.customer_churn_month

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m17:25:37.786892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:39.053933 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.27 seconds
[0m17:25:39.083013 [debug] [Thread-1  ]: finished collecting timing info
[0m17:25:39.086058 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m17:25:39.185425 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac1ccfa8-5a47-4781-b684-8fb9bab4a2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caf69e730>]}
[0m17:25:39.189317 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.mrr ...................................... [[32mSUCCESS 1[0m in 1.49s]
[0m17:25:39.192356 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m17:25:39.196500 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m17:25:39.198945 [info ] [MainThread]: 
[0m17:25:39.201369 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m17:25:39.203409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:39.205357 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m17:25:39.230185 [info ] [MainThread]: 
[0m17:25:39.232234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:39.234028 [info ] [MainThread]: 
[0m17:25:39.236074 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:39.237954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cb3722520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cae2a8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cae2a8280>]}
[0m17:25:39.239626 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 20:15:19.659319 | ec08cfcd-e7b4-4f50-9ea0-c91603f17b05 ==============================
[0m20:15:19.659319 [info ] [MainThread]: Running with dbt=1.4.1
[0m20:15:19.661699 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:15:19.664902 [debug] [MainThread]: Tracking: tracking
[0m20:15:19.669542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe807dbdbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe807dbda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe807dbdac0>]}
[0m20:15:19.824718 [debug] [MainThread]: Failed to load parsed file from disk at /usr/local/airflow/include/dbt/mrr-playbook/target/partial_parse.msgpack: Field "docs" of type MutableMapping[str, Documentation] in Manifest has invalid value {'acme.mrr': {'unique_id': 'acme.mrr', 'package_name': 'acme', 'root_path': '/usr/local/airflow/include/dbt/mrr-playbook', 'path': 'mrr.md', 'original_file_path': 'models/mrr.md', 'name': 'mrr', 'block_contents': 'This model represents one record per month, per account (months have been filled\nin to include any periods of inactivity).\n\nThis model classifies each month as one of: `new`, `reactivation`, `upgrade`,\n`downgrade`, or `churn`.'}, 'acme.change_category': {'unique_id': 'acme.change_category', 'package_name': 'acme', 'root_path': '/usr/local/airflow/include/dbt/mrr-playbook', 'path': 'mrr.md', 'original_file_path': 'models/mrr.md', 'name': 'change_category', 'block_contents': '| Category       | Definition                                                                                              |\n|----------------|---------------------------------------------------------------------------------------------------------|\n| new            | The customer is a new customer that has not had a previous subscription                                 |\n| churn          | Last month the customer paid for a subscription, but this month is not. A customer can churn many times |\n| upgrade        | The customer has increased their usage and is now paying you more money per month                       |\n| downgrade      | The customer has decreased their usage and is now paying you less money per month                       |\n| reactivation   | A previously churned customer has started subscribing again                                             |\n| (null)         | No change compared to last month                                                                        |'}, 'acme.__overview__': {'unique_id': 'acme.__overview__', 'package_name': 'acme', 'root_path': '/usr/local/airflow/include/dbt/mrr-playbook', 'path': 'overview.md', 'original_file_path': 'models/overview.md', 'name': '__overview__', 'block_contents': '# Monthly Recurring Revenue (MRR) playbook.\nThis dbt project is a worked example to demonstrate how to model subscription\nrevenue. **Check out the full write-up [here](https://blog.getdbt.com/modeling-subscription-revenue/),\nas well as the repo for this project [here](https://github.com/fishtown-analytics/mrr-playbook/).**\n\nNote that this project is not a package -- it is not intended to be installed in\nyour own dbt project, but instead provides a good starting point for building\nsimilar data models for your own business.\n\nThe SQL in this project is compatible with Snowflake¹.\n\nIf you want to run this project yourself to play with it (assuming you have\ndbt installed):\n1. Clone [this repo](https://github.com/fishtown-analytics/mrr-playbook).\n2. Create a profile named `playbook`, or update the `profile:` key in the\n`dbt_project.yml` file to point to an existing profile ([docs](https://docs.getdbt.com/docs/configure-your-profile)).\n3. Run `dbt deps`.\n4. Run `dbt seed`.\n5. Run `dbt run` -- if you are using a warehouse other than Snowflake, you may\nfind that you have to update some SQL to be compatible with your warehouse.\n6. Run `dbt test`.\n-----\n1. We decided to _not_ make the SQL multi-warehouse compatible since this project\nis intended to be a demonstration, rather than a package. Making this project\nmulti-warehouse compatible would complicate the SQL.'}, 'dbt.__overview__': {'unique_id': 'dbt.__overview__', 'package_name': 'dbt', 'root_path': '/usr/local/airflow/dbt_venv/lib/python3.9/site-packages/dbt/include/global_project', 'path': 'overview.md', 'original_file_path': 'docs/overview.md', 'name': '__overview__', 'block_contents': "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}
[0m20:15:19.829379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec08cfcd-e7b4-4f50-9ea0-c91603f17b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe807c5dfa0>]}
[0m20:15:22.267526 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m20:15:22.285067 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m20:15:22.290799 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m20:15:22.308014 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m20:15:22.320959 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m20:15:22.324848 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m20:15:22.365588 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m20:15:22.528801 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m20:15:22.663653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec08cfcd-e7b4-4f50-9ea0-c91603f17b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8076e00d0>]}
[0m20:15:22.697453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec08cfcd-e7b4-4f50-9ea0-c91603f17b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80c0369d0>]}
[0m20:15:22.700054 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 492 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m20:15:22.702285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec08cfcd-e7b4-4f50-9ea0-c91603f17b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80777f7f0>]}
[0m20:15:22.707173 [info ] [MainThread]: 
[0m20:15:22.711162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:22.715026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_cs_dev'
[0m20:15:22.730614 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m20:15:22.734169 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m20:15:22.737116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:23.429535 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1 seconds
[0m20:15:23.436158 [debug] [ThreadPool]: On list_cs_dev: Close
[0m20:15:23.549241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_cs_dev_demo'
[0m20:15:23.562664 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m20:15:23.566195 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m20:15:23.568813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:24.222505 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1 seconds
[0m20:15:24.249207 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m20:15:24.381910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec08cfcd-e7b4-4f50-9ea0-c91603f17b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8076ed160>]}
[0m20:15:24.386814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:24.405902 [info ] [MainThread]: 
[0m20:15:24.430167 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m20:15:24.433553 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.util_months ................................... [RUN]
[0m20:15:24.454283 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.acme.util_months'
[0m20:15:24.473928 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m20:15:24.524259 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m20:15:24.527926 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
select 

    datediff(
        month,
        '2018-01-01'::date,
        date_trunc('month', current_date)
        )
[0m20:15:24.530853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:25.173708 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:15:25.187588 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m20:15:25.207169 [debug] [Thread-1  ]: Timing info for model.acme.util_months (compile): 2023-02-10 20:15:24.510235 => 2023-02-10 20:15:25.206893
[0m20:15:25.211081 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m20:15:25.287211 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m20:15:25.314908 [debug] [Thread-1  ]: Using snowflake connection "model.acme.util_months"
[0m20:15:25.318345 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.util_months"} */
create or replace   view cs_dev.demo.util_months
  
   as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 61
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        month,
        row_number() over (order by 1) - 1,
        '2018-01-01'::date
        )


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m20:15:25.583966 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m20:15:25.645241 [debug] [Thread-1  ]: Timing info for model.acme.util_months (execute): 2023-02-10 20:15:25.215636 => 2023-02-10 20:15:25.645082
[0m20:15:25.662619 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m20:15:25.809047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec08cfcd-e7b4-4f50-9ea0-c91603f17b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80629ec70>]}
[0m20:15:25.816667 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.util_months .............................. [[32mSUCCESS 1[0m in 1.36s]
[0m20:15:25.823676 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m20:15:25.830868 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:25.835843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:25.842255 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m20:15:25.847276 [info ] [MainThread]: 
[0m20:15:25.851745 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m20:15:25.855555 [debug] [MainThread]: Command end result
[0m20:15:25.902084 [info ] [MainThread]: 
[0m20:15:25.906702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:25.910413 [info ] [MainThread]: 
[0m20:15:25.914623 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:15:25.919811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe807722c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8076e0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe806260130>]}
[0m20:15:25.923899 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 20:15:33.034215 | 11901a44-8b6e-4e57-8bcc-b45c11b8459e ==============================
[0m20:15:33.034215 [info ] [MainThread]: Running with dbt=1.4.1
[0m20:15:33.036381 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:15:33.039460 [debug] [MainThread]: Tracking: tracking
[0m20:15:33.043253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9003abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9003a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9003a9a0>]}
[0m20:15:33.298211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:33.303344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:33.318025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11901a44-8b6e-4e57-8bcc-b45c11b8459e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8a5ebf40>]}
[0m20:15:33.353724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11901a44-8b6e-4e57-8bcc-b45c11b8459e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8a630fd0>]}
[0m20:15:33.356544 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 492 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m20:15:33.361054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11901a44-8b6e-4e57-8bcc-b45c11b8459e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8a747040>]}
[0m20:15:33.366935 [info ] [MainThread]: 
[0m20:15:33.372422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:33.376817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_cs_dev'
[0m20:15:33.402974 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m20:15:33.406797 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m20:15:33.411224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:34.267420 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1 seconds
[0m20:15:34.275144 [debug] [ThreadPool]: On list_cs_dev: Close
[0m20:15:34.436085 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_cs_dev_demo'
[0m20:15:34.450671 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m20:15:34.453470 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m20:15:34.456547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:35.104381 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1 seconds
[0m20:15:35.110157 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m20:15:35.249164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11901a44-8b6e-4e57-8bcc-b45c11b8459e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8a6304f0>]}
[0m20:15:35.252478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:35.254933 [info ] [MainThread]: 
[0m20:15:35.275342 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m20:15:35.278091 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_revenue_by_month ..................... [RUN]
[0m20:15:35.281449 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.acme.customer_revenue_by_month'
[0m20:15:35.284172 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m20:15:35.291692 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m20:15:35.298930 [debug] [Thread-1  ]: Timing info for model.acme.customer_revenue_by_month (compile): 2023-02-10 20:15:35.286423 => 2023-02-10 20:15:35.298776
[0m20:15:35.301451 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m20:15:35.351583 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m20:15:35.365785 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_revenue_by_month"
[0m20:15:35.368621 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
create or replace   view cs_dev.demo.customer_revenue_by_month
  
   as (
    with subscription_periods as (

    select * from cs_dev.demo.subscription_periods

),

months as (

    select * from cs_dev.demo.util_months

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m20:15:35.372314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:36.341215 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:15:36.374788 [debug] [Thread-1  ]: Timing info for model.acme.customer_revenue_by_month (execute): 2023-02-10 20:15:35.304023 => 2023-02-10 20:15:36.374707
[0m20:15:36.377457 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m20:15:36.519010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11901a44-8b6e-4e57-8bcc-b45c11b8459e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc89eb9100>]}
[0m20:15:36.522557 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_revenue_by_month ................ [[32mSUCCESS 1[0m in 1.24s]
[0m20:15:36.527628 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m20:15:36.532134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:36.536159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:36.539313 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m20:15:36.541705 [info ] [MainThread]: 
[0m20:15:36.544174 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m20:15:36.546672 [debug] [MainThread]: Command end result
[0m20:15:36.579273 [info ] [MainThread]: 
[0m20:15:36.581778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:36.584786 [info ] [MainThread]: 
[0m20:15:36.588419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:15:36.590911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca73fe3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc89a0ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc89a0ee50>]}
[0m20:15:36.593035 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 20:15:42.985160 | b5de9074-48f0-4131-8521-adab9bea2c44 ==============================
[0m20:15:42.985160 [info ] [MainThread]: Running with dbt=1.4.1
[0m20:15:42.987939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:15:42.990294 [debug] [MainThread]: Tracking: tracking
[0m20:15:42.992788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ec06dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ec06d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ec06d9a0>]}
[0m20:15:43.197693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:43.200062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:43.211304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5de9074-48f0-4131-8521-adab9bea2c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e6bb7f40>]}
[0m20:15:43.239503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5de9074-48f0-4131-8521-adab9bea2c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e6bfdfd0>]}
[0m20:15:43.242379 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 492 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m20:15:43.244856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5de9074-48f0-4131-8521-adab9bea2c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e6d11040>]}
[0m20:15:43.248967 [info ] [MainThread]: 
[0m20:15:43.253212 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:43.256604 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_cs_dev'
[0m20:15:43.280639 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m20:15:43.284210 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m20:15:43.287863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:44.287011 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1 seconds
[0m20:15:44.292480 [debug] [ThreadPool]: On list_cs_dev: Close
[0m20:15:44.395544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_cs_dev_demo'
[0m20:15:44.411147 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m20:15:44.414398 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m20:15:44.417173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:45.422394 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1 seconds
[0m20:15:45.427984 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m20:15:45.542733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5de9074-48f0-4131-8521-adab9bea2c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e6bfd4f0>]}
[0m20:15:45.545983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:45.548635 [info ] [MainThread]: 
[0m20:15:45.570243 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m20:15:45.574353 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.customer_churn_month .......................... [RUN]
[0m20:15:45.577286 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.acme.customer_churn_month'
[0m20:15:45.579887 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m20:15:45.586712 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m20:15:45.594362 [debug] [Thread-1  ]: Timing info for model.acme.customer_churn_month (compile): 2023-02-10 20:15:45.582027 => 2023-02-10 20:15:45.594188
[0m20:15:45.597140 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m20:15:45.646626 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m20:15:45.656965 [debug] [Thread-1  ]: Using snowflake connection "model.acme.customer_churn_month"
[0m20:15:45.659250 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
create or replace   view cs_dev.demo.customer_churn_month
  
   as (
    with mrr as (

    select * from cs_dev.demo.customer_revenue_by_month

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m20:15:45.661564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:46.498266 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m20:15:46.530206 [debug] [Thread-1  ]: Timing info for model.acme.customer_churn_month (execute): 2023-02-10 20:15:45.600173 => 2023-02-10 20:15:46.530130
[0m20:15:46.534433 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m20:15:46.639751 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5de9074-48f0-4131-8521-adab9bea2c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e654be50>]}
[0m20:15:46.642935 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.customer_churn_month ..................... [[32mSUCCESS 1[0m in 1.06s]
[0m20:15:46.646986 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m20:15:46.651458 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:46.654343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:46.656720 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m20:15:46.659363 [info ] [MainThread]: 
[0m20:15:46.661777 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m20:15:46.664413 [debug] [MainThread]: Command end result
[0m20:15:46.695593 [info ] [MainThread]: 
[0m20:15:46.698242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:46.701421 [info ] [MainThread]: 
[0m20:15:46.704358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:15:46.707154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e60083a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e6527e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e6527130>]}
[0m20:15:46.709465 [debug] [MainThread]: Flushing usage events


============================== 2023-02-10 20:15:52.906531 | f4f967eb-66ce-48f9-98b3-4a0c3f893305 ==============================
[0m20:15:52.906531 [info ] [MainThread]: Running with dbt=1.4.1
[0m20:15:52.908506 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/astro/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'profile': 'snowflake_profile', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:15:52.912616 [debug] [MainThread]: Tracking: tracking
[0m20:15:52.915289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce70b6be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce70b6970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce70b69a0>]}
[0m20:15:53.121545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:53.123374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:53.134115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4f967eb-66ce-48f9-98b3-4a0c3f893305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce6ecaf40>]}
[0m20:15:53.163027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4f967eb-66ce-48f9-98b3-4a0c3f893305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce6f0ef10>]}
[0m20:15:53.166250 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 492 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m20:15:53.169115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4f967eb-66ce-48f9-98b3-4a0c3f893305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce7023040>]}
[0m20:15:53.173294 [info ] [MainThread]: 
[0m20:15:53.177130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:53.180477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_cs_dev'
[0m20:15:53.205669 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev"
[0m20:15:53.208524 [debug] [ThreadPool]: On list_cs_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev"} */
show terse schemas in database cs_dev
    limit 10000
[0m20:15:53.210982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:53.921663 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1 seconds
[0m20:15:53.927496 [debug] [ThreadPool]: On list_cs_dev: Close
[0m20:15:54.037091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_cs_dev_demo'
[0m20:15:54.050240 [debug] [ThreadPool]: Using snowflake connection "list_cs_dev_demo"
[0m20:15:54.053339 [debug] [ThreadPool]: On list_cs_dev_demo: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "connection_name": "list_cs_dev_demo"} */
show terse objects in cs_dev.demo
[0m20:15:54.056113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:54.580834 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1 seconds
[0m20:15:54.586839 [debug] [ThreadPool]: On list_cs_dev_demo: Close
[0m20:15:54.732287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4f967eb-66ce-48f9-98b3-4a0c3f893305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce6f0e4f0>]}
[0m20:15:54.736217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:54.738687 [info ] [MainThread]: 
[0m20:15:54.758752 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m20:15:54.762138 [info ] [Thread-1  ]: 1 of 1 START sql view model demo.mrr ........................................... [RUN]
[0m20:15:54.766256 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.acme.mrr'
[0m20:15:54.770470 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m20:15:54.789704 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m20:15:54.810446 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m20:15:54.867347 [debug] [Thread-1  ]: Timing info for model.acme.mrr (compile): 2023-02-10 20:15:54.772850 => 2023-02-10 20:15:54.867088
[0m20:15:54.873481 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m20:15:54.968838 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m20:15:54.989799 [debug] [Thread-1  ]: Using snowflake connection "model.acme.mrr"
[0m20:15:54.992408 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "snowflake_profile", "target_name": "dev", "node_id": "model.acme.mrr"} */
create or replace   view cs_dev.demo.mrr
  
   as (
    with unioned as (

    select * from cs_dev.demo.customer_revenue_by_month

    union all

    select * from cs_dev.demo.customer_churn_month

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m20:15:54.995315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:56.627554 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m20:15:56.658079 [debug] [Thread-1  ]: Timing info for model.acme.mrr (execute): 2023-02-10 20:15:54.876208 => 2023-02-10 20:15:56.657991
[0m20:15:56.661271 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m20:15:56.780046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f967eb-66ce-48f9-98b3-4a0c3f893305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce67efbb0>]}
[0m20:15:56.782918 [info ] [Thread-1  ]: 1 of 1 OK created sql view model demo.mrr ...................................... [[32mSUCCESS 1[0m in 2.01s]
[0m20:15:56.787576 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m20:15:56.791957 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:56.795337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:56.798115 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m20:15:56.801081 [info ] [MainThread]: 
[0m20:15:56.803893 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m20:15:56.806412 [debug] [MainThread]: Command end result
[0m20:15:56.847341 [info ] [MainThread]: 
[0m20:15:56.850120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:56.852643 [info ] [MainThread]: 
[0m20:15:56.855827 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:15:56.857917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce6334c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d03a224f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce6de3070>]}
[0m20:15:56.859965 [debug] [MainThread]: Flushing usage events
